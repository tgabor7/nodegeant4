(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{19:function(e,t,a){},202:function(e,t,a){e.exports=a(505)},206:function(e,t,a){},505:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(17),i=a.n(o),s=(a(206),a(5)),l=a(13),c=a.n(l),u=a(23),m=a(4),h=a(8),d=a(6),p=a(11),g=a(12),v=(a(19),function(){function e(t,a,n){Object(m.a)(this,e),this.gl=n;var r=a.vertexShader,o=a.fragmentShader,i=n.createShader(n.VERTEX_SHADER),s=n.createShader(n.FRAGMENT_SHADER);if(n.shaderSource(i,r),n.shaderSource(s,o),n.compileShader(i),n.getShaderParameter(i,n.COMPILE_STATUS))if(n.compileShader(s),n.getShaderParameter(s,n.COMPILE_STATUS)){this.program=n.createProgram(),n.attachShader(this.program,i),n.attachShader(this.program,s);for(var l=0;l<t.length;l++)n.bindAttribLocation(this.program,t[l][0],t[l][1]);n.linkProgram(this.program),n.getProgramParameter(this.program,n.LINK_STATUS)?(n.validateProgram(this.program),n.getProgramParameter(this.program,n.VALIDATE_STATUS)||console.error("ERROR validating program!",n.getProgramInfoLog(this.program))):console.error("ERROR linking program!",n.getProgramInfoLog(this.program))}else console.error("ERROR compiling fragment shader!",n.getShaderInfoLog(s));else console.error("ERROR compiling vertex shader!",n.getShaderInfoLog(i))}return Object(h.a)(e,[{key:"bind",value:function(){this.gl.useProgram(this.program)}},{key:"unBind",value:function(){this.gl.useProgram(null)}},{key:"setUniform",value:function(e,t){var a=this.gl.getUniformLocation(this.program,e);-1!=a&&this.gl.uniform1f(a,t)}},{key:"setUniform1i",value:function(e,t){var a=this.gl.getUniformLocation(this.program,e);-1!=a&&this.gl.uniform1i(a,t)}},{key:"setUniform3f",value:function(e,t,a,n){var r=this.gl.getUniformLocation(this.program,e);-1!=r&&this.gl.uniform3f(r,t,a,n)}},{key:"setUniform4fv",value:function(e,t){var a=this.gl.getUniformLocation(this.program,e);-1!=a&&this.gl.uniformMatrix4fv(a,!1,t)}}]),e}()),f=a(201),b=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(){var e;return Object(m.a)(this,a),(e=t.call(this,16))[0]=1,e[5]=1,e[10]=1,e[15]=1,e}return a}(Object(f.a)(Float64Array)),y=function e(t,a,n){Object(m.a)(this,e),this.x=t,this.y=a,this.z=n},E=function e(t,a,n,r,o){Object(m.a)(this,e),this.x=t,this.y=a,this.d=n,this.p=r,this.a=o},x=function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,null,[{key:"scale",value:function(e,t){for(var a=new b,n=0;n<16;n++)a[n]=e[n];return a[0]=a[0]*t.x,a[1]=a[1]*t.x,a[2]=a[2]*t.x,a[4]=a[4]*t.y,a[5]=a[5]*t.y,a[6]=a[6]*t.y,a[8]=a[8]*t.z,a[9]=a[9]*t.z,a[10]=a[10]*t.z,a}},{key:"translate",value:function(e,t){for(var a=new b,n=0;n<16;n++)a[n]=e[n];return a[12]=e[0]*t.x+e[4]*t.y+e[8]*t.z+e[12],a[13]=e[1]*t.x+e[5]*t.y+e[9]*t.z+e[13],a[14]=e[2]*t.x+e[6]*t.y+e[10]*t.z+e[14],a[15]=e[3]*t.x+e[7]*t.y+e[11]*t.z+e[15],a}},{key:"normalize",value:function(e){var t=new y;t.x=e.x,t.y=e.y,t.z=e.z;var a=Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z);return t.x/=a,t.y/=a,t.z/=a,t}},{key:"mulVectorDouble",value:function(e,t){var a=new y(0,0,0);return a.x=e.x,a.y=e.y,a.z=e.z,a.x*=t,a.y*=t,a.z*=t,a}},{key:"cross",value:function(e,t){var a=new y(0,0,0);return a.x=e.y*t.z-e.z*t.y,a.y=e.z*t.x-e.x*t.z,a.z=e.x*t.y-e.y*t.x,a}},{key:"lookAt",value:function(e,t,a){var n=new y(0,0,0),r=new y(0,0,0);n.x=t.x-e.x,n.y=t.y-e.y,n.z=t.z-e.z,n=this.normalize(n);var o=new y(0,0,0);o=this.cross(n,a),o=this.normalize(o),r=this.cross(o,n);var i=new b;return i[0]=o.x,i[1]=o.y,i[2]=o.z,i[4]=r.x,i[5]=r.y,i[6]=r.z,i[8]=-n.x,i[9]=-n.y,i[10]=-n.z,i=this.invert(i)}},{key:"invert",value:function(e){var t=new b,a=new b,n=0;a[0]=e[5]*e[10]*e[15]-e[5]*e[11]*e[14]-e[9]*e[6]*e[15]+e[9]*e[7]*e[14]+e[13]*e[6]*e[11]-e[13]*e[7]*e[10],a[4]=-e[4]*e[10]*e[15]+e[4]*e[11]*e[14]+e[8]*e[6]*e[15]-e[8]*e[7]*e[14]-e[12]*e[6]*e[11]+e[12]*e[7]*e[10],a[8]=e[4]*e[9]*e[15]-e[4]*e[11]*e[13]-e[8]*e[5]*e[15]+e[8]*e[7]*e[13]+e[12]*e[5]*e[11]-e[12]*e[7]*e[9],a[12]=-e[4]*e[9]*e[14]+e[4]*e[10]*e[13]+e[8]*e[5]*e[14]-e[8]*e[6]*e[13]-e[12]*e[5]*e[10]+e[12]*e[6]*e[9],a[1]=-e[1]*e[10]*e[15]+e[1]*e[11]*e[14]+e[9]*e[2]*e[15]-e[9]*e[3]*e[14]-e[13]*e[2]*e[11]+e[13]*e[3]*e[10],a[5]=e[0]*e[10]*e[15]-e[0]*e[11]*e[14]-e[8]*e[2]*e[15]+e[8]*e[3]*e[14]+e[12]*e[2]*e[11]-e[12]*e[3]*e[10],a[9]=-e[0]*e[9]*e[15]+e[0]*e[11]*e[13]+e[8]*e[1]*e[15]-e[8]*e[3]*e[13]-e[12]*e[1]*e[11]+e[12]*e[3]*e[9],a[13]=e[0]*e[9]*e[14]-e[0]*e[10]*e[13]-e[8]*e[1]*e[14]+e[8]*e[2]*e[13]+e[12]*e[1]*e[10]-e[12]*e[2]*e[9],a[2]=e[1]*e[6]*e[15]-e[1]*e[7]*e[14]-e[5]*e[2]*e[15]+e[5]*e[3]*e[14]+e[13]*e[2]*e[7]-e[13]*e[3]*e[6],a[6]=-e[0]*e[6]*e[15]+e[0]*e[7]*e[14]+e[4]*e[2]*e[15]-e[4]*e[3]*e[14]-e[12]*e[2]*e[7]+e[12]*e[3]*e[6],a[10]=e[0]*e[5]*e[15]-e[0]*e[7]*e[13]-e[4]*e[1]*e[15]+e[4]*e[3]*e[13]+e[12]*e[1]*e[7]-e[12]*e[3]*e[5],a[14]=-e[0]*e[5]*e[14]+e[0]*e[6]*e[13]+e[4]*e[1]*e[14]-e[4]*e[2]*e[13]-e[12]*e[1]*e[6]+e[12]*e[2]*e[5],a[3]=-e[1]*e[6]*e[11]+e[1]*e[7]*e[10]+e[5]*e[2]*e[11]-e[5]*e[3]*e[10]-e[9]*e[2]*e[7]+e[9]*e[3]*e[6],a[7]=e[0]*e[6]*e[11]-e[0]*e[7]*e[10]-e[4]*e[2]*e[11]+e[4]*e[3]*e[10]+e[8]*e[2]*e[7]-e[8]*e[3]*e[6],a[11]=-e[0]*e[5]*e[11]+e[0]*e[7]*e[9]+e[4]*e[1]*e[11]-e[4]*e[3]*e[9]-e[8]*e[1]*e[7]+e[8]*e[3]*e[5],a[15]=e[0]*e[5]*e[10]-e[0]*e[6]*e[9]-e[4]*e[1]*e[10]+e[4]*e[2]*e[9]+e[8]*e[1]*e[6]-e[8]*e[2]*e[5],n=1/(n=e[0]*a[0]+e[1]*a[4]+e[2]*a[8]+e[3]*a[12]);for(var r=0;r<16;r++)t[r]=a[r]*n;return t}},{key:"rotate",value:function(e,t,a){var n=new b,r=t,o=Math.cos(r),i=Math.sin(r),s=new y(0,0,0);s.x=a.x,s.y=a.y,s.z=a.z;var l=new y(s.x*(1-o),s.y*(1-o),s.z*(1-o));n[0]=o+l.x*s.x,n[1]=l.x*s.y+i*s.z,n[2]=l.x*s.z-i*s.y,n[4]=l.y*s.x-i*s.z,n[5]=o+l.y*s.y,n[6]=l.y*s.z+i*s.x,n[8]=l.z*s.x+i*s.y,n[9]=l.z*s.y-i*s.x,n[10]=o+l.z*s.z;for(var c=new b,u=0;u<16;u++)c[u]=e[u];return c[0]=e[0]*n[0]+e[4]*n[1]+e[8]*n[2],c[1]=e[1]*n[0]+e[5]*n[1]+e[9]*n[2],c[2]=e[2]*n[0]+e[6]*n[1]+e[10]*n[2],c[4]=e[0]*n[4]+e[4]*n[5]+e[8]*n[6],c[5]=e[1]*n[4]+e[5]*n[5]+e[9]*n[6],c[6]=e[2]*n[4]+e[6]*n[5]+e[10]*n[6],c[8]=e[0]*n[8]+e[4]*n[9]+e[8]*n[10],c[9]=e[1]*n[8]+e[5]*n[9]+e[9]*n[10],c[10]=e[2]*n[8]+e[6]*n[9]+e[10]*n[10],c[12]=e[12],c[13]=e[13],c[14]=e[14],c}},{key:"mul",value:function(e,t){for(var a=new b,n=0;n<4;n++)for(var r=0;r<4;r++){a[4*n+r]=0;for(var o=0;o<4;o++)a[4*n+r]+=t[4*n+o]*e[4*o+r]}return a}},{key:"createTransformationMatrix",value:function(t,a,n,r,o,i,s,l,c){var u=new b;return u=e.translate(u,new y(t,a,n)),u=e.rotate(u,r,new y(1,0,0)),u=e.rotate(u,o,new y(0,1,0)),u=e.rotate(u,i,new y(0,0,1)),u=e.scale(u,new y(s,l,c))}},{key:"createViewMatrix",value:function(e){var t=new b;return t=this.lookAt(e.p,e.a,new y(0,1,0)),t=this.translate(t,new y(-e.p.x,-e.p.y,-e.p.z))}},{key:"createBillBoardMatrix",value:function(e){var t=new b;return t=this.lookAt(e.p,e.a,new y(0,1,0)),t=this.translate(t,new y(-e.p.x,-e.p.y,-e.p.z))}},{key:"createProjectionMatrix",value:function(e,t,a,n,r){var o=n/r,i=1/Math.tan(e/2/360*3.14)*o,s=i/o,l=a-t,c=new b;return c[0]=s,c[5]=i,c[10]=-(a+t)/l,c[11]=-1,c[14]=-2*t*a/l,c[15]=0,c}},{key:"ortho",value:function(e,t,a,n,r,o){var i=new b;return i[0]=2/(t-e),i[5]=2/(n-a),i[10]=-2/(o-r),i[12]=-(t+e)/(t-e),i[13]=-(n+a)/(n-a),i[14]=-(o+r)/(o-r),i}},{key:"distance",value:function(e,t){return Math.sqrt(e.x*t.x+e.y*t.y+e.z*t.z)}}]),e}(),w=function e(){Object(m.a)(this,e)};w.vertexShader="precision mediump float;attribute vec2 vertPosition;uniform mat4 projection;uniform mat4 transformation;uniform mat4 view;varying vec2 tex_coords;void main(){vec4 pos =  projection * view * transformation * vec4(vertPosition, 0.0, 1.0);tex_coords = vertPosition * 0.5 + 0.5;tex_coords.y = 1.0-tex_coords.y;gl_Position = pos;}",w.fragmentShader="precision mediump float;uniform sampler2D sampler;uniform float width;uniform float height;uniform float distance;varying vec2 tex_coords;int mod(int a, int b){\treturn a - b * int(a/b);}void main(){vec4 color = vec4(1.0);gl_FragColor = color;}";var O=function e(){Object(m.a)(this,e)};O.vertexShader="precision mediump float;attribute vec3 vertPosition;attribute vec3 normal;attribute mat4 transformation;attribute vec3 color;varying vec2 tex_coords;varying vec3 Normal;varying vec3 fragPos;varying vec3 out_color;uniform mat4 projection;uniform mat4 view;uniform float camera;uniform float max;vec3 hsvtorgb(float h, float s, float v){float i = 0.0;float f = 0.0;float p = 0.0;float q = 0.0;float t = 0.0;vec3 color;if(s==0.0){color.x = v;color.y = v;color.z = v;return color;}h /= 60.0;i = float(int(h));f = h - i;p = v * (1.0 - s);q = v * (1.0 - s*f);t = v * (1.0 - s * (1.0-f));if(i==0.0){color.x = v;color.y = t;color.z = p;}else if(i==1.0){color.x = q;color.y = v;color.z = p;}else if(i==2.0){color.x = p;color.y = v;color.z = t;}else if(i==3.0){color.x = p;color.y = q;color.z = v;}else if(i==4.0){color.x = t;color.y = p;color.z = v;}else{color.x = v;color.y = p;color.z = q;}return color;}void main(){gl_Position = projection * view * transformation * vec4(vec3(vertPosition*camera*0.2), 1.0);out_color = hsvtorgb(180.0-(color.x/max)*180.0, 1.0,1.0);fragPos = vec3(transformation * vec4(vertPosition, 1.0));Normal = normal;}",O.fragmentShader="precision mediump float;varying vec2 tex_coords;varying vec3 Normal;varying vec3 fragPos;varying vec3 out_color;uniform sampler2D sampler;void main(){vec3 norm = normalize(Normal);vec3 lightDir = normalize(vec3(100) - fragPos);float diff = max(dot(norm, lightDir), 0.0); vec3 diffuse = diff * vec3(1); gl_FragColor = vec4(out_color,1.0);}";var A=function(){function e(t,a){Object(m.a)(this,e),this.vao=a.createVertexArray(),a.bindVertexArray(this.vao),this.vertices=t,this.index=0,this.vbo=this.createVBO(a),this.color_vbo=this.createVBO(a),this.shader=new S(a),this.storeData(0,3,t,a),this.maxenergy=0,a.bindVertexArray(null),a.disableVertexAttribArray(0),this.addIntanceAttrib(this.vao,this.vbo,1,4,16,0,a),this.addIntanceAttrib(this.vao,this.vbo,2,4,16,4,a),this.addIntanceAttrib(this.vao,this.vbo,3,4,16,8,a),this.addIntanceAttrib(this.vao,this.vbo,4,4,16,12,a),this.addIntanceAttrib(this.vao,this.color_vbo,5,3,3,0,a),this.drawLines=!1}return Object(h.a)(e,[{key:"render",value:function(e,t,a,n,r){var o=[],i=[];this.index=0,this.colorIndex=0,this.shader.bind(),r.bindVertexArray(this.vao),r.enableVertexAttribArray(0),r.enableVertexAttribArray(1),r.enableVertexAttribArray(2),r.enableVertexAttribArray(3),r.enableVertexAttribArray(4),r.enableVertexAttribArray(5);for(var s=0;s<e.length;s++)this.storeMatrixData(x.createTransformationMatrix(e[s].position.x,e[s].position.y,e[s].position.z,0,0,0,e[s].scale.x,e[s].scale.y,e[s].scale.z),o),this.storeVectorData(e[s].color,i);this.updateVBO(this.vbo,o,r),this.updateVBO(this.color_vbo,i,r),this.drawLines?r.drawArraysInstanced(r.LINES,0,this.vertices.length/2,e.length):r.drawArraysInstanced(r.TRIANGLES,0,this.vertices.length/3,e.length),this.shader.setUniform4fv("view",t),this.shader.setUniform4fv("projection",a),this.shader.setUniform3f("color",1,1,1),this.shader.setUniform("camera",n),this.shader.setUniform("max",this.maxenergy),r.bindVertexArray(null),r.disableVertexAttribArray(0),r.disableVertexAttribArray(1),r.disableVertexAttribArray(2),r.disableVertexAttribArray(3),r.disableVertexAttribArray(4),r.disableVertexAttribArray(5),this.shader.unBind()}},{key:"createVBO",value:function(e){var t=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,new Float32Array(8e4),e.STREAM_DRAW,0),e.bindBuffer(e.ARRAY_BUFFER,null),t}},{key:"storeVectorData",value:function(e,t){t[this.colorIndex++]=e.x,t[this.colorIndex++]=e.y,t[this.colorIndex++]=e.z}},{key:"storeMatrixData",value:function(e,t){for(var a=0;a<16;a++)t[this.index++]=e[a]}},{key:"storeData",value:function(e,t,a,n){var r=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,r),n.bufferData(n.ARRAY_BUFFER,new Float32Array(a),n.STATIC_DRAW,0),n.vertexAttribPointer(e,t,n.FLOAT,n.FALSE,0,0)}},{key:"addIntanceAttrib",value:function(e,t,a,n,r,o,i){i.bindBuffer(i.ARRAY_BUFFER,t),i.bindVertexArray(e),i.vertexAttribPointer(a,n,i.FLOAT,!1,4*r,4*o),i.vertexAttribDivisor(a,1),i.bindBuffer(i.ARRAY_BUFFER,null),i.bindVertexArray(null)}},{key:"updateVBO",value:function(e,t,a){a.bindBuffer(a.ARRAY_BUFFER,e),a.bufferData(a.ARRAY_BUFFER,new Float32Array(t),a.STREAM_DRAW),a.bufferSubData(a.ARRAY_BUFFER,0,new Float32Array(t)),a.bindBuffer(a.ARRAY_BUFFER,null)}}]),e}(),S=function(){function e(t){Object(m.a)(this,e),this.gl=t;var a=O.vertexShader,n=O.fragmentShader,r=t.createShader(t.VERTEX_SHADER),o=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(r,a),t.shaderSource(o,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?(t.compileShader(o),t.getShaderParameter(o,t.COMPILE_STATUS)?(this.program=t.createProgram(),t.attachShader(this.program,r),t.attachShader(this.program,o),t.bindAttribLocation(this.program,0,"vertPosition"),t.bindAttribLocation(this.program,1,"transformation"),t.bindAttribLocation(this.program,5,"color"),t.linkProgram(this.program),t.getProgramParameter(this.program,t.LINK_STATUS)?(t.validateProgram(this.program),t.getProgramParameter(this.program,t.VALIDATE_STATUS)||console.error("ERROR validating program!",t.getProgramInfoLog(this.program))):console.error("ERROR linking program!",t.getProgramInfoLog(this.program))):console.error("ERROR compiling fragment shader!",t.getShaderInfoLog(o))):console.error("ERROR compiling vertex shader!",t.getShaderInfoLog(r))}return Object(h.a)(e,[{key:"bind",value:function(){this.gl.useProgram(this.program)}},{key:"unBind",value:function(){this.gl.useProgram(null)}},{key:"setUniform",value:function(e,t){var a=this.gl.getUniformLocation(this.program,e);-1!=a&&this.gl.uniform1f(a,t)}},{key:"setUniform1i",value:function(e,t){var a=this.gl.getUniformLocation(this.program,e);-1!=a&&this.gl.uniform1i(a,t)}},{key:"setUniform3f",value:function(e,t,a,n){var r=this.gl.getUniformLocation(this.program,e);-1!=r&&this.gl.uniform3f(r,t,a,n)}},{key:"setUniform4fv",value:function(e,t){var a=this.gl.getUniformLocation(this.program,e);-1!=a&&this.gl.uniformMatrix4fv(a,!1,t)}}]),e}(),C=function(){function e(t){Object(m.a)(this,e),this.gl=t,this.shader=new v([0,"vertPosition"],w,t),this.vertices=[-1,1,1,1,-1,-1,1,-1,1,1,-1,-1],this.vertical=[1,0,0,-1,0,0],this.horizontal=[0,0,1,0,0,-1],this.vao=this.gl.createVertexArray(),this.gl.bindVertexArray(this.vao),this.gl.enableVertexAttribArray(0),this.vbo=t.createBuffer(),this.gl.bindBuffer(t.ARRAY_BUFFER,this.vbo),this.gl.bufferData(t.ARRAY_BUFFER,new Float32Array(this.vertical),t.STATIC_DRAW,0),this.gl.vertexAttribPointer(0,2,t.FLOAT,t.FALSE,0,0),this.gl.bindVertexArray(null),this.gl.disableVertexAttribArray(0),this.verticalRenderer=new A(this.vertical,this.gl),this.verticalRenderer.drawLines=!0,this.horizontalRenderer=new A(this.horizontal,this.gl),this.horizontalRenderer.drawLines=!0;var a=function e(t,a,n,r,o,i){Object(m.a)(this,e),this.position=new y(t,a,n),this.scale=new y(r,o,i),this.color=new y(1,1,1)};this.lines=[];for(var n=-100;n<100;n++)this.lines.push(new a(0,0,100*n,10,1,1));for(var r=-100;r<100;r++)this.lines.push(new a(100*r,0,0,1,1,10))}return Object(h.a)(e,[{key:"draw",value:function(e,t,a,n,r,o){var i=100;r>1e3&&(i=5e3),r>200&&r<1e3&&(i=500),r<200&&r>20&&(i=100),r<20&&(i=10),o(i/100+" cm");for(var s=0;s<200;s++)this.lines[s].position.z=i*s/100-i,this.lines[s].scale.x=i/200;for(var l=200;l<400;l++)this.lines[l].position.x=i*(l-200)/100-i,this.lines[l].scale.z=i/200;this.verticalRenderer.render(this.lines,x.createViewMatrix(t),e,1e3,this.gl),this.horizontalRenderer.render(this.lines,x.createViewMatrix(t),e,1e3,this.gl)}}]),e}(),k=function e(){Object(m.a)(this,e)};k.vertexShader="precision mediump float;attribute vec3 vertPosition;attribute vec3 normal;varying vec2 tex_coords;varying vec3 Normal;varying vec3 fragPos;uniform mat4 projection;uniform mat4 transformation;uniform mat4 view;void main(){gl_Position = projection * view * transformation * vec4(vertPosition, 1.0);fragPos = vec3(transformation * vec4(vertPosition, 1.0));Normal = normal;}",k.fragmentShader="precision mediump float;varying vec2 tex_coords;varying vec3 Normal;varying vec3 fragPos;uniform vec3 color;uniform sampler2D sampler;uniform int fakeLightning;void main(){vec3 norm = normalize(Normal);vec3 lightDir = normalize(vec3(100) - fragPos);float diff = max(dot(norm, lightDir), 0.0); vec3 diffuse = diff * vec3(1); if(fakeLightning == 1) diffuse = vec3(.9);gl_FragColor = vec4((vec3(.1)+diffuse)*color,1.0);}";var D=function(){function e(t,a,n){Object(m.a)(this,e),this.vertices=t,this.normals=a,this.gl=n,this.color=new y(.1,.1,.1),this.drawLines=!0,this.outline=!0,this.position=new y(0,0,0),this.rotation=new y(0,0,0),this.scale=new y(1,1,1),this.vao=n.createVertexArray(),n.bindVertexArray(this.vao),this.vbo=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.vbo),n.bufferData(n.ARRAY_BUFFER,new Float32Array(t),n.STATIC_DRAW,0),n.vertexAttribPointer(0,3,n.FLOAT,n.FALSE,0,0),this.nvbo=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.nvbo),n.bufferData(n.ARRAY_BUFFER,new Float32Array(this.normals),n.STATIC_DRAW,0),n.vertexAttribPointer(1,3,n.FLOAT,n.FALSE,0,0),n.bindVertexArray(null)}return Object(h.a)(e,[{key:"draw",value:function(){this.drawLines?this.gl.drawArrays(this.gl.LINE_STRIP,0,this.vertices.length/3):this.gl.drawArrays(this.gl.TRIANGLES,0,this.vertices.length/3)}}]),e}(),z=function e(){Object(m.a)(this,e)};z.vertices=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5],z.normals=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0];var R=function(){function e(t){Object(m.a)(this,e),this.shader=new v([[0,"vertPosition"],[1,"normal"]],k,t),this.models=[],this.sources=[],this.detectors=[],this.guns=[],this.particles=[],this.gl=t,this.addModel(new D([1,0,0,-1,0,0],[1,1,1,1,1,1],t)),this.addModel(new D([0,1,0,0,-1,0],[1,1,1,1,1,1],t)),this.addModel(new D([0,0,1,0,0,-1],[1,1,1,1,1,1],t)),this.addModel(new D([0,0,1,0,0,-1],[1,1,1,1,1,1],t)),this.models[0].color=new y(1,0,0),this.models[1].color=new y(0,1,0),this.models[2].color=new y(0,0,1),this.models[3].color=new y(0,0,1),this.drawTracks=!0,this.drawParticles=!0,this.drawAxes=!0}return Object(h.a)(e,[{key:"removeDetector",value:function(e){for(var t=0;t<this.detectors.length;t++)this.detectors[t]==e&&this.detectors.splice(t,1)}},{key:"removeGun",value:function(e){for(var t=0;t<this.guns.length;t++)this.guns[t]==e&&this.guns.splice(t,1)}},{key:"removeSource",value:function(e){for(var t=0;t<this.sources.length;t++)this.sources[t]==e&&this.sources.splice(t,1)}},{key:"addModel",value:function(e){this.models.push(e)}},{key:"addParticles",value:function(e){this.particles.push(e)}},{key:"addGun",value:function(e){this.guns.push(e)}},{key:"addSource",value:function(e){this.sources.push(e)}},{key:"addDetector",value:function(e){this.detectors.push(e)}},{key:"clearSetup",value:function(){this.detectors=[],this.sources=[],this.guns=[]}},{key:"clearTracks",value:function(){this.models=[],this.addModel(new D([1,0,0,-1,0,0],[1,1,1,1,1,1],this.gl)),this.addModel(new D([0,1,0,0,-1,0],[1,1,1,1,1,1],this.gl)),this.addModel(new D([0,0,1,0,0,-1],[1,1,1,1,1,1],this.gl)),this.addModel(new D([0,0,1,0,0,-1],[1,1,1,1,1,1],this.gl)),this.models[0].color=new y(1,0,0),this.models[1].color=new y(0,1,0),this.models[2].color=new y(0,0,1),this.models[3].color=new y(0,0,1)}},{key:"draw",value:function(t,a){this.shader.bind(),this.gl.enable(this.gl.DEPTH_TEST),this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl.BACK);for(var n=0;n<this.detectors.length;n++){this.gl.enable(this.gl.DEPTH_TEST),this.gl.enableVertexAttribArray(0),this.gl.enableVertexAttribArray(1),this.gl.bindVertexArray(this.detectors[n].model.vao);var r=x.createTransformationMatrix(this.detectors[n].model.position.x,this.detectors[n].model.position.y,this.detectors[n].model.position.z,this.detectors[n].model.rotation.x,this.detectors[n].model.rotation.y,this.detectors[n].model.rotation.z,this.detectors[n].model.scale.x,this.detectors[n].model.scale.y,this.detectors[n].model.scale.z);this.shader.setUniform3f("color",this.detectors[n].model.color.x,this.detectors[n].model.color.y,this.detectors[n].model.color.z),this.shader.setUniform1i("sampler",0),this.shader.setUniform4fv("view",x.createViewMatrix(a)),this.shader.setUniform4fv("projection",t),this.shader.setUniform4fv("transformation",r),this.detectors[n].model.draw(),this.gl.disableVertexAttribArray(0),this.gl.disableVertexAttribArray(1)}this.gl.enable(this.gl.CULL_FACE),this.gl.disable(this.gl.DEPTH_TEST);for(var o=0;o<this.detectors.length;o++)if(this.gl.cullFace(this.gl.FRONT),this.detectors[o].id==e.active_id){if(this.detectors[o].id==e.active_id){this.gl.enableVertexAttribArray(0),this.gl.enableVertexAttribArray(1),this.gl.bindVertexArray(this.detectors[o].model.vao);var i=x.createTransformationMatrix(this.detectors[o].model.position.x,this.detectors[o].model.position.y,this.detectors[o].model.position.z,this.detectors[o].model.rotation.x,this.detectors[o].model.rotation.y,this.detectors[o].model.rotation.z,1.01*this.detectors[o].model.scale.x,1.01*this.detectors[o].model.scale.y,1.01*this.detectors[o].model.scale.z);this.shader.setUniform3f("color",1,.4,0),this.shader.setUniform1i("fakeLightning",1),this.shader.setUniform1i("sampler",0),this.shader.setUniform4fv("view",x.createViewMatrix(a)),this.shader.setUniform4fv("projection",t),this.shader.setUniform4fv("transformation",i),this.detectors[o].model.draw(),this.gl.disableVertexAttribArray(0),this.gl.disableVertexAttribArray(1),this.gl.cullFace(this.gl.BACK),this.gl.enableVertexAttribArray(0),this.gl.enableVertexAttribArray(1),this.gl.bindVertexArray(this.detectors[o].model.vao),i=x.createTransformationMatrix(this.detectors[o].model.position.x,this.detectors[o].model.position.y,this.detectors[o].model.position.z,this.detectors[o].model.rotation.x,this.detectors[o].model.rotation.y,this.detectors[o].model.rotation.z,this.detectors[o].model.scale.x,this.detectors[o].model.scale.y,this.detectors[o].model.scale.z),this.shader.setUniform3f("color",this.detectors[o].model.color.x,this.detectors[o].model.color.y,this.detectors[o].model.color.z),this.shader.setUniform1i("sampler",0),this.shader.setUniform4fv("view",x.createViewMatrix(a)),this.shader.setUniform1i("fakeLightning",0),this.shader.setUniform4fv("projection",t),this.shader.setUniform4fv("transformation",i),this.detectors[o].model.draw(),this.gl.disableVertexAttribArray(0),this.gl.disableVertexAttribArray(1)}this.gl.enable(this.gl.DEPTH_TEST)}for(var s=0;s<this.guns.length;s++){this.gl.enableVertexAttribArray(0),this.gl.enableVertexAttribArray(1),this.gl.bindVertexArray(this.guns[s].model.vao);var l=new y(0,0,0);l.x=Math.atan2(-this.guns[s].direction.y,this.guns[s].direction.z),l.z=Math.atan2(this.guns[s].direction.x,-this.guns[s].direction.y),l.y=Math.atan2(this.guns[s].direction.x,this.guns[s].direction.z);var c=x.createTransformationMatrix(this.guns[s].model.position.x,this.guns[s].model.position.y,this.guns[s].model.position.z,l.x,l.y,l.z,.01*a.d,.01*a.d,.01*a.d);this.shader.setUniform3f("color",this.guns[s].model.color.x,this.guns[s].model.color.y,this.guns[s].model.color.z),this.shader.setUniform1i("sampler",0),this.shader.setUniform4fv("view",x.createViewMatrix(a)),this.shader.setUniform4fv("projection",t),this.shader.setUniform4fv("transformation",c),this.guns[s].model.draw(),this.gl.disableVertexAttribArray(0),this.gl.disableVertexAttribArray(1)}this.gl.disable(this.gl.DEPTH_TEST);for(s=0;s<this.sources.length;s++){this.gl.enableVertexAttribArray(0),this.gl.enableVertexAttribArray(1),this.gl.bindVertexArray(this.sources[s].model.vao);var u=x.createTransformationMatrix(this.sources[s].model.position.x,this.sources[s].model.position.y,this.sources[s].model.position.z,this.sources[s].model.rotation.x,this.sources[s].model.rotation.y,this.sources[s].model.rotation.z,.004*a.d,.004*a.d,.004*a.d);this.shader.setUniform3f("color",this.sources[s].model.color.x,this.sources[s].model.color.y,this.sources[s].model.color.z),this.shader.setUniform1i("sampler",0),this.shader.setUniform4fv("view",x.createViewMatrix(a)),this.shader.setUniform4fv("projection",t),this.shader.setUniform4fv("transformation",u),this.sources[s].model.draw(),this.gl.disableVertexAttribArray(0),this.gl.disableVertexAttribArray(1)}if(this.gl.enable(this.gl.DEPTH_TEST),this.gl.disable(this.gl.DEPTH_TEST),this.drawAxes)for(var m=0;m<4;m++){this.gl.enableVertexAttribArray(0),this.gl.enableVertexAttribArray(1),this.gl.bindVertexArray(this.models[m].vao);var h=x.createTransformationMatrix(this.models[m].position.x,this.models[m].position.y,this.models[m].position.z,this.models[m].rotation.x,this.models[m].rotation.y,this.models[m].rotation.z,a.d,a.d,a.d);this.shader.setUniform3f("color",this.models[m].color.x,this.models[m].color.y,this.models[m].color.z),this.shader.setUniform1i("sampler",0),this.shader.setUniform4fv("view",x.createViewMatrix(a)),this.shader.setUniform4fv("projection",t),this.shader.setUniform4fv("transformation",h),this.models[m].draw(),this.gl.disableVertexAttribArray(0),this.gl.disableVertexAttribArray(1)}if(this.drawTracks){for(var d=3;d<this.models.length;d++){this.gl.enableVertexAttribArray(0),this.gl.enableVertexAttribArray(1),this.gl.bindVertexArray(this.models[d].vao);var p=x.createTransformationMatrix(this.models[d].position.x,this.models[d].position.y,this.models[d].position.z,this.models[d].rotation.x,this.models[d].rotation.y,this.models[d].rotation.z,this.models[d].scale.x,this.models[d].scale.y,this.models[d].scale.z);this.shader.setUniform3f("color",this.models[d].color.x,this.models[d].color.y,this.models[d].color.z),this.shader.setUniform1i("sampler",0),this.shader.setUniform4fv("view",x.createViewMatrix(a)),this.shader.setUniform4fv("projection",t),this.shader.setUniform4fv("transformation",p),this.models[d].draw(),this.gl.disableVertexAttribArray(0),this.gl.disableVertexAttribArray(1)}this.shader.unBind(),this.gl.disable(this.gl.DEPTH_TEST)}else this.shader.unBind()}}]),e}();R.active_id=-1;var L=R,j=(a(207),function(){function e(t){Object(m.a)(this,e),this.model=t,this.material="Pb",this.active=!1,this.deposit=0,this.name="",this.id=0,this.hits=[],this.geometry="cube",this.numberOfHits=[],this.units=[1,1,1]}return Object(h.a)(e,[{key:"contains",value:function(e){for(var t=0;t<this.hits.length;t++)if(e==this.hits[t])return!0;return!1}},{key:"clearDeposit",value:function(){this.hits=[],this.numberOfHits=[]}},{key:"sort",value:function(){for(var e=[],t=0;t<this.hits.length;t++)e.push({hit:this.hits[t],no:this.numberOfHits[t]});e.sort((function(e,t){return e.hit<t.hit?-1:e.hit==t.hit?0:1}));for(var a=0;a<e.length;a++)this.hits[a]=e[a].hit,this.numberOfHits[a]=e[a].no}},{key:"getIndex",value:function(e){for(var t=0;t<this.hits.length;t++)if(0==Math.abs(e-this.hits[t]))return t;return-1}}]),e}()),T=function e(t,a,n,r){Object(m.a)(this,e),this.position=a,this.direction=n,this.energy=r,this.model=t,this.name="Particle Gun",this.units=[1,1]},M=function e(){Object(m.a)(this,e)};M.vertices=[-1,-1,-1,0,0,1,0,0,1,-1,-1,-1,0,0,1,-1,1,-1,-1,1,-1,0,0,1,0,0,1,-1,1,-1,0,0,1,1,1,-1,1,1,-1,0,0,1,0,0,1,1,1,-1,0,0,1,1,-1,-1,1,-1,-1,0,0,1,0,0,1,1,-1,-1,0,0,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,1,-1,-1,-1,-1,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1],M.normals=[0,0,0,0,0,0,0,0,0,-.8944271802902222,0,.4472135901451111,-.8944271802902222,0,.4472135901451111,-.8944271802902222,0,.4472135901451111,0,0,0,0,0,0,0,0,0,0,.8944271802902222,.4472135901451111,0,.8944271802902222,.4472135901451111,0,.8944271802902222,.4472135901451111,0,0,0,0,0,0,0,0,0,.8944271802902222,0,.4472135901451111,.8944271802902222,0,.4472135901451111,.8944271802902222,0,.4472135901451111,0,0,0,0,0,0,0,0,0,0,-.8944271802902222,.4472135901451111,0,-.8944271802902222,.4472135901451111,0,-.8944271802902222,.4472135901451111,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var I=function e(t,a,n){Object(m.a)(this,e),this.position=a,this.name="Particle Source",this.scale=new y(1,1,1),this.material=n,this.model=t,this.model.color=new y(0,1,0),this.active=!1,this.id=0,this.units=[1]},N=function e(){Object(m.a)(this,e)};N.vertexShader="precision mediump float;attribute vec2 vertPosition;varying vec2 textures;uniform mat4 transformation;void main(){gl_Position = transformation * vec4(vertPosition, 0.0, 1.0);textures = vertPosition * 0.5 - 0.5;}",N.fragmentShader="precision mediump float;varying vec2 textures;vec3 hsvtorgb(float h, float s, float v){float i = 0.0;float f = 0.0;float p = 0.0;float q = 0.0;float t = 0.0;vec3 color;if(s==0.0){color.x = v;color.y = v;color.z = v;return color;}h /= 60.0;i = float(int(h));f = h - i;p = v * (1.0 - s);q = v * (1.0 - s*f);t = v * (1.0 - s * (1.0-f));if(i==0.0){color.x = v;color.y = t;color.z = p;}else if(i==1.0){color.x = q;color.y = v;color.z = p;}else if(i==2.0){color.x = p;color.y = v;color.z = t;}else if(i==3.0){color.x = p;color.y = q;color.z = v;}else if(i==4.0){color.x = t;color.y = p;color.z = v;}else{color.x = v;color.y = p;color.z = q;}return color;}void main(){gl_FragColor = vec4(hsvtorgb(((-1.0-textures.y)+1.0)*180.0,1.0,1.0),1.0);}";var P=function(){function e(t){Object(m.a)(this,e),this.gl=t,this.shader=new v([[0,"vertPosition"]],N,t),this.vertices=[-1,1,1,1,-1,-1,1,-1,1,1,-1,-1],this.vao=this.gl.createVertexArray(),this.gl.bindVertexArray(this.vao),this.gl.enableVertexAttribArray(0),this.vbo=t.createBuffer(),this.gl.bindBuffer(t.ARRAY_BUFFER,this.vbo),this.gl.bufferData(t.ARRAY_BUFFER,new Float32Array(this.vertices),t.STATIC_DRAW,0),this.gl.vertexAttribPointer(0,2,t.FLOAT,t.FALSE,0,0),this.gl.bindVertexArray(null),this.gl.disableVertexAttribArray(0)}return Object(h.a)(e,[{key:"draw",value:function(){this.shader.bind(),this.gl.disable(this.gl.DEPTH_TEST),this.gl.disable(this.gl.CULL_FACE);var e=x.createTransformationMatrix(.5,-.8,0,0,0,0,.02,.15,.1);this.gl.enableVertexAttribArray(0),this.gl.bindVertexArray(this.vao),this.shader.setUniform4fv("transformation",e),this.gl.drawArrays(this.gl.TRIANGLES,0,this.vertices.length/2),this.gl.bindVertexArray(null),this.gl.disableVertexAttribArray(0),this.shader.unBind()}}]),e}(),U=function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,null,[{key:"parseData",value:function(e){function t(e,t){var a=new Uint8Array([e.charCodeAt(t),e.charCodeAt(t+1),e.charCodeAt(t+2),e.charCodeAt(t+3)]);return new Float32Array(a.buffer)[0]}for(var a=[],n=[],r=function(e,t){var a=new Uint8Array([e.charCodeAt(t),e.charCodeAt(t+1),e.charCodeAt(t+2),e.charCodeAt(t+3)]);return new Int32Array(a.buffer)[0]}(e,80),o=0;o<r;o++)for(var i=0;i<9;i++)a.push(t(e,96+4*i+50*o));for(o=0;o<r;o++){for(i=0;i<3;i++)n.push(t(e,84+4*i+50*o));for(i=0;i<3;i++)n.push(t(e,84+4*i+50*o));for(i=0;i<3;i++)n.push(t(e,84+4*i+50*o))}var s=new B;return s.vertices=a,s.normals=n,s}}]),e}(),B=function e(){Object(m.a)(this,e),this.vertices=[],this.normals=[]},F=U,V=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var r;return Object(m.a)(this,a),(r=t.call(this,e)).state={hint:" ",colorMinHint:"0 keV",colorMaxHint:"0 keV"},r.canvas=Object(n.createRef)(),r.camera=new E(45,-45,100,new y(0,0,0),new y(0,0,0)),r.oldX=0,r.oldY=0,r.move=!1,r.x=0,r.y=0,r.keyDown=" ".concat(0),r.down=!1,r.renderer=null,r.instanceRenderer=null,r.particles=[],r.drawTracks=!1,r.drawParticles=!0,r.drawGrid=!1,r.gl=null,r.updateHint=r.updateHint.bind(Object(d.a)(r)),r.updateColorHint=r.updateColorHint.bind(Object(d.a)(r)),r}return Object(h.a)(a,[{key:"updateColorHint",value:function(e,t){this.setState({colorMaxHint:e,colorMinHint:t})}},{key:"updateHint",value:function(e){this.setState({hint:e})}},{key:"setShowTracks",value:function(e){this.renderer.drawTracks=e}},{key:"setShowAxes",value:function(e){this.renderer.drawAxes=e}},{key:"getMouseXd",value:function(){return this.oldX-this.x}},{key:"getMouseYd",value:function(){return this.oldY-this.y}},{key:"clearRun",value:function(){this.particles=[],this.renderer.clearTracks()}},{key:"componentDidMount",value:function(){var e=this;this.gl=this.canvas.current.getContext("webgl2");var t=new C(this.gl);this.renderer=new L(this.gl),this.instanceRenderer=new A(z.vertices,this.gl),this.guiRenderer=new P(this.gl);requestAnimationFrame((function a(){e.gl.clearColor(.2,.2,.2,1),e.gl.clear(e.gl.COLOR_BUFFER_BIT);var n,r=x.createProjectionMatrix(70,.1*e.camera.d,1e3*e.camera.d,e.canvas.current.offsetWidth,e.canvas.current.offsetHeight);e.down&&e.move&&(17===e.keyDown?(e.camera.a.y-=.01*e.getMouseYd()*e.camera.d*((89-Math.abs(e.camera.y))/89)*.01,e.camera.a.x-=Math.cos(e.camera.x/(180/Math.PI))*e.getMouseXd()*.01*e.camera.d*((89-Math.abs(e.camera.y))/89)*.01,e.camera.a.z+=Math.sin(e.camera.x/(180/Math.PI))*e.getMouseXd()*.01*e.camera.d*((89-Math.abs(e.camera.y))/89)*.01,e.camera.a.x-=.01*(Math.cos(e.camera.x/(180/Math.PI))*e.getMouseXd()*.01*e.camera.d+Math.sin(e.camera.x/(180/Math.PI))*e.getMouseYd()*.01*e.camera.d),e.camera.a.z-=.01*(Math.cos(e.camera.x/(180/Math.PI))*e.getMouseYd()*.01*e.camera.d+Math.sin(e.camera.x/(180/Math.PI))*-e.getMouseXd()*.01*e.camera.d)):(e.camera.x+=e.getMouseXd()/2,e.camera.y+=e.getMouseYd()/2)),e.drawGrid&&t.draw(r,e.camera,e.canvas.current.offsetWidth,e.canvas.current.offsetHeight,e.camera.d,e.updateHint),e.renderer.draw(r,e.camera),e.drawParticles&&e.instanceRenderer.render(e.particles,x.createViewMatrix(e.camera),r,e.camera.d,e.gl),e.guiRenderer.draw(),(n=e.camera).y>89&&(n.y=89),n.y<-89&&(n.y=-89),n.p.x=n.d*-Math.sin(n.x*Math.PI/180)*Math.cos(n.y*Math.PI/180)+n.a.x,n.p.y=n.d*-Math.sin(n.y*Math.PI/180)+n.a.y,n.p.z=-n.d*Math.cos(n.x*Math.PI/180)*Math.cos(n.y*Math.PI/180)+n.a.z,e.move=!1,requestAnimationFrame(a)}))}},{key:"addSource",value:function(e,t,a,n){var r=new I(new D(z.vertices,z.normals,this.gl),new y(e,t,a),n);return r.model.drawLines=!1,r.model.position=new y(e,t,a),this.renderer.addSource(r),r}},{key:"addParticle",value:function(e){this.particles.push(e)}},{key:"addSTLDetector",value:function(e,t,a,n,r,o,i,s,l,c,u){var m=new j(new D(u.vertices,u.normals,this.gl));return m.model.drawLines=!1,m.model.color=new y(1,1,1),m.model.position.x=e,m.model.position.y=t,m.model.position.z=a,m.model.rotation.x=n,m.model.rotation.y=r,m.model.rotation.z=o,m.model.scale.x=i,m.model.scale.y=s,m.model.scale.z=l,m.material=c,this.renderer.addDetector(m),m}},{key:"addDetector",value:function(){var e=Object(u.a)(c.a.mark((function e(t,a,n,r,o,i,s,l,u,m,h,d){var p,g,v,f,b,E=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(p=null,g=function(){p.model.drawLines=!1,p.model.color=new y(1,1,1),p.model.position.x=t,p.model.position.y=a,p.model.position.z=n,p.model.rotation.x=r,p.model.rotation.y=o,p.model.rotation.z=i,p.model.scale.x=s,p.model.scale.y=l,p.model.scale.z=u,p.material=m,E.renderer.addDetector(p)},v="",f=0;f<d.length;f++)h==d[f].name&&(v=d[f].data);return b=F.parseData(v),p=new j(new D(b.vertices,b.normals,this.gl)),g(),e.abrupt("return",p);case 8:case"end":return e.stop()}}),e,this)})));return function(t,a,n,r,o,i,s,l,c,u,m,h){return e.apply(this,arguments)}}()},{key:"addModel",value:function(e,t){var a=new D(e,t,this.gl);return this.renderer.addModel(a),a}},{key:"addGun",value:function(e,t,a,n,r,o,i){var s=new D(M.vertices,M.normals,this.gl);s.drawLines=!1;var l=new T(s,new y(e,t,a),new y(n,r,o),i);return l.model.position=new y(e,t,a),this.renderer.addGun(l),l}},{key:"clearSetup",value:function(){this.renderer.clearSetup()}},{key:"removeSource",value:function(e){this.renderer.removeSource(e)}},{key:"removeDetector",value:function(e){this.renderer.removeDetector(e)}},{key:"removeGun",value:function(e){this.renderer.removeGun(e)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("p",{ref:this.hint,style:{position:"fixed",bottom:"10%",left:"20%","z-index":"4",color:"white"}},this.state.hint),r.a.createElement("p",{ref:this.colorMinHint,style:{position:"fixed",bottom:"0%",left:"71%","z-index":"4",color:"white"}},this.state.colorMinHint),r.a.createElement("p",{ref:this.colorMaxHint,style:{position:"fixed",bottom:"15%",left:"71%","z-index":"4",color:"white"}},this.state.colorMaxHint),r.a.createElement("canvas",{ref:this.canvas,onMouseMove:function(t){e.move=!0,e.oldX=e.x,e.oldY=e.y,e.x=t.pageX,e.y=t.pageY},tabIndex:"0",width:"2000",height:"2000",style:{position:"fixed",right:0,left:0,width:"100%",height:"100%"},onKeyDown:function(t){e.keyDown=t.keyCode},onKeyUp:function(t){e.keyDown=" ".concat(0)},onMouseDown:function(){e.down=!0},onMouseUp:function(){e.down=!1},onWheel:function(t){var a=0;a=t.deltaY>0?1:-1,e.camera.d+=e.camera.d/(100*a)*10}}))}}]),a}(n.Component),_=a(511),H=a(510),Y=a(199),G=a(521),X=a(517),q=a(518),K=(a(22),a(522)),W=a(197),Q=(a(94),a(514)),J=a(515),Z=function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,null,[{key:"get",value:function(t){for(var a=0;a<e.materials.length;a++)if(t==e.materials[a].symbol)return e.materials[a];return t}},{key:"check",value:function(t){for(var a=0;a<e.materials.length;a++)if(t==e.materials[a])return!0;return!1}},{key:"checkMaterial",value:function(t,a){for(var n=0;n<e.materials.length;n++)if(t==e.materials[n].symbol)return!0;for(var r=0;r<e.compounds.length;r++)if(t==e.compounds[r])return!0;return a(),!1}},{key:"checkSource",value:function(t,a){for(var n=0;n<e.sources.length;n++)if(t==e.sources[n])return!0;return a(),!1}}]),e}();Z.sources=["Ac225","Ac227A","Ac227B","Ac228A","Ac228B","Am241","Am243","Am245","At215","At217A","At217B","At218A","At218B","At219A","At219B","Bi209","Bi210A","Bi210B","Bi211A","Bi211B","Bi212A","Bi212B","Bi213A","Bi213B","Bi214A","Bi214B","Bi215","Bk249A","Bk249B","Cf249","Cf253A","Cf253B","Cm244","Cm245","Cm249","Co60","Es253","Fr221","Fr223A","Fr223B","Fr224","Hg206","Ni60","Np237","Np239","Pa231","Pa233","Pa234","Pa234MB","Pa234MI","Pb206","Pb207","Pb208","Pb209","Pb210A","Pb210B","Pb211","Pb212","Pb214","Po210","Po211","Po212","Po213","Po214","Po215A","Po215B","Po216","Po218A","Po218B","Pu236","Pu238","Pu239","Pu240","Pu241A","Pu241B","Pu242","Ra223","Ra224","Ra225","Ra226","Ra228","Rn217","Rn218","Rn219","Rn220","Rn222","Th227","Th228","Th229","Th230","Th231","Th232","Th234","Tl206","Tl207","Tl208","Tl209","Tl210","U232","U233","U234","U235","U236","U237","U238"],Z.compounds=["A-150_TISSUE","ACETONE","ACETYLENE","ADENINE","ADIPOSE_TISSUE_ICRP","AIR","ALANINE","ALUMINUM_OXIDE","AMBER","AMMONIA","ANILINE","ANTHRACENE","B-100_BONE","BAKELITE","BARIUM_FLUORIDE","BARIUM_SULFATE","BENZENE","BERYLLIUM_OXIDE","BGO","BLOOD_ICRP","BONE_COMPACT_ICRU","BONE_CORTICAL_ICRP","BORON_CARBIDE","BORON_OXIDE","BRAIN_ICRP","BUTANE","N-BUTYL_ALCOHOL","C-552","CADMIUM_TELLURIDE","CADMIUM_TUNGSTATE","CALCIUM_CARBONATE","CALCIUM_FLUORIDE","CALCIUM_OXIDE","CALCIUM_SULFATE","CALCIUM_TUNGSTATE","CARBON_DIOXIDE","CARBON_TETRACHLORIDE","CELLULOSE_CELLOPHANE","CELLULOSE_BUTYRATE","CELLULOSE_NITRATE","CERIC_SULFATE","CESIUM_FLUORIDE","CESIUM_IODIDE","CHLOROBENZENE","CHLOROFORM","CONCRETE","CYCLOHEXANE","1,2-DICHLOROBENZENE","DICHLORODIETHYL_ETHER","1,2-DICHLOROETHANE","DIETHYL_ETHER","N,N-DIMETHYL_FORMAMIDE","DIMETHYL_SULFOXIDE","ETHANE","ETHYL_ALCOHOL","ETHYL_CELLULOSE","ETHYLENE","EYE_LENS_ICRP","FERRIC_OXIDE","FERROBORIDE","FERROUS_OXIDE","FERROUS_SULFATE","FREON-12","FREON-12B2","FREON-13","FREON-13B1","FREON-13I1","GADOLINIUM_OXYSULFIDE","GALLIUM_ARSENIDE","GEL_PHOTO_EMULSION","Pyrex_Glass","GLASS_LEAD","GLASS_PLATE","GLUTAMINE","GLYCEROL","GUANINE","GYPSUM","N-HEPTANE","N-HEXANE","KAPTON","LANTHANUM_OXYBROMIDE","LANTHANUM_OXYSULFIDE","LEAD_OXIDE","LITHIUM_AMIDE","LITHIUM_CARBONATE","LITHIUM_FLUORIDE","LITHIUM_HYDRIDE","LITHIUM_IODIDE","LITHIUM_OXIDE","LITHIUM_TETRABORATE","LUNG_ICRP","M3_WAX","MAGNESIUM_CARBONATE","MAGNESIUM_FLUORIDE","MAGNESIUM_OXIDE","MAGNESIUM_TETRABORATE","MERCURIC_IODIDE","METHANE","METHANOL","MIX_D_WAX","MS20_TISSUE","MUSCLE_SKELETAL_ICRP","MUSCLE_STRIATED_ICRU","MUSCLE_WITH_SUCROSE","MUSCLE_WITHOUT_SUCROSE","NAPHTHALENE","NITROBENZENE","NITROUS_OXIDE","NYLON-8062","NYLON-6-6","NYLON-6-10","NYLON-11_RILSAN","OCTANE","PARAFFIN","N-PENTANE","PHOTO_EMULSION","PLASTIC_SC_VINYLTOLUENE","PLUTONIUM_DIOXIDE","POLYACRYLONITRILE","POLYCARBONATE","POLYCHLOROSTYRENE","POLYETHYLENE","MYLAR","PLEXIGLASS","POLYOXYMETHYLENE","POLYPROPYLENE","POLYSTYRENE","TEFLON","POLYTRIFLUOROCHLOROETHYLENE","POLYVINYL_ACETATE","POLYVINYL_ALCOHOL","POLYVINYL_BUTYRAL","POLYVINYL_CHLORIDE","POLYVINYLIDENE_CHLORIDE","POLYVINYLIDENE_FLUORIDE","POLYVINYL_PYRROLIDONE","POTASSIUM_IODIDE","POTASSIUM_OXIDE","PROPANE","lPROPANE","N-PROPYL_ALCOHOL","PYRIDINE","RUBBER_BUTYL","RUBBER_NATURAL","RUBBER_NEOPRENE","SILICON_DIOXIDE","SILVER_BROMIDE","SILVER_CHLORIDE","SILVER_HALIDES","SILVER_IODIDE","SKIN_ICRP","SODIUM_CARBONATE","SODIUM_IODIDE","SODIUM_MONOXIDE","SODIUM_NITRATE","STILBENE","SUCROSE","TERPHENYL","TESTIS_ICRP","TETRACHLOROETHYLENE","THALLIUM_CHLORIDE","TISSUE_SOFT_ICRP","TISSUE_SOFT_ICRU-4","TISSUE-METHANE","TISSUE-PROPANE","TITANIUM_DIOXIDE","TOLUENE","TRICHLOROETHYLENE","TRIETHYL_PHOSPHATE","TUNGSTEN_HEXAFLUORIDE","URANIUM_DICARBIDE","URANIUM_MONOCARBIDE","URANIUM_OXIDE","UREA","VALINE","VITON","WATER","WATER_VAPOR","XYLENE","GRAPHITE"],Z.materials=[{symbol:"H",z:1,name:"Hydrogen"},{symbol:"He",z:2,name:"Helium"},{symbol:"Li",z:3,name:"Lithium"},{symbol:"Be",z:4,name:"Beryllium"},{symbol:"B",z:5,name:"Boron"},{symbol:"C",z:6,name:"Carbon"},{symbol:"N",z:7,name:"Nitrogen"},{symbol:"O",z:8,name:"Oxygen"},{symbol:"F",z:9,name:"Fluorine"},{symbol:"Ne",z:10,name:"Neon"},{symbol:"Na",z:11,name:"Sodium"},{symbol:"Mg",z:12,name:"Magnesium"},{symbol:"Al",z:13,name:"Aluminium"},{symbol:"Si",z:14,name:"Silicon"},{symbol:"P",z:15,name:"Phosphorus"},{symbol:"S",z:16,name:"Sulfur"},{symbol:"Cl",z:17,name:"Chlorine"},{symbol:"Ar",z:18,name:"Argon"},{symbol:"K",z:19,name:"Potassium"},{symbol:"Ca",z:20,name:"Calcium"},{symbol:"Sc",z:21,name:"Scandium"},{symbol:"Ti",z:22,name:"Titanium"},{symbol:"V",z:23,name:"Vanadium"},{symbol:"Cr",z:24,name:"Chromium"},{symbol:"Mn",z:25,name:"Manganese"},{symbol:"Fe",z:26,name:"Iron"},{symbol:"Co",z:27,name:"Cobalt"},{symbol:"Ni",z:28,name:"Nickel"},{symbol:"Cu",z:29,name:"Copper"},{symbol:"Zn",z:30,name:"Zinc"},{symbol:"Ga",z:31,name:"Gallium"},{symbol:"Ge",z:32,name:"Germanium"},{symbol:"As",z:33,name:"Arsenic"},{symbol:"Se",z:34,name:"Selenium"},{symbol:"Br",z:35,name:"Bromine"},{symbol:"Kr",z:36,name:"Krypton"},{symbol:"Rb",z:37,name:"Rubidium"},{symbol:"Sr",z:38,name:"Strontium"},{symbol:"Y",z:39,name:"Yttrium"},{symbol:"Zr",z:40,name:"Zirconium"},{symbol:"Nb",z:41,name:"Niobium"},{symbol:"Mo",z:42,name:"Molybdenum"},{symbol:"Tc",z:43,name:"Technetium"},{symbol:"Ru",z:44,name:"Ruthenium"},{symbol:"Rh",z:45,name:"Rhodium"},{symbol:"Pd",z:46,name:"Palladium"},{symbol:"Ag",z:47,name:"Silver"},{symbol:"Cd",z:48,name:"Cadmium"},{symbol:"In",z:49,name:"Indium"},{symbol:"Sn",z:50,name:""},{symbol:"Sb",z:51,name:"Antimony"},{symbol:"Te",z:52,name:"Tellurium"},{symbol:"I",z:53,name:"Iodine"},{symbol:"Xe",z:54,name:"Xenon"},{symbol:"Cs",z:55,name:"Caesium"},{symbol:"Ba",z:56,name:"Barium"},{symbol:"La",z:57,name:"Lanthanum"},{symbol:"Ce",z:58,name:"Cerium"},{symbol:"Pr",z:59,name:"Praseodymium"},{symbol:"Nd",z:60,name:"Neodymium"},{symbol:"Pm",z:61,name:"Promethium"},{symbol:"Sm",z:62,name:"Samarium"},{symbol:"Eu",z:63,name:"Europium"},{symbol:"Gd",z:64,name:"Gadolinium"},{symbol:"Tb",z:65,name:"Terbium"},{symbol:"Dy",z:66,name:"Dysprosium"},{symbol:"Ho",z:67,name:"Holmium"},{symbol:"Er",z:68,name:"Erbium"},{symbol:"Tm",z:69,name:"Thulium"},{symbol:"Yb",z:70,name:"Ytterbium"},{symbol:"Lu",z:71,name:"Lutetium"},{symbol:"Hf",z:72,name:"Hafnium"},{symbol:"Ta",z:73,name:"Tantalum"},{symbol:"W",z:74,name:"Tungsten"},{symbol:"Re",z:75,name:"Rhenium"},{symbol:"Os",z:76,name:"Osmium"},{symbol:"Ir",z:77,name:"Iridium"},{symbol:"Pt",z:78,name:"Platinum"},{symbol:"Au",z:79,name:"Gold"},{symbol:"Hg",z:80,name:"Mercury"},{symbol:"Tl",z:81,name:"Thallium"},{symbol:"Pb",z:82,name:"Lead"},{symbol:"Bi",z:83,name:"Bismuth"},{symbol:"Po",z:84,name:"Polonium"},{symbol:"At",z:85,name:"Astatine"},{symbol:"Rn",z:86,name:"Radon"},{symbol:"Fr",z:87,name:"Francium"},{symbol:"Ra",z:88,name:"Radium"},{symbol:"Ac",z:89,name:"Actinium"},{symbol:"Th",z:90,name:"Thorium"},{symbol:"Pa",z:91,name:"Protactinium"},{symbol:"U",z:92,name:"Uranium"},{symbol:"Np",z:93,name:"Neptunium"},{symbol:"Pu",z:94,name:"Plutonium"},{symbol:"Am",z:95,name:"Americium"},{symbol:"Cm",z:96,name:"Curium"},{symbol:"Bk",z:97,name:"Berkelium"},{symbol:"Cf",z:98,name:"Californium"}];var $=Z,ee=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).showDialog=n.showDialog.bind(Object(d.a)(n)),n.hideDialog=n.hideDialog.bind(Object(d.a)(n)),n.state={show:!1},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){}},{key:"showDialog",value:function(){this.setState({show:!0})}},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Q.a,{show:this.state.show,onHide:function(){e.hideDialog()}},r.a.createElement(Q.a.Header,{closeButton:!0},r.a.createElement(Q.a.Title,null,this.props.title)),r.a.createElement(Q.a.Body,null,this.props.content),r.a.createElement(Q.a.Footer,null,r.a.createElement(W.a,{variant:"secondary",onClick:function(){e.hideDialog()}},"No"),r.a.createElement(W.a,{variant:"primary",onClick:function(){e.props.fun(),e.hideDialog()}},"Yes"))))}}]),a}(n.Component),te=function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,null,[{key:"addVolume",value:function(t){e.volumes.push(t)}},{key:"removeVolume",value:function(t){for(var a=0;a<e.volumes.length;a++)t==e[a]&&e.volumes.splice(a,1)}},{key:"getVolume",value:function(t){for(var a=0;a<e.volumes.length;a++)if(e.volumes[a].name==t)return e.volumes[a]}},{key:"updateVolume",value:function(e){}}]),e}();te.volumes=[];var ae=te,ne=function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,null,[{key:"init",value:function(t,a){e.showVolumeDialog=t,e.confirmDialog=a}},{key:"checkString",value:function(e){return(e=e.trim()).split('"').length%2!=0&&('"'==e[0]&&'"'==e[e.length-1])}},{key:"removeChunk",value:function(t){for(var a=" ",n=0;n<e.chunks.length;n++)if(e.chunks[n].id==t){e.chunks.splice(n,1);break}for(var r=0;r<e.chunks.length;r++)a+=e.chunks[r].code;return a}},{key:"checkFloat",value:function(e,t,a){return!isNaN(parseFloat(e.split(",")[0]))&&(!isNaN(parseFloat(e.split(",")[1]))&&(!isNaN(parseFloat(e.split(",")[2]))&&(t.x=parseFloat(e.split(",")[0])*a,t.y=parseFloat(e.split(",")[1])*a,t.z=parseFloat(e.split(",")[2])*a,!0)))}},{key:"parse",value:function(t,a,n,r,o,i){for(var s=this,l=[],c=[],u=[],m=a.gl,h=t.split("\\"),d=!1,p=[],g=function(e){var t=h[e].split("{");t[0]=t[0].replace(" ","");var a=null,n=null,r=null,o="cube";"Detector"==t[0]&&(a=new j(new D(z.vertices,z.normals,m))),"Source"==t[0]&&(n=new I(new D(z.vertices,z.normals,m),new y(0,0,0),"U235")),"Gun"==t[0]&&(r=new T(new D(z.vertices,z.normals,m),new y(0,0,0),new y(0,0,0),0));for(var i=0;i<t.length;i++)for(var g=t[i].split(";"),v=0;v<g.length;v++)if(g[v].split("(")[0].trim(),1!=g[v].split(":").length){var f=g[v].split(":")[0].trim(),b=1;switch(f.substring(f.indexOf("[")+1,f.indexOf("]"))){case"eV":b=.001;break;case"keV":b=1;break;case"MeV":b=1e3;break;case"GeV":b=1e6;break;case"mm":b=.1;break;case"deg":b=.0174527777777778;break;case"rad":case"cm":b=1;break;case"dm":b=10;break;case"m":b=100;break;default:b=1}f.includes("[")&&(f=f.substr(0,f.indexOf("[")));var E=g[v].split(":")[1].replace(/\n/g,"");if("Detector"==t[0])switch(f){case"geometry":o=E.trim().substring(1,E.trim().length-1),a.geometry=o,void 0==ae.getVolume(o)&&(d=!0,p.includes(o)||p.push(o));break;case"position":s.checkFloat(E,a.model.position,b)||alert("position incorrec format");break;case"rotation":s.checkFloat(E,a.model.rotation,b)||alert("rotation incorrec format");break;case"scale":s.checkFloat(E,a.model.scale,b)||alert("scale incorrec format");break;case"material":s.checkString(E)||alert("meterial incorrect format"),a.material=E.trim().substring(1,E.trim().length-1),$.checkMaterial(a.material,(function(){alert("No material named: "+a.material+"\nMaterial set to Lead(Pb)!"),a.material="Pb"}));break;case"name":if(s.checkString(E)||alert("name incorrect format"),a.name=E.trim().substring(1,E.trim().length-1),a.name.length>15)return s.confirmDialog("Name too long","The name you've given to detector "+a.name+" was too long, maximum length is 15 characters.",(function(){})),{v:void 0};break;default:alert("No such property: "+f)}if("Source"==t[0])switch(f){case"position":s.checkFloat(E,n.model.position,b)||alert("position incorrec format");break;case"material":s.checkString(E)||alert("material incorrect format"),n.material=E.trim().substring(1,E.trim().length-1),$.checkSource(n.material,(function(){alert("No source named: "+n.material+"\nSource set to Cobalt(Co60)!"),n.material="Co60"}));break;case"name":if(s.checkString(E)||alert("name incorrect format"),n.name=E.trim().substring(1,E.trim().length-1),n.name.length>15)return s.confirmDialog("Name too long","The name you've given to source "+n.name+" was too long, maximum length is 15 characters.",(function(){})),{v:void 0};break;default:alert("No such property: "+f)}if("Gun"==t[0])switch(f){case"position":s.checkFloat(E,r.model.position,b)||alert("position incorrec format");break;case"direction":s.checkFloat(E,r.direction,b)||alert("direction incorrec format");break;case"energy":r.energy=parseFloat(E)*b;break;case"name":if(s.checkString(E)||alert("name incorrect format"),r.name=E.trim().substring(1,E.trim().length-1),r.name.length>15)return s.confirmDialog("Name too long","The name you've given to gun "+r.name+" was too long, maximum length is 15 characters.",(function(){})),{v:void 0};break;default:alert("No such property: "+f)}}null!=r&&u.push(r),null!=n&&c.push(n),null!=a&&void 0!=ae.getVolume(o)&&l.push(a)},v=0;v<h.length;v++){var f=g(v);if("object"===typeof f)return f.v}d?e.confirmDialog("Volume not found!","Add the volume to the volume list before referencing it in the script then click 'Run script' again.",(function(){e.showVolumeDialog.showDialog(p,(function(){}))})):(n(),u.forEach((function(e){i(e.name,e.model.position.x,e.model.position.y,e.model.position.z,e.direction.x,e.direction.y,e.direction.z,e.energy,!1)})),c.forEach((function(e){o(e.name,e.model.position.x,e.model.position.y,e.model.position.z,e.material,!1)})),l.forEach((function(e){r(e.name,e.model.position.x,e.model.position.y,e.model.position.z,e.model.rotation.x,e.model.rotation.y,e.model.rotation.z,e.model.scale.x,e.model.scale.y,e.model.scale.z,e.material,e.geometry,ae.getVolume(e.geometry).data,new y(.5,.5,.5),!1)})))}}]),e}();ne.showVolumeDialog=null,ne.confirmDialog=null,ne.chunks=[];var re=ne,oe=a(198),ie=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).showDialog=n.showDialog.bind(Object(d.a)(n)),n.hideDialog=n.hideDialog.bind(Object(d.a)(n)),n.state={show:!1,materials:[],table:"elements",element:!0,compound:!1},n.changeTable=n.changeTable.bind(Object(d.a)(n)),n}return Object(h.a)(a,[{key:"changeTable",value:function(e){"elements"==e&&(this.setState({element:!0}),this.setState({compound:!1})),"compounds"==e&&(this.setState({element:!1}),this.setState({compound:!0})),this.setState({table:e}),this.updateMaterials("",e)}},{key:"componentDidMount",value:function(){this.updateMaterials("",this.state.table)}},{key:"showDialog",value:function(){this.setState({show:!0})}},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"updateMaterials",value:function(e,t){var a=this;"elements"==t&&function(){for(var t=$.materials.filter((function(t){return t.name.toUpperCase().includes(e.toUpperCase())||t.symbol.toUpperCase().includes(e.toUpperCase())})),n=[],o=Math.ceil(t.length/5),i=0;i<o;i++){for(var s=[],l=function(e){if(void 0===t[e])return"break";s.push(r.a.createElement("th",{className:"tablebutton",onClick:function(n){a.props.updatematerial(t[e].symbol),a.hideDialog()}},r.a.createElement("p",{style:{"font-size":"12px"}},t[e].z),r.a.createElement("h1",{style:{"font-size":"15px","font-weight":"bold"}},t[e].symbol),r.a.createElement("p",{style:{"font-size":"12px"}},t[e].name)))},c=Math.floor(i/o*t.length);c<Math.floor(i/o*t.length)+5;c++){if("break"===l(c))break}n.push(r.a.createElement("tr",null,s))}a.setState({materials:n})}(),"compounds"==t&&function(){for(var t=$.compounds.filter((function(t){return t.toUpperCase().includes(e.toUpperCase())})),n=[],o=Math.ceil(t.length/3),i=0;i<o;i++){for(var s=[],l=function(e){if(void 0===t[e])return"break";s.push(r.a.createElement("th",{className:"tablebutton",onClick:function(n){a.props.updatematerial(t[e]),a.hideDialog()}},r.a.createElement("h1",{style:{"font-size":"10px","font-weight":"bold"}},t[e])))},c=Math.floor(i/o*t.length);c<Math.floor(i/o*t.length)+3;c++){if("break"===l(c))break}n.push(r.a.createElement("tr",null,s))}a.setState({materials:n})}()}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Q.a,{show:this.state.show,onHide:function(){e.hideDialog()}},r.a.createElement(Q.a.Header,{closeButton:!0},r.a.createElement(Q.a.Title,null,"Choose a material")),r.a.createElement(Q.a.Body,null,r.a.createElement(oe.a,{type:"text",onChange:function(t){e.updateMaterials(t.target.value,e.state.table)},placeholder:"Search",style:{margin:"20px",width:"200px"}}),r.a.createElement(H.a,{style:{margin:"auto"}},r.a.createElement(W.a,{style:{"background-color":"gray",color:"white","border-radius":"0",border:"1px solid black"},disabled:this.state.element,onClick:function(){e.changeTable("elements")}},"Elements"),r.a.createElement(W.a,{style:{"background-color":"gray",color:"white","border-radius":"0",border:"1px solid black"},disabled:this.state.compound,onClick:function(){e.changeTable("compounds")}},"Compounds")),r.a.createElement(_.a,{style:{margin:"auto"}},this.state.materials)),r.a.createElement(Q.a.Footer,null)))}}]),a}(n.Component),se=function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,null,[{key:"convertLength",value:function(e){switch(e){case".1":return"mm";case"1":return"cm";case"10":return"dm";case"100":return"m";default:return"cm"}}},{key:"convertAngle",value:function(e){return 1==e?"rad":"deg"}},{key:"convertEnergy",value:function(e){switch(e){case"1":return"eV";case"1000":return"keV";case"1000000":return"MeV";case"1000000000":return"GeV";default:return"keV"}}}]),e}(),le=function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,null,[{key:"log",value:function(e,t){fetch("http://radsim.inf.elte.hu:9000/log",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({level:e,message:t})})}},{key:"getLogs",value:function(){var e=Object(u.a)(c.a.mark((function e(){var t,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://radsim.inf.elte.hu:9000/log",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"GET"});case 2:return t=e.sent,e.next=5,t.text();case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),ce=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).showDialog=n.showDialog.bind(Object(d.a)(n)),n.hideDialog=n.hideDialog.bind(Object(d.a)(n)),n.confirmDialog=r.a.createRef(),n.table=r.a.createRef(),n.updateMaterial=n.updateMaterial.bind(Object(d.a)(n)),n.state={show:!1,detname:n.props.detector.name,detposx:n.props.detector.model.position.x/n.props.detector.units[0],detposy:n.props.detector.model.position.y/n.props.detector.units[0],detposz:n.props.detector.model.position.z/n.props.detector.units[0],detrotx:n.props.detector.model.rotation.x/n.props.detector.units[1],detroty:n.props.detector.model.rotation.y/n.props.detector.units[1],detrotz:n.props.detector.model.rotation.z/n.props.detector.units[1],detscalex:n.props.detector.model.scale.x/n.props.detector.units[2],detscaley:n.props.detector.model.scale.y/n.props.detector.units[2],detscalez:n.props.detector.model.scale.z/n.props.detector.units[2],detmat:n.props.detector.material,geomrty:n.props.detector.geometry,posme:n.props.detector.units[0],rotme:n.props.detector.units[1],scaleme:n.props.detector.units[2],showError:"none",modeldata:[],display:"none",filelabel:"",color:n.props.detector.model.color,options:[]},n.materials=[],n}return Object(h.a)(a,[{key:"updateMaterial",value:function(e){this.setState({detmat:e})}},{key:"hexToRgb",value:function(e){e=e.substr(1);var t=parseInt(e,16);return new y((t>>16&255)/255,(t>>8&255)/255,(255&t)/255)}},{key:"componentDidMount",value:function(){}},{key:"showDialog",value:function(){var e=Object(u.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({showError:"none"}),this.setState({show:!0}),a=t.map((function(e){return r.a.createElement("option",{value:e.name},e.name)})),this.setState({options:a});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"convert",value:function(e){switch(e){case".1":return"mm";case"1":return"cm";case"10":return"dm";case"100":return"m";default:return"cm"}}},{key:"convertrot",value:function(e){return 1==e?"rad":"deg"}},{key:"render",value:function(){var e,t,a,n,o,i,l,m,h,d=this,p=[];return p=$.get(this.state.detmat)==this.state.detmat?r.a.createElement("th",{className:"tablebutton",onClick:function(){d.table.current.showDialog()}},r.a.createElement("h1",{style:{"font-size":"10px","font-weight":"bold"}},this.state.detmat)):r.a.createElement("th",{className:"tablebutton",onClick:function(){d.table.current.showDialog()}},r.a.createElement("p",{style:{"font-size":"12px"}},$.get(this.state.detmat).z),r.a.createElement("h1",{style:{"font-size":"15px","font-weight":"bold"}},$.get(this.state.detmat).symbol),r.a.createElement("p",{style:{"font-size":"12px"}},$.get(this.state.detmat).name)),r.a.createElement(r.a.Fragment,null,r.a.createElement(ie,{ref:this.table,updatematerial:this.updateMaterial}),r.a.createElement(ee,{ref:this.confirmDialog,title:"Confirm",content:"Are you sure you want to delete this component?",fun:function(){d.hideDialog(),d.props.removebutton(d.props.detector,d.props.button.id)}}),r.a.createElement(Q.a,{show:this.state.show,onHide:function(){d.hideDialog()}},r.a.createElement(Q.a.Header,{closeButton:!0},r.a.createElement(Q.a.Title,null,"Modify Detector")),r.a.createElement(Q.a.Body,null,r.a.createElement(J.a,null,r.a.createElement(_.a,null,r.a.createElement(H.a,null,"Name ",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,{className:"name",required:!0,type:"text",maxLength:"10",value:this.state.detname,onChange:function(e){d.setState({detname:e.target.value})}}))),r.a.createElement("hr",null),r.a.createElement(H.a,null,"Geometry"),r.a.createElement(J.a.Control,{as:"select",value:this.state.geomrty,onChange:function(e){d.setState({geomrty:e.target.value}),"stl"==e.target.value?d.setState({display:"block"}):d.setState({display:"none"})}},this.state.options,r.a.createElement("option",{value:"stl"},"Custom (.STL)")),r.a.createElement(J.a.File,{style:{display:this.state.display},id:"stl-file",label:this.state.filelabel,"data-browse":"Open",custom:!0,onChange:function(e){var t=new FileReader;t.onload=function(){var e=t.result;d.setState({modeldata:e})},t.readAsBinaryString(e.target.files[0]);var a=e.target.value;a=a.split("\\")[a.split("\\").length-1],d.setState({filelabel:a})}}),r.a.createElement("hr",null),r.a.createElement(H.a,null,"Position"),r.a.createElement(J.a.Control,{as:"select",style:{width:"100px","margin-left":"-15px","margin-bottom":"10px"},value:this.state.posme,onChange:function(e){d.setState({posme:e.target.value})}},r.a.createElement("option",{value:".1"},"mm"),r.a.createElement("option",{value:"1"},"cm"),r.a.createElement("option",{value:"10"},"dm"),r.a.createElement("option",{value:"100"},"m")),r.a.createElement(H.a,null,"x",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(e={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(e,"value",this.state.detposx),Object(s.a)(e,"onChange",(function(e){d.setState({detposx:e.target.value})})),e))),"y",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(t={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(t,"value",this.state.detposy),Object(s.a)(t,"onChange",(function(e){d.setState({detposy:e.target.value})})),t))),"z",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(a={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(a,"value",this.state.detposz),Object(s.a)(a,"onChange",(function(e){d.setState({detposz:e.target.value})})),a)))),r.a.createElement("br",null),r.a.createElement("hr",null),r.a.createElement(H.a,null,"Rotation"),r.a.createElement(J.a.Control,{as:"select",style:{width:"100px","margin-left":"-15px","margin-bottom":"10px"},value:this.state.rotme,onChange:function(e){d.setState({rotme:e.target.value})}},r.a.createElement("option",{value:"0.0174"},"deg"),r.a.createElement("option",{value:"1"},"rad")),r.a.createElement(H.a,null,"x",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(n={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(n,"value",this.state.detrotx),Object(s.a)(n,"onChange",(function(e){d.setState({detrotx:e.target.value})})),n))),"y",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(o={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(o,"value",this.state.detroty),Object(s.a)(o,"onChange",(function(e){d.setState({detroty:e.target.value})})),o))),"z",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(i={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(i,"value",this.state.detrotz),Object(s.a)(i,"onChange",(function(e){d.setState({detrotz:e.target.value})})),i)))),r.a.createElement("br",null),r.a.createElement("hr",null),r.a.createElement(H.a,null,"Scale"),r.a.createElement(J.a.Control,{as:"select",style:{width:"100px","margin-left":"-15px","margin-bottom":"10px"},value:this.state.scaleme,onChange:function(e){d.setState({scaleme:e.target.value})}},r.a.createElement("option",{value:".1"},"mm"),r.a.createElement("option",{value:"1"},"cm"),r.a.createElement("option",{value:"10"},"dm"),r.a.createElement("option",{value:"100"},"m")),r.a.createElement(H.a,null,"x",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(l={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(l,"value",this.state.detscalex),Object(s.a)(l,"onChange",(function(e){d.setState({detscalex:e.target.value})})),l))),"y",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(m={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(m,"value",this.state.detscaley),Object(s.a)(m,"onChange",(function(e){d.setState({detscaley:e.target.value})})),m))),"z",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(h={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(h,"value",this.state.detscalez),Object(s.a)(h,"onChange",(function(e){d.setState({detscalez:e.target.value})})),h)))),r.a.createElement("br",null),r.a.createElement("hr",null),r.a.createElement(H.a,null,r.a.createElement(J.a.Group,{controlId:"exampleForm.SelectCustom"},r.a.createElement(J.a.Label,null,"Material"),p,r.a.createElement(W.a,{onClick:function(){d.table.current.showDialog()}},"Choose"))),r.a.createElement("hr",null),r.a.createElement(H.a,null,"Color: ",r.a.createElement("span",{style:{"padding-left":"20px"}},r.a.createElement("input",{type:"color",onInput:function(e){d.setState({color:d.hexToRgb(e.target.value)})}})))))),r.a.createElement(Q.a.Footer,null,r.a.createElement(W.a,{variant:"secondary",onClick:function(){d.confirmDialog.current.showDialog()},style:{backgroundColor:"red",color:"white"}},"Delete"),r.a.createElement(W.a,{variant:"primary",onClick:Object(u.a)(c.a.mark((function e(){var t,a,n,o,i,s,l,u,m,h,p;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(le.log(3,"Modified detector"),d.hideDialog(),"stl"!=d.state.geomrty){e.next=8;break}t=F.parseData(d.state.modeldata),d.props.detector.model=new D(t.vertices,t.normals,d.props.canvas.current.gl),d.props.detector.model.drawLines=!1,e.next=20;break;case 8:return e.next=10,fetch("http://radsim.inf.elte.hu:9000/database",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({name:d.state.geomrty})});case 10:return a=e.sent,e.next=13,a.json();case 13:for(n=e.sent,new String(n[0].data.data),o="",i=0;i<n[0].data.data.length;i++)o+=String.fromCharCode(n[0].data.data[i]);s=F.parseData(o),d.props.detector.model=new D(s.vertices,s.normals,d.props.canvas.current.gl),d.props.detector.model.drawLines=!1;case 20:for(d.props.detector.name=d.state.detname,d.props.detector.model.position.x=d.state.detposx*d.state.posme,d.props.detector.model.position.y=d.state.detposy*d.state.posme,d.props.detector.model.position.z=d.state.detposz*d.state.posme,d.props.detector.model.rotation.x=d.state.detrotx*d.state.rotme,d.props.detector.model.rotation.y=d.state.detroty*d.state.rotme,d.props.detector.model.rotation.z=d.state.detrotz*d.state.rotme,d.props.detector.model.scale.x=d.state.detscalex*d.state.scaleme,d.props.detector.model.scale.y=d.state.detscaley*d.state.scaleme,d.props.detector.model.scale.z=d.state.detscalez*d.state.scaleme,d.props.detector.material=d.state.detmat,d.props.detector.model.color=d.state.color,d.props.setname(d.state.detname),l="",u=se.convertLength(d.state.posme),m=se.convertAngle(d.state.rotme),h=se.convertLength(d.state.scaleme),p=0;p<re.chunks.length;p++)d.props.buttonid==re.chunks[p].id&&(re.chunks[p].code='\\Detector{\n\tname: "'+d.state.detname+'";\n\tposition['+u+"]: "+d.state.detposx+", "+d.state.detposy+", "+d.state.detposz+";\n\trotation["+m+"]: "+d.state.detrotx+", "+d.state.detroty+", "+d.state.detrotz+";\n\tscale["+h+"]: "+d.state.detscalex+", "+d.state.detscaley+", "+d.state.detscalez+';\n\tmaterial: "'+d.state.detmat+'";\n\tgeometry: "'+d.state.geomrty+'";\n}\n'),l+=re.chunks[p].code;d.props.codeeditor.current.updateText(l),d.props.updatedetails(r.a.createElement(r.a.Fragment,null,r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"Position: ")),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"x: ",d.state.detposx," ",u),r.a.createElement(Y.a,null,"y: ",d.state.detposy," ",u),r.a.createElement(Y.a,null,"z: ",d.state.detposz," ",u)),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"Rotation: ")),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"x: ",d.state.detrotx," ",m),r.a.createElement(Y.a,null,"y: ",d.state.detroty," ",m),r.a.createElement(Y.a,null,"z: ",d.state.detrotz," ",m)),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"Scale: ")),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"x: ",d.state.detscalex," ",h),r.a.createElement(Y.a,null,"y: ",d.state.detscaley," ",h),r.a.createElement(Y.a,null,"z: ",d.state.detscalez," ",h)),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"Material: ")),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,d.state.detmat))));case 40:case"end":return e.stop()}}),e)})))},"Modify"))))}}]),a}(n.Component);ce.id=0;var ue=ce,me=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).editdialog=r.a.createRef(),n.updateDetails=n.updateDetails.bind(Object(d.a)(n)),n.setName=n.setName.bind(Object(d.a)(n)),n.state={details:n.props.details,name:n.props.name},n.id=n.props.id,n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){}},{key:"updateDetails",value:function(e){this.setState({details:e})}},{key:"setName",value:function(e){this.setState({name:e})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(ue,{setname:this.setName,canvas:this.props.canvas,name:this.props.name,buttonid:this.id,codeeditor:this.props.codeeditor,updatedetails:this.updateDetails,button:this,removebutton:this.props.removebutton,detector:this.props.detector,ref:this.editdialog,buttons:this.props.buttons,details:this.props.details}),r.a.createElement(K.a,{className:"button"},r.a.createElement(K.a.Header,null,r.a.createElement(q.a.Toggle,{as:W.a,onClick:function(){L.active_id!=e.props.detector.id?L.active_id=e.props.detector.id:L.active_id=-1},variant:"link",eventKey:this.id},this.state.name),r.a.createElement(W.a,{onClick:function(){e.editdialog.current.showDialog(e.props.volumes)},className:"editButton"},"EDIT")),r.a.createElement(q.a.Collapse,{eventKey:this.id},r.a.createElement(K.a.Body,null,this.state.details))))}}]),a}(n.Component);me.id=0;var he=me,de=a(519),pe=a(516),ge=a(520),ve=a(513),fe=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).showDialog=n.showDialog.bind(Object(d.a)(n)),n.hideDialog=n.hideDialog.bind(Object(d.a)(n)),n.updateMaterial=n.updateMaterial.bind(Object(d.a)(n)),n.table=r.a.createRef(),n.state={show:!1,detname:"Detector",detposx:0,detposy:0,detposz:0,detrotx:0,detroty:0,detrotz:0,detscalex:10,detscaley:10,detscalez:10,posme:1,rotme:1,scaleme:1,detmat:"Pb",geomrty:"cube",display:"none",filelabel:"Path to STL",modeldata:null,showError:"none",color:new y(.5,.5,.5),options:[]},n}return Object(h.a)(a,[{key:"updateMaterial",value:function(e){this.setState({detmat:e})}},{key:"componentDidMount",value:function(){}},{key:"hexToRgb",value:function(e){e=e.substr(1);var t=parseInt(e,16);return new y((t>>16&255)/255,(t>>8&255)/255,(255&t)/255)}},{key:"addMaterial",value:function(e,t){this.materials.push(r.a.createElement("option",{value:e},t))}},{key:"showDialog",value:function(){var e=Object(u.a)(c.a.mark((function e(t){var a,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({show:!0}),a="Detector"+this.props.buttons.length,this.setState({detname:a}),n=t.map((function(e){return r.a.createElement("option",{value:e.name},e.name)})),this.setState({options:n});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e,t,a,n,o,i,l,c,u,m=this,h=[];return h=$.get(this.state.detmat)==this.state.detmat?r.a.createElement("th",{className:"tablebutton",onClick:function(){m.table.current.showDialog()}},r.a.createElement("h1",{style:{"font-size":"10px","font-weight":"bold"}},this.state.detmat)):r.a.createElement("th",{className:"tablebutton",onClick:function(){m.table.current.showDialog()}},r.a.createElement("p",{style:{"font-size":"12px"}},$.get(this.state.detmat).z),r.a.createElement("h1",{style:{"font-size":"15px","font-weight":"bold"}},$.get(this.state.detmat).symbol),r.a.createElement("p",{style:{"font-size":"12px"}},$.get(this.state.detmat).name)),r.a.createElement(r.a.Fragment,null,r.a.createElement(ie,{ref:this.table,updatematerial:this.updateMaterial}),r.a.createElement(Q.a,{show:this.state.show,onHide:function(){m.hideDialog()}},r.a.createElement(Q.a.Header,{closeButton:!0},r.a.createElement(Q.a.Title,null,"Create detector")),r.a.createElement(Q.a.Body,null,r.a.createElement(J.a,null,r.a.createElement(_.a,null,r.a.createElement(H.a,null,"Name ",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,{className:"name",required:!0,type:"text",maxLength:"10",value:this.state.detname,onChange:function(e){m.setState({detname:e.target.value})}}))),r.a.createElement("hr",null),r.a.createElement(H.a,null,"Geometry"),r.a.createElement(J.a.Control,{as:"select",value:this.state.geomrty,onChange:function(e){m.setState({geomrty:e.target.value}),"stl"==e.target.value?m.setState({display:"block"}):m.setState({display:"none"})}},this.state.options,r.a.createElement("option",{value:"stl"},"Custom (.STL)")),r.a.createElement(J.a.File,{style:{display:this.state.display},id:"stl-file",label:this.state.filelabel,"data-browse":"Open",custom:!0,onChange:function(e){var t=new FileReader;t.onload=function(){var e=t.result;m.setState({modeldata:e})},t.readAsBinaryString(e.target.files[0]);var a=e.target.value;a=a.split("\\")[a.split("\\").length-1],m.setState({filelabel:a})}}),r.a.createElement("hr",null),r.a.createElement(H.a,null,"Position"),r.a.createElement(J.a.Control,{as:"select",style:{width:"100px","margin-left":"-15px","margin-bottom":"10px"},value:this.state.posme,onChange:function(e){m.setState({posme:e.target.value})}},r.a.createElement("option",{value:".1"},"mm"),r.a.createElement("option",{value:"1"},"cm"),r.a.createElement("option",{value:"10"},"dm"),r.a.createElement("option",{value:"100"},"m")),r.a.createElement(H.a,null,"x",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(e={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(e,"value",this.state.detposx),Object(s.a)(e,"onChange",(function(e){m.setState({detposx:e.target.value})})),e))),"y",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(t={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(t,"value",this.state.detposy),Object(s.a)(t,"onChange",(function(e){m.setState({detposy:e.target.value})})),t))),"z",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(a={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(a,"value",this.state.detposz),Object(s.a)(a,"onChange",(function(e){m.setState({detposz:e.target.value})})),a)))),r.a.createElement("br",null),r.a.createElement("hr",null),r.a.createElement(H.a,null,"Rotation"),r.a.createElement(J.a.Control,{as:"select",style:{width:"100px","margin-left":"-15px","margin-bottom":"10px"},value:this.state.rotme,onChange:function(e){m.setState({rotme:e.target.value})}},r.a.createElement("option",{value:"0.0174"},"deg"),r.a.createElement("option",{value:"1"},"rad")),r.a.createElement(H.a,null,"x",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(n={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(n,"value",this.state.detrotx),Object(s.a)(n,"onChange",(function(e){m.setState({detrotx:e.target.value})})),n))),"y",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(o={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(o,"value",this.state.detroty),Object(s.a)(o,"onChange",(function(e){m.setState({detroty:e.target.value})})),o))),"z",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(i={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(i,"value",this.state.detrotz),Object(s.a)(i,"onChange",(function(e){m.setState({detrotz:e.target.value})})),i)))),r.a.createElement("br",null),r.a.createElement("hr",null),r.a.createElement(H.a,null,"Scale"),r.a.createElement(J.a.Control,{as:"select",style:{width:"100px","margin-left":"-15px","margin-bottom":"10px"},value:this.state.scaleme,onChange:function(e){m.setState({scaleme:e.target.value})}},r.a.createElement("option",{value:".1"},"mm"),r.a.createElement("option",{value:"1"},"cm"),r.a.createElement("option",{value:"10"},"dm"),r.a.createElement("option",{value:"100"},"m")),r.a.createElement(H.a,null,"x",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(l={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(l,"value",this.state.detscalex),Object(s.a)(l,"onChange",(function(e){m.setState({detscalex:e.target.value})})),l))),"y",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(c={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(c,"value",this.state.detscaley),Object(s.a)(c,"onChange",(function(e){m.setState({detscaley:e.target.value})})),c))),"z",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(u={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(u,"value",this.state.detscalez),Object(s.a)(u,"onChange",(function(e){m.setState({detscalez:e.target.value})})),u)))),r.a.createElement("br",null),r.a.createElement("hr",null),r.a.createElement(H.a,null,r.a.createElement(J.a.Group,{controlId:"exampleForm.SelectCustom"},r.a.createElement(J.a.Label,null,"Material"),h,r.a.createElement(W.a,{onClick:function(){m.table.current.showDialog()}},"Choose"))),r.a.createElement("hr",null),r.a.createElement(H.a,null,"Color: ",r.a.createElement("span",{style:{"padding-left":"20px"}},r.a.createElement("input",{type:"color",onInput:function(e){m.setState({color:m.hexToRgb(e.target.value)})}})))))),r.a.createElement(Q.a.Footer,null,r.a.createElement(W.a,{variant:"secondary",onClick:function(){m.hideDialog()}},"Cancel"),r.a.createElement(W.a,{variant:"primary",onClick:function(){m.hideDialog(),m.props.createbutton(m.state.detname,m.state.detposx,m.state.detposy,m.state.detposz,m.state.detrotx,m.state.detroty,m.state.detrotz,m.state.detscalex,m.state.detscaley,m.state.detscalez,m.state.detmat,m.state.geomrty,m.state.modeldata,m.state.color,!1,m.state.posme,m.state.rotme,m.state.scaleme)}},"Create"))))}}]),a}(n.Component);fe.id=0;var be=fe,ye=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).showDialog=n.showDialog.bind(Object(d.a)(n)),n.hideDialog=n.hideDialog.bind(Object(d.a)(n)),n.confirmDialog=r.a.createRef(),n.state={show:!1,detname:n.props.detector.name,detposx:n.props.detector.model.position.x/n.props.detector.units[0],detposy:n.props.detector.model.position.y/n.props.detector.units[0],detposz:n.props.detector.model.position.z/n.props.detector.units[0],detdirx:n.props.detector.direction.x,detdiry:n.props.detector.direction.y,detdirz:n.props.detector.direction.z,posu:n.props.detector.units[0],energyu:n.props.detector.units[1],energy:n.props.detector.energy/n.props.detector.units[1]},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){}},{key:"showDialog",value:function(){this.setState({show:!0})}},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e,t,a,n,o,i,l,c=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ee,{ref:this.confirmDialog,title:"Confirm",content:"Are you sure you want to delete this component?",fun:function(){c.hideDialog(),c.props.removebutton(c.props.detector,c.props.button.id)}}),r.a.createElement(Q.a,{show:this.state.show,onHide:function(){c.hideDialog()}},r.a.createElement(Q.a.Header,{closeButton:!0},r.a.createElement(Q.a.Title,null,"Modify Gun")),r.a.createElement(Q.a.Body,null,r.a.createElement(J.a,null,r.a.createElement(_.a,null,r.a.createElement(H.a,null,"Name ",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,{className:"name",required:!0,type:"text",maxLength:"10",value:this.state.detname,onChange:function(e){c.setState({detname:e.target.value})}}))),r.a.createElement(H.a,null,"Position"),r.a.createElement(J.a.Control,{as:"select",style:{width:"100px","margin-left":"-15px","margin-bottom":"10px"},value:this.state.posu,onChange:function(e){c.setState({posu:e.target.value})}},r.a.createElement("option",{value:".1"},"mm"),r.a.createElement("option",{value:"1"},"cm"),r.a.createElement("option",{value:"10"},"dm"),r.a.createElement("option",{value:"100"},"m")),r.a.createElement(H.a,null,"x",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(e={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(e,"value",this.state.detposx),Object(s.a)(e,"onChange",(function(e){c.setState({detposx:e.target.value})})),e))),"y",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(t={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(t,"value",this.state.detposy),Object(s.a)(t,"onChange",(function(e){c.setState({detposy:e.target.value})})),t))),"z",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(a={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(a,"value",this.state.detposz),Object(s.a)(a,"onChange",(function(e){c.setState({detposz:e.target.value})})),a)))),r.a.createElement("br",null),r.a.createElement(H.a,null,"Direction"),r.a.createElement(H.a,null,"x",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(n={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(n,"value",this.state.detdirx),Object(s.a)(n,"onChange",(function(e){c.setState({detdirx:e.target.value})})),n))),"y",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(o={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(o,"value",this.state.detdiry),Object(s.a)(o,"onChange",(function(e){c.setState({detdiry:e.target.value})})),o))),"z",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(i={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(i,"value",this.state.detdirz),Object(s.a)(i,"onChange",(function(e){c.setState({detdirz:e.target.value})})),i)))),r.a.createElement("br",null),r.a.createElement(H.a,null,"Energy ",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(l={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(l,"value",this.state.energy),Object(s.a)(l,"onChange",(function(e){c.setState({energy:e.target.value})})),l))),r.a.createElement(J.a.Control,{as:"select",style:{width:"100px","margin-left":"-15px","margin-bottom":"10px"},value:this.state.energyu,onChange:function(e){c.setState({energyu:e.target.value})}},r.a.createElement("option",{value:"1"},"eV"),r.a.createElement("option",{value:"1000"},"keV"),r.a.createElement("option",{value:"1000000"},"MeV"),r.a.createElement("option",{value:"1000000000"},"GeV")))))),r.a.createElement(Q.a.Footer,null,r.a.createElement(W.a,{variant:"secondary",onClick:function(){c.confirmDialog.current.showDialog()},style:{backgroundColor:"red",color:"white"}},"Delete"),r.a.createElement(W.a,{variant:"primary",onClick:function(){c.hideDialog(),c.props.detector.name=c.state.name,c.props.detector.model.position.x=c.state.detposx*c.state.posu,c.props.detector.model.position.y=c.state.detposy*c.state.posu,c.props.detector.model.position.z=c.state.detposz*c.state.posu,c.props.detector.direction.x=c.state.detdirx,c.props.detector.direction.y=c.state.detdiry,c.props.detector.direction.z=c.state.detdirz,c.props.detector.energy=c.state.energy*c.state.energyu;for(var e="",t=0;t<re.chunks.length;t++)c.props.buttonid==re.chunks[t].id&&(re.chunks[t].code='\\Gun{\n\tname: "'+c.props.name+'";\n\tposition['+se.convertLength(c.state.posu)+"]: "+c.state.detposx+", "+c.state.detposy+", "+c.state.detposz+";\n\tdirection: "+c.state.detdirx+", "+c.state.detdiry+", "+c.state.detdirz+";\n\tenergy["+se.convertEnergy(c.state.energyu)+"]: "+c.state.energy+";\n}\n"),e+=re.chunks[t].code;c.props.codeeditor.current.updateText(e),c.props.updatedetails(r.a.createElement(_.a,null,r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"Position: ")),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"x: ",c.state.detposx," ",se.convertLength(c.state.posu)),r.a.createElement(Y.a,null,"y: ",c.state.detposy," ",se.convertLength(c.state.posu)),r.a.createElement(Y.a,null,"z: ",c.state.detposz," ",se.convertLength(c.state.posu))),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"Direction: ")),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"x: ",c.state.detdirx," "),r.a.createElement(Y.a,null,"y: ",c.state.detdiry," "),r.a.createElement(Y.a,null,"z: ",c.state.detdirz," ")),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"Energy: ",c.state.energy," ",se.convertEnergy(c.state.energyu)))))}},"Modify"))))}}]),a}(n.Component);ye.id=0;var Ee=ye,xe=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).editdialog=r.a.createRef(),n.updateDetails=n.updateDetails.bind(Object(d.a)(n)),n.state={details:n.props.details},n.id=n.props.id,n}return Object(h.a)(a,[{key:"updateDetails",value:function(e){this.setState({details:e})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(Ee,{buttonid:this.id,codeeditor:this.props.codeeditor,name:this.props.name,updatedetails:this.updateDetails,button:this,removebutton:this.props.removebutton,detector:this.props.detector,ref:this.editdialog,buttons:this.props.buttons,details:this.props.details}),r.a.createElement(K.a,{className:"button"},r.a.createElement(K.a.Header,null,r.a.createElement(q.a.Toggle,{as:W.a,onClick:function(){L.acitve_id!=e.id?L.acitve_id=e.id:L.acitve_id=-1},variant:"link",eventKey:this.id},this.props.name),r.a.createElement(W.a,{onClick:function(){e.editdialog.current.showDialog()},className:"editButton"},"EDIT")),r.a.createElement(q.a.Collapse,{eventKey:this.id},r.a.createElement(K.a.Body,null,this.state.details))))}}]),a}(n.Component);xe.id=0;var we=xe,Oe=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).showDialog=n.showDialog.bind(Object(d.a)(n)),n.hideDialog=n.hideDialog.bind(Object(d.a)(n)),n.state={show:!1,detname:"Gun",detposx:0,detposy:0,detposz:0,detdirx:1,detdiry:0,detdirz:0,posu:1,energyu:1e3,energy:100},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){}},{key:"showDialog",value:function(){this.setState({show:!0})}},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e,t,a,n,o,i,l,c=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Q.a,{show:this.state.show,onHide:function(){c.hideDialog()}},r.a.createElement(Q.a.Header,{closeButton:!0},r.a.createElement(Q.a.Title,null,"Create Particle Gun")),r.a.createElement(Q.a.Body,null,r.a.createElement(J.a,null,r.a.createElement(_.a,null,r.a.createElement(H.a,null,"Name ",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,{className:"name",required:!0,type:"text",maxLength:"10",value:this.state.detname,onChange:function(e){c.setState({detname:e.target.value})}}))),r.a.createElement(H.a,null,"Position"),r.a.createElement(J.a.Control,{as:"select",style:{width:"100px","margin-left":"-15px","margin-bottom":"10px"},value:this.state.posu,onChange:function(e){c.setState({posu:e.target.value})}},r.a.createElement("option",{value:".1"},"mm"),r.a.createElement("option",{value:"1"},"cm"),r.a.createElement("option",{value:"10"},"dm"),r.a.createElement("option",{value:"100"},"m")),r.a.createElement(H.a,null,"x",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(e={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(e,"value",this.state.detposx),Object(s.a)(e,"onChange",(function(e){c.setState({detposx:e.target.value})})),e))),"y",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(t={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(t,"value",this.state.detposy),Object(s.a)(t,"onChange",(function(e){c.setState({detposy:e.target.value})})),t))),"z",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(a={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(a,"value",this.state.detposz),Object(s.a)(a,"onChange",(function(e){c.setState({detposz:e.target.value})})),a)))),r.a.createElement("br",null),r.a.createElement(H.a,null,"Direction"),r.a.createElement(H.a,null,"x",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(n={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(n,"value",this.state.detdirx),Object(s.a)(n,"onChange",(function(e){c.setState({detdirx:e.target.value})})),n))),"y",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(o={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(o,"value",this.state.detdiry),Object(s.a)(o,"onChange",(function(e){c.setState({detdiry:e.target.value})})),o))),"z",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(i={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(i,"value",this.state.detdirz),Object(s.a)(i,"onChange",(function(e){c.setState({detdirz:e.target.value})})),i)))),r.a.createElement("br",null),r.a.createElement(H.a,null,"Energy ",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(l={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(l,"value",this.state.energy),Object(s.a)(l,"onChange",(function(e){c.setState({energy:e.target.value})})),l))),r.a.createElement(J.a.Control,{as:"select",style:{width:"100px","margin-left":"-15px","margin-bottom":"10px"},value:this.state.energyu,onChange:function(e){c.setState({energyu:e.target.value})}},r.a.createElement("option",{value:"1"},"eV"),r.a.createElement("option",{value:"1000"},"keV"),r.a.createElement("option",{value:"1000000"},"MeV"),r.a.createElement("option",{value:"1000000000"},"GeV")))))),r.a.createElement(Q.a.Footer,null,r.a.createElement(W.a,{variant:"secondary",onClick:function(){c.hideDialog()}},"Cancel"),r.a.createElement(W.a,{variant:"primary",onClick:function(){c.hideDialog(),c.props.createbutton(c.state.detname,c.state.detposx,c.state.detposy,c.state.detposz,c.state.detdirx,c.state.detdiry,c.state.detdirz,c.state.energy,!1,c.state.posu,c.state.energyu)}},"Create"))))}}]),a}(n.Component);Oe.id=0;var Ae=Oe,Se=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).showDialog=n.showDialog.bind(Object(d.a)(n)),n.hideDialog=n.hideDialog.bind(Object(d.a)(n)),n.state={show:!1,materials:[]},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){this.updateMaterials("",this.state.table)}},{key:"showDialog",value:function(){this.setState({show:!0})}},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"updateMaterials",value:function(e,t){for(var a=this,n=$.sources.filter((function(t){return t.toUpperCase().includes(e.toUpperCase())})),o=[],i=Math.ceil(n.length/5),s=0;s<i;s++){for(var l=[],c=function(e){if(void 0===n[e])return"break";l.push(r.a.createElement("th",{className:"tablebutton",onClick:function(t){a.props.updatematerial(n[e]),a.hideDialog()}},r.a.createElement("h1",{style:{"font-size":"15px","font-weight":"bold"}},n[e])))},u=Math.floor(s/i*n.length);u<Math.floor(s/i*n.length)+5;u++){if("break"===c(u))break}o.push(r.a.createElement("tr",null,l))}this.setState({materials:o})}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Q.a,{show:this.state.show,onHide:function(){e.hideDialog()}},r.a.createElement(Q.a.Header,{closeButton:!0},r.a.createElement(Q.a.Title,null,"Choose a material")),r.a.createElement(Q.a.Body,null,r.a.createElement(oe.a,{type:"text",onChange:function(t){e.updateMaterials(t.target.value,e.state.table)},placeholder:"Search",style:{margin:"20px",width:"200px"}}),r.a.createElement(H.a,{style:{margin:"auto"}}),r.a.createElement(_.a,{style:{margin:"auto"}},this.state.materials)),r.a.createElement(Q.a.Footer,null)))}}]),a}(n.Component),Ce=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).showDialog=n.showDialog.bind(Object(d.a)(n)),n.hideDialog=n.hideDialog.bind(Object(d.a)(n)),n.updateMaterial=n.updateMaterial.bind(Object(d.a)(n)),n.confirmDialog=r.a.createRef(),n.table=r.a.createRef(),n.state={show:!1,detname:n.props.detector.name,detposx:n.props.detector.model.position.x/n.props.detector.units[0],detposy:n.props.detector.model.position.y/n.props.detector.units[0],detposz:n.props.detector.model.position.z/n.props.detector.units[0],posu:n.props.detector.units[0],material:n.props.detector.material},n}return Object(h.a)(a,[{key:"updateMaterial",value:function(e){this.setState({material:e})}},{key:"componentDidMount",value:function(){}},{key:"showDialog",value:function(){this.setState({show:!0})}},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e,t,a,n=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Se,{ref:this.table,updatematerial:this.updateMaterial}),r.a.createElement(ee,{ref:this.confirmDialog,title:"Confirm",content:"Are you sure you want to delete this component?",fun:function(){n.hideDialog(),n.props.removebutton(n.props.detector,n.props.button.id)}}),r.a.createElement(Q.a,{show:this.state.show,onHide:function(){n.hideDialog()}},r.a.createElement(Q.a.Header,{closeButton:!0},r.a.createElement(Q.a.Title,null,"Modify Source")),r.a.createElement(Q.a.Body,null,r.a.createElement(J.a,null,r.a.createElement(_.a,null,r.a.createElement(H.a,null,"Name ",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,{className:"name",required:!0,type:"text",maxLength:"10",value:this.state.detname,onChange:function(e){n.setState({detname:e.target.value})}}))),r.a.createElement("hr",null),r.a.createElement(H.a,null,"Position"),r.a.createElement(J.a.Control,{as:"select",style:{width:"100px","margin-left":"-15px","margin-bottom":"10px"},value:this.state.posu,onChange:function(e){n.setState({posu:e.target.value})}},r.a.createElement("option",{value:".1"},"mm"),r.a.createElement("option",{value:"1"},"cm"),r.a.createElement("option",{value:"10"},"dm"),r.a.createElement("option",{value:"100"},"m")),r.a.createElement(H.a,null,"x",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(e={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(e,"value",this.state.detposx),Object(s.a)(e,"onChange",(function(e){n.setState({detposx:e.target.value})})),e))),"y",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(t={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(t,"value",this.state.detposy),Object(s.a)(t,"onChange",(function(e){n.setState({detposy:e.target.value})})),t))),"z",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(a={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(a,"value",this.state.detposz),Object(s.a)(a,"onChange",(function(e){n.setState({detposz:e.target.value})})),a)))),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("hr",null),r.a.createElement(J.a.Group,null,"Material",r.a.createElement("th",{className:"tablebutton",onClick:function(e){n.table.current.showDialog()}},r.a.createElement("h1",{style:{"font-size":"15px","font-weight":"bold","vertical-align":"middle"}},this.state.material)))))),r.a.createElement(Q.a.Footer,null,r.a.createElement(W.a,{variant:"secondary",onClick:function(){n.confirmDialog.current.showDialog()},style:{backgroundColor:"red",color:"white"}},"Delete"),r.a.createElement(W.a,{variant:"primary",onClick:function(){n.hideDialog(),n.props.detector.name=n.state.name,n.props.detector.model.position.x=n.state.detposx*n.state.posu,n.props.detector.model.position.y=n.state.detposy*n.state.posu,n.props.detector.model.position.z=n.state.detposz*n.state.posu,n.props.detector.material=n.state.material;for(var e="",t=0;t<re.chunks.length;t++)n.props.buttonid==re.chunks[t].id&&(re.chunks[t].code='\\Source{\n\tname: "'+n.props.name+'";\n\tposition['+se.convertLength(n.state.posu)+"]: "+n.state.detposx+", "+n.state.detposy+", "+n.state.detposz+';\n\tmaterial: "'+n.state.material+'";\n}\n'),e+=re.chunks[t].code;n.props.codeeditor.current.updateText(e),n.props.updatedetails(r.a.createElement(_.a,null,r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"Position: ")),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"x: ",n.state.detposx," ",se.convertLength(n.state.posu)),r.a.createElement(Y.a,null,"y: ",n.state.detposy," ",se.convertLength(n.state.posu)),r.a.createElement(Y.a,null,"z: ",n.state.detposz," ",se.convertLength(n.state.posu))),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"Material: ",n.state.material))))}},"Modify"))))}}]),a}(n.Component);Ce.id=0;var ke=Ce,De=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).editdialog=r.a.createRef(),n.updateDetails=n.updateDetails.bind(Object(d.a)(n)),n.state={details:n.props.details},n.id=n.props.id,n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){}},{key:"updateDetails",value:function(e){this.setState({details:e})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(ke,{codeeditor:this.props.codeeditor,name:this.props.name,buttonid:this.id,updatedetails:this.updateDetails,button:this,removebutton:this.props.removebutton,detector:this.props.detector,ref:this.editdialog,buttons:this.props.buttons,details:this.props.details}),r.a.createElement(K.a,{className:"button"},r.a.createElement(K.a.Header,null,r.a.createElement(q.a.Toggle,{as:W.a,onClick:function(){L.acitve_id!=e.id?L.acitve_id=e.id:L.acitve_id=-1},variant:"link",eventKey:this.id},this.props.name),r.a.createElement(W.a,{onClick:function(){e.editdialog.current.showDialog()},className:"editButton"},"EDIT")),r.a.createElement(q.a.Collapse,{eventKey:this.id},r.a.createElement(K.a.Body,null,this.state.details))))}}]),a}(n.Component);De.id=0;var ze=De,Re=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).showDialog=n.showDialog.bind(Object(d.a)(n)),n.hideDialog=n.hideDialog.bind(Object(d.a)(n)),n.updateMaterial=n.updateMaterial.bind(Object(d.a)(n)),n.table=r.a.createRef(),n.state={show:!1,detname:"Detector",detposx:0,detposy:0,detposz:0,posu:1,material:"Co60"},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){}},{key:"updateMaterial",value:function(e){this.setState({material:e})}},{key:"showDialog",value:function(){this.setState({show:!0});var e="Source"+this.props.buttons.length;this.setState({detname:e})}},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e,t,a,n=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Se,{ref:this.table,updatematerial:this.updateMaterial}),r.a.createElement(Q.a,{show:this.state.show,onHide:function(){n.hideDialog()}},r.a.createElement(Q.a.Header,{closeButton:!0},r.a.createElement(Q.a.Title,null,"Create Particle Source")),r.a.createElement(Q.a.Body,null,r.a.createElement(J.a,null,r.a.createElement(_.a,null,r.a.createElement(H.a,null,"Name ",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,{className:"name",required:!0,type:"text",maxLength:"10",value:this.state.detname,onChange:function(e){n.setState({detname:e.target.value})}}))),r.a.createElement("hr",null),r.a.createElement(H.a,null,"Position"),r.a.createElement(J.a.Control,{as:"select",style:{width:"100px","margin-left":"-15px","margin-bottom":"10px"},value:this.state.posu,onChange:function(e){n.setState({posu:e.target.value})}},r.a.createElement("option",{value:".1"},"mm"),r.a.createElement("option",{value:"1"},"cm"),r.a.createElement("option",{value:"10"},"dm"),r.a.createElement("option",{value:"100"},"m")),r.a.createElement(H.a,null,"x",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(e={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(e,"value",this.state.detposx),Object(s.a)(e,"onChange",(function(e){n.setState({detposx:e.target.value})})),e))),"y",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(t={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(t,"value",this.state.detposy),Object(s.a)(t,"onChange",(function(e){n.setState({detposy:e.target.value})})),t))),"z",r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,(a={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(a,"value",this.state.detposz),Object(s.a)(a,"onChange",(function(e){n.setState({detposz:e.target.value})})),a)))),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("hr",null),r.a.createElement(J.a.Group,null,"Material",r.a.createElement("th",{className:"tablebutton",onClick:function(e){n.table.current.showDialog()}},r.a.createElement("h1",{style:{"font-size":"15px","font-weight":"bold","vertical-align":"middle"}},this.state.material)))))),r.a.createElement(Q.a.Footer,null,r.a.createElement(W.a,{variant:"secondary",onClick:function(){n.hideDialog()}},"Cancel"),r.a.createElement(W.a,{variant:"primary",onClick:function(){n.hideDialog(),n.props.createbutton(n.state.detname,n.state.detposx,n.state.detposy,n.state.detposz,n.state.material,!1,n.state.posu)}},"Create"))))}}]),a}(n.Component);Re.id=0;var Le=Re,je=a(512),Te=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).state={numberOfParticles:100,show:!1,loading:!1},n.hideDialog=n.hideDialog.bind(Object(d.a)(n)),n.showDialog=n.showDialog.bind(Object(d.a)(n)),n.setLoading=n.setLoading.bind(Object(d.a)(n)),n}return Object(h.a)(a,[{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"showDialog",value:function(){this.setState({show:!0,loading:!1})}},{key:"setLoading",value:function(e){this.setState({loading:e})}},{key:"render",value:function(){var e=this;return this.state.loading?r.a.createElement(r.a.Fragment,null,r.a.createElement(Q.a,{show:this.state.show,onHide:function(){e.hideDialog()}},r.a.createElement(Q.a.Header,{closeButton:!0},r.a.createElement(Q.a.Title,null,"Run simulation")),r.a.createElement(Q.a.Body,null,r.a.createElement(H.a,{style:{margin:"5px"}},"Runnig simulation"),r.a.createElement(je.a,{animation:"border",role:"status"})),r.a.createElement(Q.a.Footer,null,r.a.createElement(W.a,{variant:"secondary",onClick:function(){e.hideDialog()}},"Cancel"),r.a.createElement(W.a,{variant:"primary",onClick:function(){e.props.runsim(e.state.numberOfParticles)}},"Run")))):r.a.createElement(r.a.Fragment,null,r.a.createElement(Q.a,{show:this.state.show,onHide:function(){e.hideDialog()}},r.a.createElement(Q.a.Header,{closeButton:!0},r.a.createElement(Q.a.Title,null,"Run simulation")),r.a.createElement(Q.a.Body,null,r.a.createElement(H.a,{style:{margin:"5px"}},"Number of particles:"),r.a.createElement(J.a,{onSubmit:function(e){e.preventDefault()}},r.a.createElement(J.a.Control,{required:!0,type:"number",value:this.state.numberOfParticles,onChange:function(t){e.setState({numberOfParticles:t.target.value})}}))),r.a.createElement(Q.a.Footer,null,r.a.createElement(W.a,{variant:"secondary",onClick:function(){e.hideDialog()}},"Cancel"),r.a.createElement(W.a,{variant:"primary",onClick:function(){e.setLoading(!0),e.props.runsim(e.state.numberOfParticles,e.hideDialog)}},"Run"))))}}]),a}(n.Component),Me=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).state={numberofparticles:1e3,detector:0,show:!1,loading:!1,now:60,binsize:10},n.hideDialog=n.hideDialog.bind(Object(d.a)(n)),n.showDialog=n.showDialog.bind(Object(d.a)(n)),n.setLoading=n.setLoading.bind(Object(d.a)(n)),n}return Object(h.a)(a,[{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"setLoading",value:function(e){this.setState({loading:e})}},{key:"showDialog",value:function(){this.setState({show:!0,loading:!1})}},{key:"render",value:function(){var e,t,a=this;if(this.state.loading)return r.a.createElement(Q.a,{show:this.state.show},r.a.createElement(Q.a.Header,{closeButton:!0},r.a.createElement(Q.a.Title,null,"Configure Spectroscopy")),r.a.createElement(Q.a.Body,null,r.a.createElement(H.a,{style:{margin:"5px"}},"Runnig simulation"),r.a.createElement(je.a,{animation:"border",role:"status"})),r.a.createElement(Q.a.Footer,null,r.a.createElement(W.a,{variant:"secondary",onClick:function(){a.hideDialog()}},"Cancel")));for(var n=[],o=0;o<this.props.detectors.length;o++)n.push(r.a.createElement("option",{value:this.props.detectors[o].id},this.props.detectors[o].name));return r.a.createElement(r.a.Fragment,null,r.a.createElement(Q.a,{show:this.state.show,onHide:function(){a.hideDialog()}},r.a.createElement(Q.a.Header,{closeButton:!0},r.a.createElement(Q.a.Title,null,"Configure Spectroscopy")),r.a.createElement(Q.a.Body,null,r.a.createElement(H.a,{style:{margin:"5px"}},"Select detector"),r.a.createElement(J.a,null,r.a.createElement(J.a.Control,{as:"select",value:this.state.detector,onChange:function(e){a.setState({detector:e.target.value})}},n),r.a.createElement("hr",null),r.a.createElement(H.a,{style:{margin:"5px"}},"Number of particles"),r.a.createElement(J.a.Control,(e={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(e,"value",this.state.numberofparticles),Object(s.a)(e,"onChange",(function(e){a.setState({numberofparticles:e.target.value})})),e)),r.a.createElement("hr",null),r.a.createElement(H.a,{style:{margin:"5px"}},"Bin size"),r.a.createElement(H.a,null,r.a.createElement(J.a.Control,(t={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(s.a)(t,"value",this.state.binsize),Object(s.a)(t,"style",{width:"20%",margin:"15px"}),Object(s.a)(t,"onChange",(function(e){a.setState({binsize:e.target.value})})),t)),r.a.createElement("span",{style:{padding:"20px"}},"keV")))),r.a.createElement(Q.a.Footer,null,r.a.createElement(W.a,{variant:"secondary",onClick:function(){a.hideDialog()}},"Cancel"),r.a.createElement(W.a,{variant:"primary",onClick:function(){a.setLoading(!0),a.props.runsim(a.state.numberofparticles,a.state.detector,a.hideDialog,a.state.binsize)}},"Run"))))}}]),a}(n.Component),Ie=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).showDialog=n.showDialog.bind(Object(d.a)(n)),n.hideDialog=n.hideDialog.bind(Object(d.a)(n)),n.state={show:!1,name:"model",filelabel:"",modeldata:[]},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){}},{key:"showDialog",value:function(e){this.setState({show:!0}),void 0!=e&&this.setState({name:e})}},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Q.a,{show:this.state.show,onHide:function(){e.hideDialog()}},r.a.createElement(Q.a.Header,{closeButton:!0},r.a.createElement(Q.a.Title,null,"Choose a geometry")),r.a.createElement(Q.a.Body,null,r.a.createElement(J.a,null,r.a.createElement(_.a,null,"Name",r.a.createElement(H.a,null,r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,{className:"name",required:!0,type:"text",maxLength:"10",value:this.state.name,onChange:function(t){e.setState({name:t.target.value})}}))),r.a.createElement("hr",null),"STL File",r.a.createElement(J.a.File,{id:"stl-file",label:this.state.filelabel,"data-browse":"Open",custom:!0,onChange:function(t){var a=new FileReader;a.onload=function(){var t=a.result;e.setState({modeldata:t})},a.readAsBinaryString(t.target.files[0]);var n=t.target.value;n=n.split("\\")[n.split("\\").length-1],e.setState({filelabel:n})}})))),r.a.createElement(Q.a.Footer,null,r.a.createElement(W.a,{variant:"secondary",onClick:function(){e.hideDialog()}},"Cancel"),r.a.createElement(W.a,{variant:"primary",onClick:function(){0!=e.state.modeldata.length?(e.hideDialog(),e.props.createbutton(e.state.name,e.state.modeldata,e.state.filelabel)):alert("Select an stl file!")}},"Create"))))}}]),a}(n.Component);Ie.id=0;var Ne=Ie,Pe=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).dialog=r.a.createRef(),n.gundialog=r.a.createRef(),n.sourcedialog=r.a.createRef(),n.rundialog=r.a.createRef(),n.spectrumdialog=r.a.createRef(),n.confirmDialog=r.a.createRef(),n.volumedialog=r.a.createRef(),n.showRun=n.showRun.bind(Object(d.a)(n)),n.state={showTracks:!0,showParticles:!0,showAxes:!0,showGrid:!1,showrun:"none",showclearsetup:"none",showclearparticles:"none"},n}return Object(h.a)(a,[{key:"showRun",value:function(e){e?this.setState({showrun:"block"}):this.setState({showrun:"none"})}},{key:"showClearParticles",value:function(e){e?this.setState({showclearparticles:"block"}):this.setState({showclearparticles:"none"})}},{key:"showClearSetup",value:function(e){e?this.setState({showclearsetup:"block"}):this.setState({showclearsetup:"none"})}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ee,{ref:this.confirmDialog,title:"Confirm",content:"Are you sure you want to delete all components?",fun:function(){e.props.clearSetup(),e.showClearSetup(!1)}}),r.a.createElement(be,{ref:this.dialog,createbutton:this.props.createbutton,buttons:this.props.buttons}),r.a.createElement(Ae,{ref:this.gundialog,createbutton:this.props.creategunbutton,buttons:this.props.buttons}),r.a.createElement(Le,{ref:this.sourcedialog,createbutton:this.props.createsourcebutton,buttons:this.props.buttons}),r.a.createElement(Te,{ref:this.rundialog,runsim:this.props.run}),r.a.createElement(Me,{ref:this.spectrumdialog,runsim:this.props.runspectroscopy,detectors:this.props.detectors}),r.a.createElement(Ne,{ref:this.volumedialog,createbutton:this.props.createvolume}),r.a.createElement(de.a,{bg:"light",variant:"light",style:{position:"fixed","z-index":"4"}},r.a.createElement(de.a.Brand,null,"Geant4"),r.a.createElement(W.a,{style:{display:this.state.showrun},variant:"primary",onClick:function(){e.rundialog.current.showDialog()}},"Run"),r.a.createElement(W.a,{variant:"primary",style:{backgroundColor:"green",display:this.state.showrun},onClick:function(){e.spectrumdialog.current.showDialog()}},"Spectroscopy"),r.a.createElement(W.a,{variant:"primary",style:{display:this.state.showclearparticles,backgroundColor:"red"},onClick:function(){e.props.clearrun(),e.showClearParticles(!1)}},"Clear particles"),r.a.createElement(W.a,{variant:"primary",style:{display:this.state.showclearsetup,backgroundColor:"red"},onClick:function(){e.confirmDialog.current.showDialog()}},"Clear setup"),r.a.createElement(W.a,{variant:"primary",style:{backgroundColor:"gray"},onClick:function(){le.log(1,"asd")}},"Send log"),r.a.createElement(X.a,{className:"mr-auto"},r.a.createElement(pe.a,null,r.a.createElement(pe.a.Toggle,{variant:"success",id:"dropdown-basic",style:{backgroundColor:"white",border:"none",color:"black"}},"Add"),r.a.createElement(pe.a.Menu,null,r.a.createElement(ge.a,{overlay:r.a.createElement(ve.a,{id:"tooltip-disabled"},"Particle Detector")},r.a.createElement("span",{className:"d-inline-block"},r.a.createElement(pe.a.Item,{className:"detectoroption",onClick:function(){e.dialog.current.showDialog(e.props.volumes)}},"Detector"))),r.a.createElement("br",null),r.a.createElement(ge.a,{overlay:r.a.createElement(ve.a,{id:"tooltip-disabled"},"General Particle Source")},r.a.createElement("span",{className:"d-inline-block"},r.a.createElement(pe.a.Item,{className:"detectoroption",onClick:function(){e.sourcedialog.current.showDialog()}},"GPS"))),r.a.createElement("br",null),r.a.createElement(ge.a,{overlay:r.a.createElement(ve.a,{id:"tooltip-disabled"},"Directed Particle Gun")},r.a.createElement("span",{className:"d-inline-block"},r.a.createElement(pe.a.Item,{className:"detectoroption",onClick:function(){e.gundialog.current.showDialog()}},"Gun"))),r.a.createElement(ge.a,{overlay:r.a.createElement(ve.a,{id:"tooltip-disabled"},"Detector volume")},r.a.createElement("span",{className:"d-inline-block"},r.a.createElement(pe.a.Item,{className:"detectoroption",onClick:function(){e.volumedialog.current.showDialog()}},"Volume"))))),r.a.createElement(pe.a,null,r.a.createElement(pe.a.Toggle,{variant:"success",id:"dropdown-basic",style:{backgroundColor:"white",border:"none",color:"black"}},"View"),r.a.createElement(pe.a.Menu,null,r.a.createElement(J.a.Check,{type:"checkbox",label:"Show Tracks",checked:this.state.showTracks,onChange:function(t){e.setState({showTracks:t.target.checked}),e.props.setshowtracks(e.state.showTracks)},style:{margin:"12px"}}),r.a.createElement(J.a.Check,{type:"checkbox",label:"Show Particles",checked:this.state.showParticles,onChange:function(t){e.setState({showParticles:t.target.checked}),e.props.setshowparticles(e.state.showParticles)},style:{margin:"12px"}}),r.a.createElement(J.a.Check,{type:"checkbox",label:"Show Axes",checked:this.state.showAxes,onChange:function(t){e.setState({showAxes:t.target.checked}),e.props.setshowaxes(e.state.showAxes)},style:{margin:"12px"}}),r.a.createElement(J.a.Check,{type:"checkbox",label:"Show Grid",checked:this.state.showGrid,onChange:function(t){e.setState({showGrid:t.target.checked}),e.state.showGrid&&e.props.canvas.current.updateHint(" "),e.props.setshowgrid(e.state.showGrid)},style:{margin:"12px"}}))))))}}]),a}(n.Component);Pe.id=0;var Ue=Pe,Be=function e(){Object(m.a)(this,e),this.track_id=0,this.parent_id=0,this.position=new y(0,0,0),this.color=new y(1,1,1),this.totalEnergy=0,this.energyDeposit=0,this.definition="",this.id=""},Fe=a(107),Ve=a.n(Fe),_e=(a(486),function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).canvas=r.a.createRef(),n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){this.chart=new Ve.a(this.canvas.current.getContext("2d"),{type:"bar",data:{labels:[],datasets:[{label:"counts",backgroundColor:"rgb(0, 99, 132)",borderColor:"rgb(0, 99, 132)",data:[]}]},options:{responsive:!0,plugins:{zoom:{pan:{enabled:!0,mode:"xy"},zoom:{enabled:!0,mode:"xy"}}}}})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("canvas",{ref:this.canvas}))}},{key:"add",value:function(e){isNaN(e)||(this.contains(e)?this.numberofenergies[this.getIndex(e)]++:(this.energies.push(e),this.numberofenergies.push(1)))}},{key:"contains",value:function(e){for(var t=0;t<this.energies.length;t++)if(this.energies[t]==e)return!0;return!1}},{key:"getIndex",value:function(e){for(var t=0;t<this.energies.length;t++)if(0==Math.abs(this.energies[t]-e))return t;return-1}},{key:"maximum",value:function(e,t){if(0==e.length)return 0;for(var a=e[0],n=0;n<e.length;n++)e[n]>a&&(a=e[n]);return a}},{key:"sort",value:function(e){var t=[],a=this.maximum(this.energies);alert(e);for(var n=0;n<a+2*e;n+=parseInt(e))this.add(n);for(var r=0;r<this.energies.length;r++)t.push({hit:this.energies[r],no:this.numberofenergies[r]});t.sort((function(e,t){return e.hit<t.hit?-1:e.hit==t.hit?0:1}));for(var o=0;o<t.length;o++)this.energies[o]=t[o].hit,this.numberofenergies[o]=t[o].no;for(var i=0;i<this.energies.length;i++)this.addData(parseInt(this.energies[i]),this.numberofenergies[i]-1);this.chart.update()}},{key:"clear",value:function(e){this.energies=[],this.numberofenergies=[],this.chart.data.labels=[],this.chart.data.datasets=[],this.chart.destroy();var t=this.canvas.current.getContext("2d");this.chart=new Ve.a(t,{type:"bar",data:{labels:[],datasets:[{label:"counts",backgroundColor:"rgb(0, 99, 132)",borderColor:"rgb(0, 99, 132)",data:[]}]},options:{responsive:!0,scales:{yAxes:[{scaleLabel:{display:!0,fontSize:18,fontColor:"#000",labelString:"Number of hits"}}],xAxes:[{scaleLabel:{display:!0,fontSize:18,fontColor:"#000",labelString:"Energies (keV)"}}]},plugins:{zoom:{pan:{enabled:!0,mode:"x"},zoom:{enabled:!0,mode:"x"}}}}})}},{key:"addData",value:function(e,t){this.chart.data.labels.push(e),this.chart.data.datasets.forEach((function(e){e.data.push(t)}))}}],[{key:"save",value:function(){}}]),a}(n.Component)),He=a(200),Ye=a.n(He),Ge=(a(495),a(496),function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).fileinput=r.a.createRef(),n.updateText=n.updateText.bind(Object(d.a)(n)),n.state={text:"",width:"20%"},n.editor=r.a.createRef(),n.onclickfunction=function(){var e=n.state.text;re.parse(e,n.props.canvas.current,n.props.clearSetup,n.props.createDetector,n.props.createSource,n.props.createGun),n.setState({text:e}),le.log(2,"Ran script: "+n.state.text)},n}return Object(h.a)(a,[{key:"updateText",value:function(e){this.setState({text:e})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:{width:this.state.width,height:"100%",top:"50px",position:"fixed",right:"0","z-index":"3",border:"0",borderRadius:"0",padding:"0",margin:"0","background-color":"white"}},r.a.createElement(W.a,{style:Object(s.a)({border:"0",position:"relative","background-color":"gray","z-index":"3",bottom:"0","border-radius":"0"},"border","solid 1px white"),onClick:function(){e.setState({text:"Write your code here"})}},"New"),r.a.createElement("input",{ref:this.fileinput,type:"file",style:{display:"none"},onChange:function(t){var a=new FileReader;a.onload=function(){var t=a.result;e.updateText(t)},a.readAsBinaryString(t.target.files[0])}}),r.a.createElement(W.a,{style:Object(s.a)({border:"0",position:"relative","background-color":"gray","z-index":"3",bottom:"0","border-radius":"0"},"border","solid 1px white"),onClick:function(){e.fileinput.current.click()}},"Open"),r.a.createElement(W.a,{onClick:this.onclickfunction,style:Object(s.a)({border:"0",position:"relative","background-color":"gray","z-index":"3",bottom:"0","border-radius":"0"},"border","solid 1px white")},"Run script"),r.a.createElement(W.a,{style:Object(s.a)({border:"0",position:"relative","background-color":"gray","z-index":"3",bottom:"0","border-radius":"0"},"border","solid 1px white"),onClick:function(){window.location="Help"}},"Help"),r.a.createElement(Ye.a,{style:{"z-index":"2",width:"100%"},ref:this.editor,value:this.state.text,mode:"elixir",theme:"monokai",fontSize:16,onChange:function(t){e.setState({text:t})}}),r.a.createElement(W.a,{onClick:function(){"20%"==e.state.width?e.setState({width:"0"}):e.setState({width:"20%"})},style:{right:this.state.width,position:"fixed",top:"50%","z-index":"3",height:"50px","background-color":"gray",border:"0"}}),r.a.createElement("div",{style:{position:"fixed","z-index":"1","background-color":"black",height:"100%",top:"0",width:this.state.width}}))}}]),a}(n.Component)),Xe=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).showDialog=n.showDialog.bind(Object(d.a)(n)),n.hideDialog=n.hideDialog.bind(Object(d.a)(n)),n.updateCanvas=n.updateCanvas.bind(Object(d.a)(n)),n.state={show:!1},n.canvas=r.a.createRef(),n.camera=new E(45,-45,10,new y(0,0,0),new y(0,0,0)),n.oldX=0,n.oldY=0,n.move=!1,n.x=0,n.y=0,n.keyDown=" ".concat(0),n.down=!1,n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){}},{key:"updateCanvas",value:function(){var e=this;this.gl=this.canvas.current.getContext("webgl2"),this.renderer=new L(this.gl),this.renderer=new L(this.gl),this.renderer.drawAxes=!1;var t=new D(this.props.modeldata.vertices,this.props.modeldata.normals,this.gl);t.drawLines=!1,t.color=new y(.8,.8,.8),this.renderer.addDetector(new j(t)),this.renderer.models=[];requestAnimationFrame((function t(){if(0!=e.state.show){e.gl.clearColor(.1,1,.1,1),e.gl.clear(e.gl.COLOR_BUFFER_BIT);var a,n=x.createProjectionMatrix(70,.1*e.camera.d,1e3*e.camera.d,e.canvas.current.offsetWidth,e.canvas.current.offsetHeight);e.down&&e.move&&(17===e.keyDown?(e.camera.a.y-=.01*e.getMouseYd()*e.camera.d*((89-Math.abs(e.camera.y))/89)*.01,e.camera.a.x-=Math.cos(e.camera.x/(180/Math.PI))*e.getMouseXd()*.01*e.camera.d*((89-Math.abs(e.camera.y))/89)*.01,e.camera.a.z+=Math.sin(e.camera.x/(180/Math.PI))*e.getMouseXd()*.01*e.camera.d*((89-Math.abs(e.camera.y))/89)*.01,e.camera.a.x-=.01*(Math.cos(e.camera.x/(180/Math.PI))*e.getMouseXd()*.01*e.camera.d+Math.sin(e.camera.x/(180/Math.PI))*e.getMouseYd()*.01*e.camera.d),e.camera.a.z-=.01*(Math.cos(e.camera.x/(180/Math.PI))*e.getMouseYd()*.01*e.camera.d+Math.sin(e.camera.x/(180/Math.PI))*-e.getMouseXd()*.01*e.camera.d)):(e.camera.x+=e.getMouseXd()/2,e.camera.y+=e.getMouseYd()/2)),(a=e.camera).y>89&&(a.y=89),a.y<-89&&(a.y=-89),a.p.x=a.d*-Math.sin(a.x*Math.PI/180)*Math.cos(a.y*Math.PI/180)+a.a.x,a.p.y=a.d*-Math.sin(a.y*Math.PI/180)+a.a.y,a.p.z=-a.d*Math.cos(a.x*Math.PI/180)*Math.cos(a.y*Math.PI/180)+a.a.z,e.renderer.draw(n,e.camera),requestAnimationFrame(t)}}))}},{key:"showDialog",value:function(){this.setState({show:!0})}},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"getMouseXd",value:function(){return this.oldX-this.x}},{key:"getMouseYd",value:function(){return this.oldY-this.y}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(Q.a,{show:this.state.show,onHide:function(){e.hideDialog()},onShow:this.updateCanvas},r.a.createElement("canvas",{ref:this.canvas,width:"2000",height:"2000",style:{width:"600px",height:"600px"},onKeyDown:function(t){e.keyDown=t.keyCode},onKeyUp:function(t){e.keyDown=" ".concat(0)},onMouseMove:function(t){e.move=!0,e.oldX=e.x,e.oldY=e.y,e.x=t.pageX,e.y=t.pageY},onMouseDown:function(){e.down=!0},onMouseUp:function(){e.down=!1},onWheel:function(t){var a=0;a=t.deltaY>0?1:-1,e.camera.d+=e.camera.d/(100*a)*10}})))}}]),a}(n.Component),qe=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).showDialog=n.showDialog.bind(Object(d.a)(n)),n.hideDialog=n.hideDialog.bind(Object(d.a)(n)),n.state={show:!1,name:n.props.name,filelabel:n.props.filelabel,modeldata:n.props.modeldata},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){}},{key:"showDialog",value:function(){var e=Object(u.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({show:!0});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Q.a,{show:this.state.show,onHide:function(){e.hideDialog()}},r.a.createElement(Q.a.Header,{closeButton:!0},r.a.createElement(Q.a.Title,null,"Modify geometry")),r.a.createElement(Q.a.Body,null,r.a.createElement(J.a,null,r.a.createElement(_.a,null,"Name",r.a.createElement(H.a,null,r.a.createElement(Y.a,null,r.a.createElement(J.a.Control,{className:"name",required:!0,type:"text",maxLength:"10",value:this.state.name,onChange:function(t){e.setState({name:t.target.value})}}))),r.a.createElement("hr",null),"STL File",r.a.createElement(J.a.File,{id:"stl-file",label:this.state.filelabel,"data-browse":"Open",custom:!0,onChange:function(t){var a=new FileReader;a.onload=function(){var t=a.result;e.setState({modeldata:t})},a.readAsBinaryString(t.target.files[0]);var n=t.target.value;n=n.split("\\")[n.split("\\").length-1],e.setState({filelabel:n})}})))),r.a.createElement(Q.a.Footer,null,r.a.createElement(W.a,{variant:"secondary",onClick:function(){e.hideDialog()}},"Cancel"),r.a.createElement(W.a,{variant:"primary",onClick:function(){0!=e.state.modeldata.length?(e.hideDialog(),e.props.volume.name=e.state.name,e.props.setname(e.state.name),e.props.volume.data=e.state.modeldata):alert("Select an stl file!")}},"Modify"))))}}]),a}(n.Component),Ke=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).editdialog=r.a.createRef(),n.updateDetails=n.updateDetails.bind(Object(d.a)(n)),n.setName=n.setName.bind(Object(d.a)(n)),n.state={details:n.props.details,name:n.props.name},n.canvas=r.a.createRef(),n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){}},{key:"updateDetails",value:function(e){this.setState({details:e})}},{key:"setName",value:function(e){this.setState({name:e})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(Xe,{modeldata:this.props.modeldata,ref:this.canvas}),r.a.createElement(qe,{setname:this.setName,ref:this.editdialog,volume:this.props.volume,name:this.props.name,modeldata:this.props.modeldata,filelabel:this.props.filelabel}),r.a.createElement(K.a,{className:"button"},r.a.createElement(K.a.Header,null,r.a.createElement(q.a.Toggle,{as:W.a,variant:"link",eventKey:this.id,onClick:function(){e.canvas.current.showDialog()}},this.state.name),r.a.createElement(W.a,{onClick:function(){e.editdialog.current.showDialog()},className:"editButton"},"EDIT"))))}}]),a}(n.Component);Ke.id=0;var We=Ke,Qe=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).showDialog=n.showDialog.bind(Object(d.a)(n)),n.hideDialog=n.hideDialog.bind(Object(d.a)(n)),n.state={show:!1,title:"",content:"",fun:null,arg:null},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){}},{key:"showDialog",value:function(e,t,a,n){this.setState({title:e,content:t,fun:a,arg:n}),this.setState({show:!0})}},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Q.a,{show:this.state.show,onHide:function(){e.hideDialog()}},r.a.createElement(Q.a.Header,{closeButton:!0},r.a.createElement(Q.a.Title,null,this.state.title)),r.a.createElement(Q.a.Body,null,this.state.content),r.a.createElement(Q.a.Footer,null,r.a.createElement(W.a,{variant:"primary",onClick:function(){e.state.fun(e.state.arg),e.hideDialog()}},"OK"))))}}]),a}(n.Component),Je=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).showDialog=n.showDialog.bind(Object(d.a)(n)),n.hideDialog=n.hideDialog.bind(Object(d.a)(n)),n.addVolume=n.addVolume.bind(Object(d.a)(n)),n.removeVolume=n.removeVolume.bind(Object(d.a)(n)),n.state={show:!1,volumes:[],fixed:[],showConfirm:"none",fun:null},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){}},{key:"updateVolume",value:function(e,t){for(var a=this.state.fixed,n=0;n<this.state.fixed.length;n++)this.state.fixed[n].volume==e&&(a[n].label=t);this.setState({fixed:a})}},{key:"removeVolume",value:function(e){for(var t=this.state.volumes,a=0;a<this.state.volumes.length;a++)this.state.volumes[a]==e&&t.splice(a,1);this.setState({volumes:t})}},{key:"addVolume",value:function(e,t,a){var n=this.state.fixed;n.push({volume:e,label:t,data:a}),this.setState({fixed:n}),0==this.state.volumes.length&&this.setState({showConfirm:"block"})}},{key:"showDialog",value:function(e,t){this.setState({show:!0,fun:t}),this.setState({volumes:e,fixed:[],showConfirm:"none"})}},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e=this,t=this.state.volumes.map((function(t){return r.a.createElement(r.a.Fragment,null,r.a.createElement(H.a,{style:{padding:"10px",border:"solid 1px black"}},r.a.createElement(Y.a,null,t),r.a.createElement(Y.a,null,r.a.createElement(J.a.File,{id:"stl-file","data-browse":"Open",label:"",custom:!0,onChange:function(a){var n=new FileReader;n.onload=function(){var a=n.result;e.addVolume(t,r,a)},n.readAsBinaryString(a.target.files[0]);var r=a.target.value;r=r.split("\\")[r.split("\\").length-1],e.setState({filelabel:r}),e.removeVolume(t)}}))))})),a=this.state.fixed.map((function(t,a){return r.a.createElement(r.a.Fragment,null,r.a.createElement(H.a,{style:{padding:"10px",border:"solid 1px black"}},r.a.createElement(Y.a,null,t.volume),r.a.createElement(Y.a,null,r.a.createElement(J.a.File,{id:"stl-file","data-browse":"Open",label:t.label,custom:!0,onChange:function(a){var n=new FileReader;n.onload=function(){var t=n.result;e.setState({modeldata:t})},n.readAsBinaryString(a.target.files[0]);var r=a.target.value;r=r.split("\\")[r.split("\\").length-1],e.setState({filelabel:r}),e.updateVolume(t.volume,r)}}))))}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(Q.a,{show:this.state.show,onHide:function(){e.hideDialog()}},r.a.createElement(Q.a.Header,{closeButton:!0},r.a.createElement(Q.a.Title,null,"Choose a geometry")),r.a.createElement(Q.a.Body,null,r.a.createElement(J.a,null,r.a.createElement(_.a,null,"Missing volumes",t,r.a.createElement("hr",null),"Fixed volumes",a))),r.a.createElement(Q.a.Footer,null,r.a.createElement(W.a,{variant:"secondary",onClick:function(){e.hideDialog()}},"Cancel"),r.a.createElement(W.a,{style:{display:this.state.showConfirm},variant:"primary",onClick:function(){if(0==e.state.volumes){e.hideDialog();for(var t=0;t<e.state.fixed.length;t++)e.props.createbutton(e.state.fixed[t].volume,e.state.fixed[t].data);e.state.fun()}else alert("Select an stl file!")}},"OK"))))}}]),a}(n.Component);Je.id=0;var Ze=Je,$e=(a(497),function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).spectrum=r.a.createRef(),n.navbar=r.a.createRef(),n.codeeditor=r.a.createRef(),n.volumedialog=r.a.createRef(),n.popup=r.a.createRef(),n.volumeselect=r.a.createRef(),n.state={buttons:[],gunbuttons:[],sourcebuttons:[],volumebuttons:[],spectrum:!0,page:"first",volumebuttonheight:"100%"},n.createDetector=n.createDetector.bind(Object(d.a)(n)),n.createSource=n.createSource.bind(Object(d.a)(n)),n.createGun=n.createGun.bind(Object(d.a)(n)),n.createVolume=n.createVolume.bind(Object(d.a)(n)),n.removeDetector=n.removeDetector.bind(Object(d.a)(n)),n.removeGun=n.removeGun.bind(Object(d.a)(n)),n.removeSource=n.removeSource.bind(Object(d.a)(n)),n.runSim=n.runSim.bind(Object(d.a)(n)),n.runSpectroscopy=n.runSpectroscopy.bind(Object(d.a)(n)),n.setShowParticles=n.setShowParticles.bind(Object(d.a)(n)),n.setShowTracks=n.setShowTracks.bind(Object(d.a)(n)),n.setShowAxes=n.setShowAxes.bind(Object(d.a)(n)),n.setShowGrid=n.setShowGrid.bind(Object(d.a)(n)),n.clearRun=n.clearRun.bind(Object(d.a)(n)),n.clearSetup=n.clearSetup.bind(Object(d.a)(n)),n.accordion=r.a.createRef(),n.canvas=r.a.createRef(),n.detectors=[],n.guns=[],n.sources=[],n.particles=[],n.tracks=[],n.volumes=[],n}return Object(h.a)(a,[{key:"clearRun",value:function(){this.canvas.current.clearRun(),this.canvas.current.updateColorHint("0 keV","0 keV")}},{key:"runSpectroscopy",value:function(e,t,a,n){le.log(1,"Started spectrum simulation");var r=[];r.push(0),r.push(1),r.push(0),r.push(0),r.push(0),r.push(0),r.push(0),r.push(0),r.push(0);var o=this.detectors.length;r.push(o);for(var i=0;i<o;i++){r.push("G4_"+this.detectors[i].material),r.push(this.detectors[i].id),r.push(this.detectors[i].model.position.x),r.push(this.detectors[i].model.position.y),r.push(this.detectors[i].model.position.z),r.push(this.detectors[i].model.rotation.x),r.push(this.detectors[i].model.rotation.y),r.push(this.detectors[i].model.rotation.z),r.push(this.detectors[i].model.scale.x),r.push(this.detectors[i].model.scale.y),r.push(this.detectors[i].model.scale.z),r.push(this.detectors[i].model.vertices.length);for(var s=0;s<this.detectors[i].model.vertices.length;s++)r.push(this.detectors[i].model.vertices[s])}var l=this.sources.length;r.push(l);for(i=0;i<l;i++)r.push(this.sources[i].material),r.push(this.sources[i].model.position.x),r.push(this.sources[i].model.position.y),r.push(this.sources[i].model.position.z);var c=this.guns.length;r.push(c);for(i=0;i<c;i++)r.push(this.guns[i].model.position.x),r.push(this.guns[i].model.position.y),r.push(this.guns[i].model.position.z),r.push(this.guns[i].direction.x),r.push(this.guns[i].direction.y),r.push(this.guns[i].direction.z),r.push(this.guns[i].energy);r.push(this.detectors[t].id),r.push(e),r.push("end"),this.sendGamma(r,a,n)}},{key:"runSim",value:function(e,t){this.clearRun(),le.log(1,"Started simulation");var a=[];a.push(1),a.push(1),a.push(0),a.push(0),a.push(0),a.push(0),a.push(0),a.push(0),a.push(0);var n=this.detectors.length;a.push(n);for(var r=0;r<n;r++){a.push("G4_"+this.detectors[r].material),a.push(this.detectors[r].id),a.push(this.detectors[r].model.position.x),a.push(this.detectors[r].model.position.y),a.push(this.detectors[r].model.position.z),a.push(this.detectors[r].model.rotation.x),a.push(this.detectors[r].model.rotation.y),a.push(this.detectors[r].model.rotation.z),a.push(this.detectors[r].model.scale.x),a.push(this.detectors[r].model.scale.y),a.push(this.detectors[r].model.scale.z),a.push(this.detectors[r].model.vertices.length);for(var o=0;o<this.detectors[r].model.vertices.length;o++)a.push(this.detectors[r].model.vertices[o])}var i=this.sources.length;a.push(i);for(r=0;r<i;r++)a.push(this.sources[r].material),a.push(this.sources[r].model.position.x),a.push(this.sources[r].model.position.y),a.push(this.sources[r].model.position.z);var s=this.guns.length;a.push(s);for(r=0;r<s;r++)a.push(this.guns[r].model.position.x),a.push(this.guns[r].model.position.y),a.push(this.guns[r].model.position.z),a.push(this.guns[r].direction.x),a.push(this.guns[r].direction.y),a.push(this.guns[r].direction.z),a.push(this.guns[r].energy);a.push(e),a.push("end"),this.send(a,t)}},{key:"sendGamma",value:function(e,t,a){for(var n=this,r="",o=0;o<e.length;o++)r+=e[o],r+=",";fetch("http://radsim.inf.elte.hu:9000/gammaAPI",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({data:r})}).then((function(e){return e.text()})).then((function(e){n.processGammaSpectrum(e,a),t(),n.setState({spectrum:!1,page:"second"}),le.log(1,"Finished spectrum simulation")}))}},{key:"send",value:function(e,t){for(var a=this,n="",r=0;r<e.length;r++)n+=e[r],n+=",";fetch("http://radsim.inf.elte.hu:9000/gammaAPI",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({data:n})}).then((function(e){return e.text()})).then((function(e){a.processResponse(e),t(),le.log(1,"Finished simulation")}))}},{key:"processGammaSpectrum",value:function(e,t){var a=e;a=a.split(" "),this.spectrum.current.clear(t);for(var n=0;n<a.length;n++)this.spectrum.current.add(Math.floor(parseFloat(a[n])/t)*t);this.spectrum.current.sort(t)}},{key:"processResponse",value:function(e){var t=e.split(" "),a=0,n=0;for(this.particles=[];a<t.length-1-this.detectors.length-1;){var r=[],o=parseInt(t[a]);if(0==o)break;for(var i=t[a+1],s=0;s<o;s++){var l=new Be;l.position.x=.1*parseFloat(t[a+7*s+2]),l.position.y=.1*parseFloat(t[a+7*s+3]),l.position.z=.1*parseFloat(t[a+7*s+4]),r.push(.1*parseFloat(t[a+7*s+2])),r.push(.1*parseFloat(t[a+7*s+3])),r.push(.1*parseFloat(t[a+7*s+4])),l.definition=i,l.track_id=parseInt(t[a+7*s+5]),l.parent_id=parseInt(t[a+7*s+6]),l.totalEnergy=parseFloat(t[a+7*s+7]),l.energyDeposit=parseFloat(t[a+7*s+8]),l.color=new y(1,0,0),l.id=n,n++,s>0&&this.particles.push(l)}a+=7*o+2;for(var c=[],u=0;u<r.length;u++)c.push(1);var m=this.canvas.current.addModel(r,c);"e-"==i&&(m.color=new y(1,0,1)),"gamma"==i&&(m.color=new y(1,1,1)),"e+"==i&&(m.color=new y(1,1,0)),m.drawLines=!0,this.tracks.push(m)}this.particles.length>1e3&&(this.popup.current.showDialog("Too many particles!","Low energy particles will be ommited!",(function(){})),this.particles=this.particles.sort((function(e,t){return t.energyDeposit-e.energyDeposit})),this.particles.length=1e3);var h=[];for(s=0;s<this.particles.length;s++)h.push(this.particles[s]);this.particles=h.slice();var d=function(e){for(var t=0,a=0;a<e.length;a++)e[a].energyDeposit>t&&(t=e[a].energyDeposit);return t}(this.particles),p=function(e){for(var t=0,a=0;a<e.length;a++)e[a].energyDeposit<=d&&(t=e[a].energyDeposit);return t}(this.particles);this.canvas.current.updateColorHint(Math.ceil(1e3*d)+" keV",Math.ceil(1e3*p)+" keV"),this.canvas.current.instanceRenderer.maxenergy=d;for(var g=0;g<this.particles.length;g++){this.particles[g].color.x=this.particles[g].energyDeposit;var v=Math.sqrt(this.particles[g].color.x/d);this.particles[g].scale=new y(.03*v,.03*v,.03*v),this.canvas.current.addParticle(this.particles[g])}this.particles.length>0&&this.navbar.current.showClearParticles(!0)}},{key:"modifyDetector",value:function(e){}},{key:"createVolume",value:function(e,t,a){var n=F.parseData(t),o=this.state.volumebuttons;ae.addVolume({name:e,data:t});var i={name:e,data:t};this.volumes.push(i),o.push(r.a.createElement(We,{name:e,volume:i,modeldata:n,filelabel:a})),this.setState({volumebuttons:o})}},{key:"createSource",value:function(){var e=Object(u.a)(c.a.mark((function e(t,a,n,o,i,s,l){var u,m,h;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.detectors.length>0&&this.navbar.current.showRun(!0),this.navbar.current.showClearSetup(!0),s||this.codeeditor.current.updateText(this.codeeditor.current.state.text+'\\Source{\n\tname: "'+t+'";\n\tposition['+se.convertLength(l)+"]: "+a+", "+n+", "+o+';\n\tmaterial: "'+i+'";\n}\n'),u=this.state.sourcebuttons,m=r.a.createElement(_.a,null,r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"Position: ")),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"x: ",a," ",se.convertLength(l)),r.a.createElement(Y.a,null,"y: ",n," ",se.convertLength(l)),r.a.createElement(Y.a,null,"z: ",o," ",se.convertLength(l))),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"Material: ",i))),(h=this.canvas.current.addSource(a*l,n*l,o*l,i)).id=+he.id,re.chunks.push({id:h.id,code:'\\Source{\n\tname: "'+t+'";\n\tposition['+se.convertLength(l)+"]: "+a+", "+n+", "+o+';\n\tmaterial: "'+i+'";\n}\n'}),h.name=t,h.units[0]=l,this.sources.push(h),u.push(r.a.createElement(ze,{codeeditor:this.codeeditor,name:t,removebutton:this.removeSource,id:he.id,detector:h,details:m,key:++he.id,buttons:this.state.sourcebuttons})),this.setState({sourcebuttons:u}),le.log(1,"Created source"),e.abrupt("return",[h,he.id]);case 15:case"end":return e.stop()}}),e,this)})));return function(t,a,n,r,o,i,s){return e.apply(this,arguments)}}()},{key:"createGun",value:function(){var e=Object(u.a)(c.a.mark((function e(t,a,n,o,i,s,l,u,m,h,d){var p,g,v;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.detectors.length>0&&this.navbar.current.showRun(!0),this.navbar.current.showClearSetup(!0),m||this.codeeditor.current.updateText(this.codeeditor.current.state.text+'\\Gun{\n\tname: "'+t+'";\n\tposition['+se.convertLength(h)+"]: "+a+", "+n+", "+o+";\n\tdirection: "+i+", "+s+", "+l+";\n\tenergy["+se.convertEnergy(d)+"]: "+u+";\n}\n"),p=this.state.gunbuttons,g=r.a.createElement(_.a,null,r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"Position: ")),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"x: ",a," cm"),r.a.createElement(Y.a,null,"y: ",n," cm"),r.a.createElement(Y.a,null,"z: ",o," cm")),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"Direction: ")),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"x: ",i," "),r.a.createElement(Y.a,null,"y: ",s," "),r.a.createElement(Y.a,null,"z: ",l," ")),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"Energy: ",u," keV"))),(v=this.canvas.current.addGun(a*h,n*h,o*h,i,s,l,u*d)).id=+he.id,re.chunks.push({id:v.id,code:'\\Gun{\n\tname: "'+t+'";\n\tposition[cm]: '+a+", "+n+", "+o+";\n\tdirection: "+i+", "+s+", "+l+";\n\tenergy[keV]: "+u+";\n}\n"}),v.name=t,v.units[0]=h,v.units[1]=d,this.guns.push(v),p.push(r.a.createElement(we,{codeeditor:this.codeeditor,name:t,removebutton:this.removeGun,id:he.id,detector:v,details:g,key:++he.id,buttons:this.state.buttons})),this.setState({gunbuttons:p}),le.log(1,"Created gun"),e.abrupt("return",[v,he.id]);case 16:case"end":return e.stop()}}),e,this)})));return function(t,a,n,r,o,i,s,l,c,u,m){return e.apply(this,arguments)}}()},{key:"createDetector",value:function(){var e=Object(u.a)(c.a.mark((function e(t,a,n,o,i,s,l,u,m,h,d,p,g,v,f,b,y,E){var x,w,O,A,S,C=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((this.sources.length>0||this.guns.length>0)&&this.navbar.current.showRun(!0),this.navbar.current.showClearSetup(!0),f||this.codeeditor.current.updateText(this.codeeditor.current.state.text+'\\Detector{\n\tname: "'+t+'";\n\tposition['+se.convertLength(b)+"]: "+a+", "+n+", "+o+";\n\trotation["+se.convertAngle(y)+"]: "+i+", "+s+", "+l+";\n\tscale["+se.convertLength(E)+"]: "+u+", "+m+", "+h+';\n\tmaterial: "'+d+'";\n\tgeometry: "'+p+'";\n}\n'),x=this.state.buttons,w=r.a.createElement(_.a,null,r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"Position: ")),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"x: ",a," ",se.convertLength(b)),r.a.createElement(Y.a,null,"y: ",n," ",se.convertLength(b)),r.a.createElement(Y.a,null,"z: ",o," ",se.convertLength(b))),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"Rotation: ")),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"x: ",i," ",se.convertAngle(y)),r.a.createElement(Y.a,null,"y: ",s," ",se.convertAngle(y)),r.a.createElement(Y.a,null,"z: ",l," ",se.convertAngle(y))),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"Scale: ")),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"x: ",u," ",se.convertLength(E)),r.a.createElement(Y.a,null,"y: ",m," ",se.convertLength(E)),r.a.createElement(Y.a,null,"z: ",h," ",se.convertLength(E))),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,"Material: ")),r.a.createElement(H.a,null,r.a.createElement(Y.a,null,d))),O=function(e){e.id=+he.id,e.geometry=p,re.chunks.push({id:e.id,code:'\\Detector{\n\tname: "'+t+'";\n\tposition[cm]: '+a+", "+n+", "+o+";\n\trotation[rad]: "+i+", "+s+", "+l+";\n\tscale[cm]: "+u+", "+m+", "+h+';\n\tmaterial: "'+d+'";\n\tgeometry: "'+p+'";\n}\n'}),e.name=t,e.model.color=v,e.units[0]=b,e.units[1]=y,e.units[2]=E,C.detectors.push(e),x.push(r.a.createElement(he,{volumes:C.volumes,canvas:C.canvas,codeeditor:C.codeeditor,name:t,removebutton:C.removeDetector,id:he.id,detector:e,details:w,key:++he.id,buttons:C.state.buttons})),C.setState({buttons:x})},A=null,"stl"!=p){e.next=13;break}S=F.parseData(g),A=this.canvas.current.addSTLDetector(a*b,n*b,o*b,i*y,s*y,l*y,u*E,m*E,h*E,d,S),O(A),e.next=17;break;case 13:return e.next=15,this.canvas.current.addDetector(a*b,n*b,o*b,i*y,s*y,l*y,u*E,m*E,h*E,d,p,this.volumes);case 15:A=e.sent,O(A);case 17:return le.log(1,"Created detector"),e.abrupt("return",[A,he.id]);case 19:case"end":return e.stop()}}),e,this)})));return function(t,a,n,r,o,i,s,l,c,u,m,h,d,p,g,v,f,b){return e.apply(this,arguments)}}()},{key:"clearSetup",value:function(){re.chunks=[],this.codeeditor.current.updateText(" "),this.codeeditor.current.text="",he.id=0,this.setState({buttons:[],gunbuttons:[],sourcebuttons:[]}),this.canvas.current.clearSetup(),this.detectors=[],this.sources=[],this.guns=[],this.state.buttons=[],this.state.gunbuttons=[],this.state.sourcebuttons=[],this.clearRun(),le.log(1,"Cleared setup")}},{key:"removeSource",value:function(e,t){(this.detectors.length<1||this.sources.length<1&&this.guns.length<1)&&this.navbar.current.showRun(!1),0==this.sources.length&&0==this.guns.length&&0==this.detectors.length&&this.navbar.current.showClearSetup(!1),this.canvas.current.removeSource(e),this.codeeditor.current.updateText(re.removeChunk(e.id));for(var a=0;a<this.state.sourcebuttons.length;a++)if(this.state.sourcebuttons[a].key-1==t){var n=this.state.sourcebuttons;return n.splice(a,1),this.sources.splice(a,1),this.setState({sourcebuttons:n}),void le.log(1,"Removed source")}}},{key:"removeGun",value:function(e,t){(this.detectors.length<1||this.sources.length<1&&this.guns.length<1)&&this.navbar.current.showRun(!1),0==this.sources.length&&0==this.guns.length&&0==this.detectors.length&&this.navbar.current.showClearSetup(!1),le.log(1,"Removed gun"),this.canvas.current.removeGun(e),this.codeeditor.current.updateText(re.removeChunk(e.id));for(var a=0;a<this.state.gunbuttons.length;a++)if(this.state.gunbuttons[a].key-1==t){var n=this.state.gunbuttons;return n.splice(a,1),this.guns.splice(a,1),void this.setState({gunbuttons:n})}}},{key:"removeDetector",value:function(e,t){(this.detectors.length<1||this.sources.length<1&&this.guns.length<1)&&this.navbar.current.showRun(!1),0==this.sources.length&&0==this.guns.length&&0==this.detectors.length&&this.navbar.current.showClearSetup(!1),this.canvas.current.removeDetector(e),this.codeeditor.current.updateText(re.removeChunk(e.id));for(var a=0;a<this.state.buttons.length;a++)if(this.state.buttons[a].key-1==t){var n=this.state.buttons;return n.splice(a,1),this.detectors.splice(a,1),this.setState({buttons:n}),void le.log(1,"Removed detector")}}},{key:"setShowTracks",value:function(e){this.canvas.current.setShowTracks(!e)}},{key:"setShowParticles",value:function(e){this.canvas.current.drawParticles=!e}},{key:"setShowAxes",value:function(e){this.canvas.current.setShowAxes(!e)}},{key:"setShowGrid",value:function(e){this.canvas.current.drawGrid=!e}},{key:"componentDidMount",value:function(){var e=Object(u.a)(c.a.mark((function e(){var t,a,n,r,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return re.init(this.volumeselect.current,this.popup.current.showDialog),e.next=3,fetch("http://radsim.inf.elte.hu:9000/database",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({name:""})});case 3:return t=e.sent,e.next=6,t.json();case 6:for(a=e.sent,n=0;n<a.length;n++){for(r="",o=0;o<a[n].data.data.length;o++)r+=String.fromCharCode(a[n].data.data[o]);this.createVolume(a[n].name,r,"")}this.createDetector("Cube",0,0,0,0,0,0,10,10,10,"Pb","cube",null,new y(1,1,1),!1,1,1,1);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.buttons.map((function(e){return r.a.createElement("div",{style:{"z-index":"3",color:"black"}}," ",e," ")})),a=this.state.gunbuttons.map((function(e){return r.a.createElement("div",null," ",e," ")})),n=this.state.sourcebuttons.map((function(e){return r.a.createElement("div",null," ",e," ")})),o=this.state.volumebuttons.map((function(e){return r.a.createElement("div",{style:{"z-index":"3",color:"black"}}," ",e," ")}));return r.a.createElement("div",null,r.a.createElement(Ze,{ref:this.volumeselect,createbutton:this.createVolume}),r.a.createElement(Ne,{ref:this.volumedialog,createbutton:this.createVolume}),r.a.createElement(Qe,{ref:this.popup}),r.a.createElement(G.a.Container,{id:"left-tabs-example",defaultActiveKey:"first",activeKey:this.state.page},r.a.createElement(Y.a,{sm:3},r.a.createElement(X.a,Object(s.a)({variant:"pills",className:"flex-column"},"className","page"),r.a.createElement(X.a.Item,null,r.a.createElement(X.a.Link,{eventKey:"first",onClick:function(){e.setState({page:"first"})}},"simulation")),r.a.createElement(X.a.Item,null,r.a.createElement(X.a.Link,{eventKey:"second",disabled:this.state.spectrum,onClick:function(){e.setState({page:"second"})}},"spectrum")))),r.a.createElement(G.a.Content,null,r.a.createElement(G.a.Pane,{eventKey:"first",style:{overflow:"hidden"}},r.a.createElement(V,{ref:this.canvas,style:{overflow:"hidden"}}),r.a.createElement(Ge,{ref:this.codeeditor,createGun:this.createGun,clearSetup:this.clearSetup,createSource:this.createSource,createDetector:this.createDetector,canvas:this.canvas}),r.a.createElement(Ue,{run:this.runSim,ref:this.navbar,canvas:this.canvas,className:"navbar",volumes:this.volumes,runspectroscopy:this.runSpectroscopy,createbutton:this.createDetector,creategunbutton:this.createGun,createsourcebutton:this.createSource,createvolume:this.createVolume,setshowtracks:this.setShowTracks,setshowparticles:this.setShowParticles,setshowaxes:this.setShowAxes,setshowgrid:this.setShowGrid,clearrun:this.clearRun,clearSetup:this.clearSetup,detectors:this.detectors,buttons:this.state.buttons}),r.a.createElement("div",{className:"buttonbackground"}),r.a.createElement(q.a,{ref:this.accordion,defaultActiveKey:"0",className:"accordion",style:{maxHeight:window.innerHeight-50,height:window.innerHeight-50,"overflow-y":"scroll"}},r.a.createElement("div",{style:{color:"white","text-align":"center","background-color":"gray",border:"1px solid white"}},"Volumes"),o,r.a.createElement("div",{style:{color:"white","text-align":"center","background-color":"gray",border:"1px solid white"}},"Detectors"),t,r.a.createElement("div",{style:{color:"white","text-align":"center","background-color":"gray",border:"1px solid white"}},"Sources"),n,r.a.createElement("div",{style:{color:"white","text-align":"center","background-color":"gray",border:"1px solid white"}},"Guns"),a)),r.a.createElement(G.a.Pane,{eventKey:"second"},r.a.createElement(_e,{ref:this.spectrum})))))}}]),a}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement($e,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},94:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAh1BMVEX///8AAAD39/dXV1dra2tnZ2f6+vpubm5aWlphYWF1dXUjIyP8/Px8fHweHh5UVFRDQ0Pw8PA7Ozvf399LS0vU1NSdnZ0aGhrr6+vOzs4yMjLa2tqmpqasrKzAwMAoKCiKiooRERG7u7uPj48vLy96enqWlpYLCwtISEi+vr6hoaE3Nzc/Pz/54TKiAAAIzUlEQVR4nO2daVvqPBCGW8QNEVFAQFQo4HLE///7Xha7TyaTNplJeft8OtdpG+Y2bbM08yQImq3FT++yu5pJh+FM7y/hSW/SkbhR/zZM1JMOxoVGYVa7R+l4rGsRFjSSjsiyJkXAMHyXjsmqSjVY9X3zOFm/fW42q5PuM+rtdb1X97KoW0j5U7rXWfVy+jgW312gcc0gwDD8NKObvV7C5XDoFf/Dqy5bGeA9LzmBisLvt06kvPCDyDe54YOBhNdgZ4BcSmoYJ0M2FFiaW3SKXnyt5XsUfPpOwgGBZiIvHeIbBwOqHzzAlbYA9Ea9umBAwKUBDIKutoh79cUj7cXO9awDDIKxtpCV6tJ3BgKNSG32VlvMBr5Q/hEkdkqQ9jAWeCt4AKj405ek7NOkAvoMa/cAOuGAsygdAir6pVmti9drmxn30gDuz0jnY8CxRV6FwRSh3l1LD5hFJNTIPFfAk+Pw9cJfMnE7liLO9UVOMgVsnAZPEd4Opg11RUT5lh7vyWTjSxEJzXcyjt45i5wofDyYrwAjxL/pKfGGovRmRwCzk2p6xOh04pebuMmaK9BgQDPEY5sh3ZnBJ52gls8A8TitgY+Zjxpv1vPFaDSazWaPe3Us6eoglE/RtNMRtwHhrTtca6JwKFXfJUXUhb8/RTNr8YDfRG6l7pylUeGI0/2wHgcUnSrHep9ExJsg+Icdf5C7PwNd3zNFxP4Qr0HwgRxGJjwYpOtcp30yBHE/4rpTH6UOSN1IP3ogdDv3ddRRF+B3DeYRVUNitKAHOTo0LhPEw7Oq7pN25PBIQyMC4rFD/6O6VrSZoAJm+7TlaYrTkEw1SS56j9IBc4hR/sjfoFrVWEh+9zcBVCPGH3h68GUXMmxHmQFmEbNfFpMxp4JQ8Ck0Bcwh3pX/T0EogXZSlY8n5VrMPGQwof5DqitV+zpUrMXsUj6YUGwlXNXPXxnE6bEzmgomlHqTVv++l63F/GJMmLDPjXZSnQ+YyuksmJATK1W9L7QqRJDwixUsVt1pWwUiSBjxop1Uf14aRvTmLrUx8Q4iXntCaOfLAjSt5AmhHcAJVLQfhHYA4ZldLwjtfDlRTF37QOgU0AdCt4AeENoBVPekxQkd16A8oesaFCd0DyhMyAAoS8gBKErIAihJ+MoCKEjIBChHyAUoRqj85mUbUIrQDiAph1uGkBFQhpADsB/P+UoQstTgMP6HACEL4G/CwE/4zAH4FMoRcgGKEbIA7rIMzIQcgP2XHAMvIQvgNs/ASsgBeBVnJ0oQ2gHETUyuEh+B+H/grNrmAqaLSfkJrQB+4YCdzGpZdkKOGsy5LXATctTgVW69MzOhFcCIfouyE3IAXhVWrLMSsgAW7WY4Ca0ATvFV2SVATkIOQMBngY+QBfBXzeCc0ArgQAP4jTC4JmQBBD1nmAg/bQDeaQDx0YNjQhufl+50CXRw6hYToQVEXQ0GAWy8xkVYG3GpT4EUJqyJuCQsV5YmrIW4pSSxChHOvi0gvpAWnAu9adaZzKKqiDRAKcJ9weOaiERAKcJDMcn3n0qIT9SfkiE8Zbn+1kAkAwoRbophmiL+IoUXBLt9uiaMx2vps2SGaAAoQ5jmHW8rIQ6xwr0gzNCk3S46ohGgDGHGED4zNqAimgHKEOZKWyajAxriN1ayJ4SFXN6BEeIYK5lOGD//bgiLWf4miMaAChuomBB2GKpLWGqD6YjmgBKEgEdFlCDiGUBVvBwECKF6miaT8hhiJbMKAULQ0p2CWM2Ng5+wD4f/pUWs6FXBT6jyfUgRYfutqmYcOKGL1kJtm54sFIHStm+q/h4/IWKuhSBWBuQnRI2alYjVAfkJ8VX4CWL+ab2t8YPshJrdB0DEOoD8hDggiFgLkJ1Q7xGUZEnEpmyXtQDZCe+1hEXEmoDshNg+NyXEg6djtxZeoCKMZxasE9K8wZO83UV9QMXf1BkhMWMrMXiwYGfETPhAI9RYXBuJl1AxrnCKyEto4IRkzfWOl5DQViSy5ZnGS0h3sB++2toClpWQuo/E2BpewExIyku7Xdv1t2Ul1LYVu9Xcut0dJ6HG4L23drKnLSch0laMn50Z9HMSKtqK6OPdpbM0JyFYeT+unTQZCUttRXT/zrD3ACNhvq1wX3l/YiTM7L3Y46i8P8Hzsy4I410I2CrvT3yEh7aC58nLi4/w+uLNYm+TLj5CKbWELaH/aglbQv8FE0p6DNlWS9gS+q+WsCX0Xy1hS+i/8Lyn8yf0Zo+SGsLzLVrCJqglPFPCZM+qcyAE17WdP2EUHz1/QninVcl4zQUSTuOjLWETFEEIg/govLZAMl5zgYR38dGzJVzGR/+nhDJ7WFZWBcIpVp5/Agm38dFzuEvBNa0JIZwrKBmvseCl5S/xYZhQZMFBVXVABA2h4Nbq5pqACLv4MEy4kovXXLCHQeL9AxMusRJ9E5ysnVj4KLKSpbYeryBFDkviAKMgvJeM2UyK5P7EAmYDHw9drum1qxcYIHEQUXnEbiSDNpFqaXmSG65MpnOyqt6BVMn/vfgEpQtHBZ8YCamesnAVnwE3lwf9yIVNlzr8JG3sUXmKzRxIVyJFjySbed8odpCs6vQ9AvcITnKW5WJHj3AS91GD9DTUmWotF75e6mcwzHVZUCeS9J3rn3Az9OxLZIee6Ws1zhETnIOy5+qSIrceMv4baoL+yJ4ND5Fz6r559FodreHVFTnl35Hw56eSli8H7Z4OGh41Puohp4uibiDlT3ko6Fjs9+EXfg8/tjv87na5192AYroRlrwl8XdNI1XsrBBqvVkqWfQifZ9mqtxTsbLPhj+CGnHYe7+pgtLhqVYIjRA8JrKz07kXWoGAZ/Q+VRuEQlsmNVBbJSC0r1cDFWGzoP0zQBzgM4R9XYfde22189jYjEYDRPGwtbMdqpBo0/SLSDrOyiJPfpqYdXmknoFz0WisL883/RrOe84b1vovKyw7WBBnNnzQRcWvD/11I5qOp+daC2MWb6sL4tSPhIYrinXYf/6Tr8nVKFbTAAAAAElFTkSuQmCC"}},[[202,1,2]]]);
//# sourceMappingURL=main.c6b01ccc.chunk.js.map