(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{128:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAh1BMVEX///8AAAD39/dXV1dra2tnZ2f6+vpubm5aWlphYWF1dXUjIyP8/Px8fHweHh5UVFRDQ0Pw8PA7Ozvf399LS0vU1NSdnZ0aGhrr6+vOzs4yMjLa2tqmpqasrKzAwMAoKCiKiooRERG7u7uPj48vLy96enqWlpYLCwtISEi+vr6hoaE3Nzc/Pz/54TKiAAAIzUlEQVR4nO2daVvqPBCGW8QNEVFAQFQo4HLE///7Xha7TyaTNplJeft8OtdpG+Y2bbM08yQImq3FT++yu5pJh+FM7y/hSW/SkbhR/zZM1JMOxoVGYVa7R+l4rGsRFjSSjsiyJkXAMHyXjsmqSjVY9X3zOFm/fW42q5PuM+rtdb1X97KoW0j5U7rXWfVy+jgW312gcc0gwDD8NKObvV7C5XDoFf/Dqy5bGeA9LzmBisLvt06kvPCDyDe54YOBhNdgZ4BcSmoYJ0M2FFiaW3SKXnyt5XsUfPpOwgGBZiIvHeIbBwOqHzzAlbYA9Ea9umBAwKUBDIKutoh79cUj7cXO9awDDIKxtpCV6tJ3BgKNSG32VlvMBr5Q/hEkdkqQ9jAWeCt4AKj405ek7NOkAvoMa/cAOuGAsygdAir6pVmti9drmxn30gDuz0jnY8CxRV6FwRSh3l1LD5hFJNTIPFfAk+Pw9cJfMnE7liLO9UVOMgVsnAZPEd4Opg11RUT5lh7vyWTjSxEJzXcyjt45i5wofDyYrwAjxL/pKfGGovRmRwCzk2p6xOh04pebuMmaK9BgQDPEY5sh3ZnBJ52gls8A8TitgY+Zjxpv1vPFaDSazWaPe3Us6eoglE/RtNMRtwHhrTtca6JwKFXfJUXUhb8/RTNr8YDfRG6l7pylUeGI0/2wHgcUnSrHep9ExJsg+Icdf5C7PwNd3zNFxP4Qr0HwgRxGJjwYpOtcp30yBHE/4rpTH6UOSN1IP3ogdDv3ddRRF+B3DeYRVUNitKAHOTo0LhPEw7Oq7pN25PBIQyMC4rFD/6O6VrSZoAJm+7TlaYrTkEw1SS56j9IBc4hR/sjfoFrVWEh+9zcBVCPGH3h68GUXMmxHmQFmEbNfFpMxp4JQ8Ck0Bcwh3pX/T0EogXZSlY8n5VrMPGQwof5DqitV+zpUrMXsUj6YUGwlXNXPXxnE6bEzmgomlHqTVv++l63F/GJMmLDPjXZSnQ+YyuksmJATK1W9L7QqRJDwixUsVt1pWwUiSBjxop1Uf14aRvTmLrUx8Q4iXntCaOfLAjSt5AmhHcAJVLQfhHYA4ZldLwjtfDlRTF37QOgU0AdCt4AeENoBVPekxQkd16A8oesaFCd0DyhMyAAoS8gBKErIAihJ+MoCKEjIBChHyAUoRqj85mUbUIrQDiAph1uGkBFQhpADsB/P+UoQstTgMP6HACEL4G/CwE/4zAH4FMoRcgGKEbIA7rIMzIQcgP2XHAMvIQvgNs/ASsgBeBVnJ0oQ2gHETUyuEh+B+H/grNrmAqaLSfkJrQB+4YCdzGpZdkKOGsy5LXATctTgVW69MzOhFcCIfouyE3IAXhVWrLMSsgAW7WY4Ca0ATvFV2SVATkIOQMBngY+QBfBXzeCc0ArgQAP4jTC4JmQBBD1nmAg/bQDeaQDx0YNjQhufl+50CXRw6hYToQVEXQ0GAWy8xkVYG3GpT4EUJqyJuCQsV5YmrIW4pSSxChHOvi0gvpAWnAu9adaZzKKqiDRAKcJ9weOaiERAKcJDMcn3n0qIT9SfkiE8Zbn+1kAkAwoRbophmiL+IoUXBLt9uiaMx2vps2SGaAAoQ5jmHW8rIQ6xwr0gzNCk3S46ohGgDGHGED4zNqAimgHKEOZKWyajAxriN1ayJ4SFXN6BEeIYK5lOGD//bgiLWf4miMaAChuomBB2GKpLWGqD6YjmgBKEgEdFlCDiGUBVvBwECKF6miaT8hhiJbMKAULQ0p2CWM2Ng5+wD4f/pUWs6FXBT6jyfUgRYfutqmYcOKGL1kJtm54sFIHStm+q/h4/IWKuhSBWBuQnRI2alYjVAfkJ8VX4CWL+ab2t8YPshJrdB0DEOoD8hDggiFgLkJ1Q7xGUZEnEpmyXtQDZCe+1hEXEmoDshNg+NyXEg6djtxZeoCKMZxasE9K8wZO83UV9QMXf1BkhMWMrMXiwYGfETPhAI9RYXBuJl1AxrnCKyEto4IRkzfWOl5DQViSy5ZnGS0h3sB++2toClpWQuo/E2BpewExIyku7Xdv1t2Ul1LYVu9Xcut0dJ6HG4L23drKnLSch0laMn50Z9HMSKtqK6OPdpbM0JyFYeT+unTQZCUttRXT/zrD3ACNhvq1wX3l/YiTM7L3Y46i8P8Hzsy4I410I2CrvT3yEh7aC58nLi4/w+uLNYm+TLj5CKbWELaH/aglbQv8FE0p6DNlWS9gS+q+WsCX0Xy1hS+i/8Lyn8yf0Zo+SGsLzLVrCJqglPFPCZM+qcyAE17WdP2EUHz1/QninVcl4zQUSTuOjLWETFEEIg/govLZAMl5zgYR38dGzJVzGR/+nhDJ7WFZWBcIpVp5/Agm38dFzuEvBNa0JIZwrKBmvseCl5S/xYZhQZMFBVXVABA2h4Nbq5pqACLv4MEy4kovXXLCHQeL9AxMusRJ9E5ysnVj4KLKSpbYeryBFDkviAKMgvJeM2UyK5P7EAmYDHw9drum1qxcYIHEQUXnEbiSDNpFqaXmSG65MpnOyqt6BVMn/vfgEpQtHBZ8YCamesnAVnwE3lwf9yIVNlzr8JG3sUXmKzRxIVyJFjySbed8odpCs6vQ9AvcITnKW5WJHj3AS91GD9DTUmWotF75e6mcwzHVZUCeS9J3rn3Az9OxLZIee6Ws1zhETnIOy5+qSIrceMv4baoL+yJ4ND5Fz6r559FodreHVFTnl35Hw56eSli8H7Z4OGh41Puohp4uibiDlT3ko6Fjs9+EXfg8/tjv87na5192AYroRlrwl8XdNI1XsrBBqvVkqWfQifZ9mqtxTsbLPhj+CGnHYe7+pgtLhqVYIjRA8JrKz07kXWoGAZ/Q+VRuEQlsmNVBbJSC0r1cDFWGzoP0zQBzgM4R9XYfde22189jYjEYDRPGwtbMdqpBo0/SLSDrOyiJPfpqYdXmknoFz0WisL883/RrOe84b1vovKyw7WBBnNnzQRcWvD/11I5qOp+daC2MWb6sL4tSPhIYrinXYf/6Tr8nVKFbTAAAAAElFTkSuQmCC"},193:function(e,t,a){e.exports=a(488)},197:function(e,t,a){},22:function(e,t,a){},488:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(17),s=a.n(o),i=(a(197),a(4)),l=a(6),c=a(10),u=a(9),h=a(11),d=a(12),m=(a(22),a(70)),p=a.n(m),g=a(94),v=function(){function e(t,a,r){Object(l.a)(this,e),this.gl=r;var n=a.vertexShader,o=a.fragmentShader,s=r.createShader(r.VERTEX_SHADER),i=r.createShader(r.FRAGMENT_SHADER);if(r.shaderSource(s,n),r.shaderSource(i,o),r.compileShader(s),r.getShaderParameter(s,r.COMPILE_STATUS))if(r.compileShader(i),r.getShaderParameter(i,r.COMPILE_STATUS)){this.program=r.createProgram(),r.attachShader(this.program,s),r.attachShader(this.program,i);for(var c=0;c<t.length;c++)r.bindAttribLocation(this.program,t[c][0],t[c][1]);r.linkProgram(this.program),r.getProgramParameter(this.program,r.LINK_STATUS)?(r.validateProgram(this.program),r.getProgramParameter(this.program,r.VALIDATE_STATUS)||console.error("ERROR validating program!",r.getProgramInfoLog(this.program))):console.error("ERROR linking program!",r.getProgramInfoLog(this.program))}else console.error("ERROR compiling fragment shader!",r.getShaderInfoLog(i));else console.error("ERROR compiling vertex shader!",r.getShaderInfoLog(s))}return Object(c.a)(e,[{key:"bind",value:function(){this.gl.useProgram(this.program)}},{key:"unBind",value:function(){this.gl.useProgram(null)}},{key:"setUniform",value:function(e,t){var a=this.gl.getUniformLocation(this.program,e);-1!=a&&this.gl.uniform1f(a,t)}},{key:"setUniform1i",value:function(e,t){var a=this.gl.getUniformLocation(this.program,e);-1!=a&&this.gl.uniform1i(a,t)}},{key:"setUniform3f",value:function(e,t,a,r){var n=this.gl.getUniformLocation(this.program,e);-1!=n&&this.gl.uniform3f(n,t,a,r)}},{key:"setUniform4fv",value:function(e,t){var a=this.gl.getUniformLocation(this.program,e);-1!=a&&this.gl.uniformMatrix4fv(a,!1,t)}}]),e}(),f=a(192),b=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this,16))[0]=1,e[5]=1,e[10]=1,e[15]=1,e}return a}(Object(f.a)(Float64Array)),y=function e(t,a,r){Object(l.a)(this,e),this.x=t,this.y=a,this.z=r},E=function e(t,a,r,n,o){Object(l.a)(this,e),this.x=t,this.y=a,this.d=r,this.p=n,this.a=o},x=function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,null,[{key:"scale",value:function(e,t){for(var a=new b,r=0;r<16;r++)a[r]=e[r];return a[0]=a[0]*t.x,a[1]=a[1]*t.x,a[2]=a[2]*t.x,a[4]=a[4]*t.y,a[5]=a[5]*t.y,a[6]=a[6]*t.y,a[8]=a[8]*t.z,a[9]=a[9]*t.z,a[10]=a[10]*t.z,a}},{key:"translate",value:function(e,t){for(var a=new b,r=0;r<16;r++)a[r]=e[r];return a[12]=e[0]*t.x+e[4]*t.y+e[8]*t.z+e[12],a[13]=e[1]*t.x+e[5]*t.y+e[9]*t.z+e[13],a[14]=e[2]*t.x+e[6]*t.y+e[10]*t.z+e[14],a[15]=e[3]*t.x+e[7]*t.y+e[11]*t.z+e[15],a}},{key:"normalize",value:function(e){var t=new y;t.x=e.x,t.y=e.y,t.z=e.z;var a=Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z);return t.x/=a,t.y/=a,t.z/=a,t}},{key:"mulVectorDouble",value:function(e,t){var a=new y(0,0,0);return a.x=e.x,a.y=e.y,a.z=e.z,a.x*=t,a.y*=t,a.z*=t,a}},{key:"cross",value:function(e,t){var a=new y(0,0,0);return a.x=e.y*t.z-e.z*t.y,a.y=e.z*t.x-e.x*t.z,a.z=e.x*t.y-e.y*t.x,a}},{key:"lookAt",value:function(e,t,a){var r=new y(0,0,0),n=new y(0,0,0);r.x=t.x-e.x,r.y=t.y-e.y,r.z=t.z-e.z,r=this.normalize(r);var o=new y(0,0,0);o=this.cross(r,a),o=this.normalize(o),n=this.cross(o,r);var s=new b;return s[0]=o.x,s[1]=o.y,s[2]=o.z,s[4]=n.x,s[5]=n.y,s[6]=n.z,s[8]=-r.x,s[9]=-r.y,s[10]=-r.z,s=this.invert(s)}},{key:"invert",value:function(e){var t=new b,a=new b,r=0;a[0]=e[5]*e[10]*e[15]-e[5]*e[11]*e[14]-e[9]*e[6]*e[15]+e[9]*e[7]*e[14]+e[13]*e[6]*e[11]-e[13]*e[7]*e[10],a[4]=-e[4]*e[10]*e[15]+e[4]*e[11]*e[14]+e[8]*e[6]*e[15]-e[8]*e[7]*e[14]-e[12]*e[6]*e[11]+e[12]*e[7]*e[10],a[8]=e[4]*e[9]*e[15]-e[4]*e[11]*e[13]-e[8]*e[5]*e[15]+e[8]*e[7]*e[13]+e[12]*e[5]*e[11]-e[12]*e[7]*e[9],a[12]=-e[4]*e[9]*e[14]+e[4]*e[10]*e[13]+e[8]*e[5]*e[14]-e[8]*e[6]*e[13]-e[12]*e[5]*e[10]+e[12]*e[6]*e[9],a[1]=-e[1]*e[10]*e[15]+e[1]*e[11]*e[14]+e[9]*e[2]*e[15]-e[9]*e[3]*e[14]-e[13]*e[2]*e[11]+e[13]*e[3]*e[10],a[5]=e[0]*e[10]*e[15]-e[0]*e[11]*e[14]-e[8]*e[2]*e[15]+e[8]*e[3]*e[14]+e[12]*e[2]*e[11]-e[12]*e[3]*e[10],a[9]=-e[0]*e[9]*e[15]+e[0]*e[11]*e[13]+e[8]*e[1]*e[15]-e[8]*e[3]*e[13]-e[12]*e[1]*e[11]+e[12]*e[3]*e[9],a[13]=e[0]*e[9]*e[14]-e[0]*e[10]*e[13]-e[8]*e[1]*e[14]+e[8]*e[2]*e[13]+e[12]*e[1]*e[10]-e[12]*e[2]*e[9],a[2]=e[1]*e[6]*e[15]-e[1]*e[7]*e[14]-e[5]*e[2]*e[15]+e[5]*e[3]*e[14]+e[13]*e[2]*e[7]-e[13]*e[3]*e[6],a[6]=-e[0]*e[6]*e[15]+e[0]*e[7]*e[14]+e[4]*e[2]*e[15]-e[4]*e[3]*e[14]-e[12]*e[2]*e[7]+e[12]*e[3]*e[6],a[10]=e[0]*e[5]*e[15]-e[0]*e[7]*e[13]-e[4]*e[1]*e[15]+e[4]*e[3]*e[13]+e[12]*e[1]*e[7]-e[12]*e[3]*e[5],a[14]=-e[0]*e[5]*e[14]+e[0]*e[6]*e[13]+e[4]*e[1]*e[14]-e[4]*e[2]*e[13]-e[12]*e[1]*e[6]+e[12]*e[2]*e[5],a[3]=-e[1]*e[6]*e[11]+e[1]*e[7]*e[10]+e[5]*e[2]*e[11]-e[5]*e[3]*e[10]-e[9]*e[2]*e[7]+e[9]*e[3]*e[6],a[7]=e[0]*e[6]*e[11]-e[0]*e[7]*e[10]-e[4]*e[2]*e[11]+e[4]*e[3]*e[10]+e[8]*e[2]*e[7]-e[8]*e[3]*e[6],a[11]=-e[0]*e[5]*e[11]+e[0]*e[7]*e[9]+e[4]*e[1]*e[11]-e[4]*e[3]*e[9]-e[8]*e[1]*e[7]+e[8]*e[3]*e[5],a[15]=e[0]*e[5]*e[10]-e[0]*e[6]*e[9]-e[4]*e[1]*e[10]+e[4]*e[2]*e[9]+e[8]*e[1]*e[6]-e[8]*e[2]*e[5],r=1/(r=e[0]*a[0]+e[1]*a[4]+e[2]*a[8]+e[3]*a[12]);for(var n=0;n<16;n++)t[n]=a[n]*r;return t}},{key:"rotate",value:function(e,t,a){var r=new b,n=t,o=Math.cos(n),s=Math.sin(n),i=new y(0,0,0);i.x=a.x,i.y=a.y,i.z=a.z;var l=new y(i.x*(1-o),i.y*(1-o),i.z*(1-o));r[0]=o+l.x*i.x,r[1]=l.x*i.y+s*i.z,r[2]=l.x*i.z-s*i.y,r[4]=l.y*i.x-s*i.z,r[5]=o+l.y*i.y,r[6]=l.y*i.z+s*i.x,r[8]=l.z*i.x+s*i.y,r[9]=l.z*i.y-s*i.x,r[10]=o+l.z*i.z;for(var c=new b,u=0;u<16;u++)c[u]=e[u];return c[0]=e[0]*r[0]+e[4]*r[1]+e[8]*r[2],c[1]=e[1]*r[0]+e[5]*r[1]+e[9]*r[2],c[2]=e[2]*r[0]+e[6]*r[1]+e[10]*r[2],c[4]=e[0]*r[4]+e[4]*r[5]+e[8]*r[6],c[5]=e[1]*r[4]+e[5]*r[5]+e[9]*r[6],c[6]=e[2]*r[4]+e[6]*r[5]+e[10]*r[6],c[8]=e[0]*r[8]+e[4]*r[9]+e[8]*r[10],c[9]=e[1]*r[8]+e[5]*r[9]+e[9]*r[10],c[10]=e[2]*r[8]+e[6]*r[9]+e[10]*r[10],c[12]=e[12],c[13]=e[13],c[14]=e[14],c}},{key:"mul",value:function(e,t){for(var a=new b,r=0;r<4;r++)for(var n=0;n<4;n++){a[4*r+n]=0;for(var o=0;o<4;o++)a[4*r+n]+=t[4*r+o]*e[4*o+n]}return a}},{key:"createTransformationMatrix",value:function(t,a,r,n,o,s,i,l,c){var u=new b;return u=e.translate(u,new y(t,a,r)),u=e.rotate(u,n,new y(1,0,0)),u=e.rotate(u,o,new y(0,1,0)),u=e.rotate(u,s,new y(0,0,1)),u=e.scale(u,new y(i,l,c))}},{key:"createViewMatrix",value:function(e){var t=new b;return t=this.lookAt(e.p,e.a,new y(0,1,0)),t=this.translate(t,new y(-e.p.x,-e.p.y,-e.p.z))}},{key:"createBillBoardMatrix",value:function(e){var t=new b;return t=this.lookAt(e.p,e.a,new y(0,1,0)),t=this.translate(t,new y(-e.p.x,-e.p.y,-e.p.z))}},{key:"createProjectionMatrix",value:function(e,t,a,r,n){var o=r/n,s=1/Math.tan(e/2/360*3.14)*o,i=s/o,l=a-t,c=new b;return c[0]=i,c[5]=s,c[10]=-(a+t)/l,c[11]=-1,c[14]=-2*t*a/l,c[15]=0,c}},{key:"ortho",value:function(e,t,a,r,n,o){var s=new b;return s[0]=2/(t-e),s[5]=2/(r-a),s[10]=-2/(o-n),s[12]=-(t+e)/(t-e),s[13]=-(r+a)/(r-a),s[14]=-(o+n)/(o-n),s}},{key:"distance",value:function(e,t){return Math.sqrt(e.x*t.x+e.y*t.y+e.z*t.z)}}]),e}(),w=function e(){Object(l.a)(this,e)};w.vertexShader="precision mediump float;attribute vec2 vertPosition;uniform mat4 projection;uniform mat4 transformation;uniform mat4 view;varying vec2 tex_coords;void main(){vec4 pos =  projection * view * transformation * vec4(vertPosition, 0.0, 1.0);tex_coords = vertPosition * 0.5 + 0.5;tex_coords.y = 1.0-tex_coords.y;gl_Position = pos;}",w.fragmentShader="precision mediump float;uniform sampler2D sampler;uniform float width;uniform float height;uniform float distance;varying vec2 tex_coords;int mod(int a, int b){\treturn a - b * int(a/b);}void main(){vec4 color = vec4(1.0);gl_FragColor = color;}";var k=function e(){Object(l.a)(this,e)};k.vertexShader="precision mediump float;attribute vec3 vertPosition;attribute vec3 normal;attribute mat4 transformation;attribute vec3 color;varying vec2 tex_coords;varying vec3 Normal;varying vec3 fragPos;varying vec3 out_color;uniform mat4 projection;uniform mat4 view;uniform float camera;void main(){gl_Position = projection * view * transformation * vec4(vec3(vertPosition*camera*0.2), 1.0);out_color = color;fragPos = vec3(transformation * vec4(vertPosition, 1.0));Normal = normal;}",k.fragmentShader="precision mediump float;varying vec2 tex_coords;varying vec3 Normal;varying vec3 fragPos;varying vec3 out_color;uniform sampler2D sampler;void main(){vec3 norm = normalize(Normal);vec3 lightDir = normalize(vec3(100) - fragPos);float diff = max(dot(norm, lightDir), 0.0); vec3 diffuse = diff * vec3(1); gl_FragColor = vec4(out_color,1.0);}";var S=function(){function e(t,a){Object(l.a)(this,e),this.vao=a.createVertexArray(),a.bindVertexArray(this.vao),this.vertices=t,this.index=0,this.vbo=this.createVBO(a),this.color_vbo=this.createVBO(a),this.shader=new A(a),this.storeData(0,3,t,a),a.bindVertexArray(null),a.disableVertexAttribArray(0),this.addIntanceAttrib(this.vao,this.vbo,1,4,16,0,a),this.addIntanceAttrib(this.vao,this.vbo,2,4,16,4,a),this.addIntanceAttrib(this.vao,this.vbo,3,4,16,8,a),this.addIntanceAttrib(this.vao,this.vbo,4,4,16,12,a),this.addIntanceAttrib(this.vao,this.color_vbo,5,3,3,0,a),this.drawLines=!1}return Object(c.a)(e,[{key:"render",value:function(e,t,a,r,n){var o=[],s=[];this.index=0,this.colorIndex=0,this.shader.bind(),n.bindVertexArray(this.vao),n.enableVertexAttribArray(0),n.enableVertexAttribArray(1),n.enableVertexAttribArray(2),n.enableVertexAttribArray(3),n.enableVertexAttribArray(4),n.enableVertexAttribArray(5);for(var i=0;i<e.length;i++)this.storeMatrixData(x.createTransformationMatrix(e[i].position.x,e[i].position.y,e[i].position.z,0,0,0,e[i].scale.x,e[i].scale.y,e[i].scale.z),o),this.storeVectorData(e[i].color,s);this.updateVBO(this.vbo,o,n),this.updateVBO(this.color_vbo,s,n),this.drawLines?n.drawArraysInstanced(n.LINES,0,this.vertices.length/2,e.length):n.drawArraysInstanced(n.TRIANGLES,0,this.vertices.length/3,e.length),this.shader.setUniform4fv("view",t),this.shader.setUniform4fv("projection",a),this.shader.setUniform3f("color",1,1,1),this.shader.setUniform("camera",r),n.bindVertexArray(null),n.disableVertexAttribArray(0),n.disableVertexAttribArray(1),n.disableVertexAttribArray(2),n.disableVertexAttribArray(3),n.disableVertexAttribArray(4),n.disableVertexAttribArray(5),this.shader.unBind()}},{key:"createVBO",value:function(e){var t=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,new Float32Array(99999999),e.STREAM_DRAW,0),e.bindBuffer(e.ARRAY_BUFFER,null),t}},{key:"storeVectorData",value:function(e,t){t[this.colorIndex++]=e.x,t[this.colorIndex++]=e.y,t[this.colorIndex++]=e.z}},{key:"storeMatrixData",value:function(e,t){for(var a=0;a<16;a++)t[this.index++]=e[a]}},{key:"storeData",value:function(e,t,a,r){var n=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,n),r.bufferData(r.ARRAY_BUFFER,new Float32Array(a),r.STATIC_DRAW,0),r.vertexAttribPointer(e,t,r.FLOAT,r.FALSE,0,0)}},{key:"addIntanceAttrib",value:function(e,t,a,r,n,o,s){s.bindBuffer(s.ARRAY_BUFFER,t),s.bindVertexArray(e),s.vertexAttribPointer(a,r,s.FLOAT,!1,4*n,4*o),s.vertexAttribDivisor(a,1),s.bindBuffer(s.ARRAY_BUFFER,null),s.bindVertexArray(null)}},{key:"updateVBO",value:function(e,t,a){a.bindBuffer(a.ARRAY_BUFFER,e),a.bufferData(a.ARRAY_BUFFER,new Float32Array(t),a.STREAM_DRAW),a.bufferSubData(a.ARRAY_BUFFER,0,new Float32Array(t)),a.bindBuffer(a.ARRAY_BUFFER,null)}}]),e}(),A=function(){function e(t){Object(l.a)(this,e),this.gl=t;var a=k.vertexShader,r=k.fragmentShader,n=t.createShader(t.VERTEX_SHADER),o=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(n,a),t.shaderSource(o,r),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?(t.compileShader(o),t.getShaderParameter(o,t.COMPILE_STATUS)?(this.program=t.createProgram(),t.attachShader(this.program,n),t.attachShader(this.program,o),t.bindAttribLocation(this.program,0,"vertPosition"),t.bindAttribLocation(this.program,1,"transformation"),t.bindAttribLocation(this.program,5,"color"),t.linkProgram(this.program),t.getProgramParameter(this.program,t.LINK_STATUS)?(t.validateProgram(this.program),t.getProgramParameter(this.program,t.VALIDATE_STATUS)||console.error("ERROR validating program!",t.getProgramInfoLog(this.program))):console.error("ERROR linking program!",t.getProgramInfoLog(this.program))):console.error("ERROR compiling fragment shader!",t.getShaderInfoLog(o))):console.error("ERROR compiling vertex shader!",t.getShaderInfoLog(n))}return Object(c.a)(e,[{key:"bind",value:function(){this.gl.useProgram(this.program)}},{key:"unBind",value:function(){this.gl.useProgram(null)}},{key:"setUniform",value:function(e,t){var a=this.gl.getUniformLocation(this.program,e);-1!=a&&this.gl.uniform1f(a,t)}},{key:"setUniform1i",value:function(e,t){var a=this.gl.getUniformLocation(this.program,e);-1!=a&&this.gl.uniform1i(a,t)}},{key:"setUniform3f",value:function(e,t,a,r){var n=this.gl.getUniformLocation(this.program,e);-1!=n&&this.gl.uniform3f(n,t,a,r)}},{key:"setUniform4fv",value:function(e,t){var a=this.gl.getUniformLocation(this.program,e);-1!=a&&this.gl.uniformMatrix4fv(a,!1,t)}}]),e}(),O=function(){function e(t){Object(l.a)(this,e),this.gl=t,this.shader=new v([0,"vertPosition"],w,t),this.vertices=[-1,1,1,1,-1,-1,1,-1,1,1,-1,-1],this.vertical=[1,0,0,-1,0,0],this.horizontal=[0,0,1,0,0,-1],this.vao=this.gl.createVertexArray(),this.gl.bindVertexArray(this.vao),this.gl.enableVertexAttribArray(0),this.vbo=t.createBuffer(),this.gl.bindBuffer(t.ARRAY_BUFFER,this.vbo),this.gl.bufferData(t.ARRAY_BUFFER,new Float32Array(this.vertical),t.STATIC_DRAW,0),this.gl.vertexAttribPointer(0,2,t.FLOAT,t.FALSE,0,0),this.gl.bindVertexArray(null),this.gl.disableVertexAttribArray(0),this.verticalRenderer=new S(this.vertical,this.gl),this.verticalRenderer.drawLines=!0,this.horizontalRenderer=new S(this.horizontal,this.gl),this.horizontalRenderer.drawLines=!0;var a=function e(t,a,r,n,o,s){Object(l.a)(this,e),this.position=new y(t,a,r),this.scale=new y(n,o,s),this.color=new y(1,1,1)};this.lines=[];for(var r=-100;r<100;r++)this.lines.push(new a(0,0,100*r,10,1,1));for(var n=-100;n<100;n++)this.lines.push(new a(100*n,0,0,1,1,10))}return Object(c.a)(e,[{key:"draw",value:function(e,t,a,r,n,o){var s=100;n>1e3&&(s=5e3),n>200&&n<1e3&&(s=500),n<200&&n>20&&(s=100),n<20&&(s=10),o(s/100+" cm");for(var i=0;i<200;i++)this.lines[i].position.z=s*i/100-s,this.lines[i].scale.x=s/200;for(var l=200;l<400;l++)this.lines[l].position.x=s*(l-200)/100-s,this.lines[l].scale.z=s/200;this.verticalRenderer.render(this.lines,x.createViewMatrix(t),e,1e3,this.gl),this.horizontalRenderer.render(this.lines,x.createViewMatrix(t),e,1e3,this.gl)}}]),e}(),C=function e(){Object(l.a)(this,e)};C.vertexShader="precision mediump float;attribute vec3 vertPosition;attribute vec3 normal;varying vec2 tex_coords;varying vec3 Normal;varying vec3 fragPos;uniform mat4 projection;uniform mat4 transformation;uniform mat4 view;void main(){gl_Position = projection * view * transformation * vec4(vertPosition, 1.0);fragPos = vec3(transformation * vec4(vertPosition, 1.0));Normal = normal;}",C.fragmentShader="precision mediump float;varying vec2 tex_coords;varying vec3 Normal;varying vec3 fragPos;uniform vec3 color;uniform sampler2D sampler;void main(){vec3 norm = normalize(Normal);vec3 lightDir = normalize(vec3(100) - fragPos);float diff = max(dot(norm, lightDir), 0.0); vec3 diffuse = diff * vec3(1); gl_FragColor = vec4((vec3(.1)+diffuse)*color,1.0);}";var j=function(){function e(t,a,r){Object(l.a)(this,e),this.vertices=t,this.normals=a,this.gl=r,this.color=new y(.1,.1,.1),this.drawLines=!0,this.outline=!0,this.position=new y(0,0,0),this.rotation=new y(0,0,0),this.scale=new y(1,1,1),this.vao=r.createVertexArray(),r.bindVertexArray(this.vao),this.vbo=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,this.vbo),r.bufferData(r.ARRAY_BUFFER,new Float32Array(t),r.STATIC_DRAW,0),r.vertexAttribPointer(0,3,r.FLOAT,r.FALSE,0,0),this.nvbo=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,this.nvbo),r.bufferData(r.ARRAY_BUFFER,new Float32Array(this.normals),r.STATIC_DRAW,0),r.vertexAttribPointer(1,3,r.FLOAT,r.FALSE,0,0),r.bindVertexArray(null)}return Object(c.a)(e,[{key:"draw",value:function(){this.drawLines?this.gl.drawArrays(this.gl.LINE_STRIP,0,this.vertices.length/3):this.gl.drawArrays(this.gl.TRIANGLES,0,this.vertices.length/3)}}]),e}(),D=function e(){Object(l.a)(this,e)};D.vertices=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5],D.normals=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0];var z=function(){function e(t){Object(l.a)(this,e),this.shader=new v([[0,"vertPosition"],[1,"normal"]],C,t),this.models=[],this.sources=[],this.detectors=[],this.guns=[],this.particles=[],this.gl=t,this.addModel(new j([1,0,0,-1,0,0],[1,1,1,1,1,1],t)),this.addModel(new j([0,1,0,0,-1,0],[1,1,1,1,1,1],t)),this.addModel(new j([0,0,1,0,0,-1],[1,1,1,1,1,1],t)),this.addModel(new j([0,0,1,0,0,-1],[1,1,1,1,1,1],t)),this.models[0].color=new y(1,0,0),this.models[1].color=new y(0,1,0),this.models[2].color=new y(0,0,1),this.models[3].color=new y(0,0,1),this.drawTracks=!0,this.drawParticles=!0,this.drawAxes=!0}return Object(c.a)(e,[{key:"removeDetector",value:function(e){for(var t=0;t<this.detectors.length;t++)this.detectors[t]==e&&this.detectors.splice(t,1)}},{key:"removeGun",value:function(e){for(var t=0;t<this.guns.length;t++)this.guns[t]==e&&this.guns.splice(t,1)}},{key:"removeSource",value:function(e){for(var t=0;t<this.sources.length;t++)this.sources[t]==e&&this.sources.splice(t,1)}},{key:"addModel",value:function(e){this.models.push(e)}},{key:"addParticles",value:function(e){this.particles.push(e)}},{key:"addGun",value:function(e){this.guns.push(e)}},{key:"addSource",value:function(e){this.sources.push(e)}},{key:"addDetector",value:function(e){this.detectors.push(e)}},{key:"clearTracks",value:function(){this.models=[],this.addModel(new j([1,0,0,-1,0,0],[1,1,1,1,1,1],this.gl)),this.addModel(new j([0,1,0,0,-1,0],[1,1,1,1,1,1],this.gl)),this.addModel(new j([0,0,1,0,0,-1],[1,1,1,1,1,1],this.gl)),this.addModel(new j([0,0,1,0,0,-1],[1,1,1,1,1,1],this.gl)),this.models[0].color=new y(1,0,0),this.models[1].color=new y(0,1,0),this.models[2].color=new y(0,0,1),this.models[3].color=new y(0,0,1)}},{key:"draw",value:function(t,a){this.gl.disable(this.gl.DEPTH_TEST),this.shader.bind();for(var r=0;r<this.detectors.length;r++){this.gl.enable(this.gl.DEPTH_TEST),this.gl.enableVertexAttribArray(0),this.gl.enableVertexAttribArray(1),this.gl.bindVertexArray(this.detectors[r].model.vao);var n=x.createTransformationMatrix(this.detectors[r].model.position.x,this.detectors[r].model.position.y,this.detectors[r].model.position.z,this.detectors[r].model.rotation.x,this.detectors[r].model.rotation.y,this.detectors[r].model.rotation.z,this.detectors[r].model.scale.x,this.detectors[r].model.scale.y,this.detectors[r].model.scale.z);this.shader.setUniform3f("color",this.detectors[r].model.color.x,this.detectors[r].model.color.y,this.detectors[r].model.color.z),this.shader.setUniform1i("sampler",0),this.shader.setUniform4fv("view",x.createViewMatrix(a)),this.shader.setUniform4fv("projection",t),this.shader.setUniform4fv("transformation",n),this.detectors[r].model.draw(),this.gl.disableVertexAttribArray(0),this.gl.disableVertexAttribArray(1)}this.gl.disable(this.gl.DEPTH_TEST);for(var o=0;o<this.detectors.length;o++)if(this.detectors[o].id==e.active_id&&this.detectors[o].id==e.active_id){this.gl.enableVertexAttribArray(0),this.gl.enableVertexAttribArray(1),this.gl.bindVertexArray(this.detectors[o].model.vao);var s=x.createTransformationMatrix(this.detectors[o].model.position.x,this.detectors[o].model.position.y,this.detectors[o].model.position.z,this.detectors[o].model.rotation.x,this.detectors[o].model.rotation.y,this.detectors[o].model.rotation.z,1.01*this.detectors[o].model.scale.x,1.01*this.detectors[o].model.scale.y,1.01*this.detectors[o].model.scale.z);this.shader.setUniform3f("color",1,.4,0),this.shader.setUniform1i("sampler",0),this.shader.setUniform4fv("view",x.createViewMatrix(a)),this.shader.setUniform4fv("projection",t),this.shader.setUniform4fv("transformation",s),this.detectors[o].model.draw(),this.gl.disableVertexAttribArray(0),this.gl.disableVertexAttribArray(1)}for(var i=0;i<this.guns.length;i++){this.gl.enableVertexAttribArray(0),this.gl.enableVertexAttribArray(1),this.gl.bindVertexArray(this.guns[i].model.vao);var l=new y(0,0,0);l.x=Math.atan2(-this.guns[i].direction.y,this.guns[i].direction.z),l.z=Math.atan2(this.guns[i].direction.x,-this.guns[i].direction.y),l.y=Math.atan2(this.guns[i].direction.x,this.guns[i].direction.z);var c=x.createTransformationMatrix(this.guns[i].model.position.x,this.guns[i].model.position.y,this.guns[i].model.position.z,l.x,l.y,l.z,.01*a.d,.01*a.d,.01*a.d);this.shader.setUniform3f("color",this.guns[i].model.color.x,this.guns[i].model.color.y,this.guns[i].model.color.z),this.shader.setUniform1i("sampler",0),this.shader.setUniform4fv("view",x.createViewMatrix(a)),this.shader.setUniform4fv("projection",t),this.shader.setUniform4fv("transformation",c),this.guns[i].model.draw(),this.gl.disableVertexAttribArray(0),this.gl.disableVertexAttribArray(1),console.log(this.guns[i].model.position.x)}this.gl.disable(this.gl.DEPTH_TEST);for(i=0;i<this.sources.length;i++){this.gl.enableVertexAttribArray(0),this.gl.enableVertexAttribArray(1),this.gl.bindVertexArray(this.sources[i].model.vao);var u=x.createTransformationMatrix(this.sources[i].model.position.x,this.sources[i].model.position.y,this.sources[i].model.position.z,this.sources[i].model.rotation.x,this.sources[i].model.rotation.y,this.sources[i].model.rotation.z,.004*a.d,.004*a.d,.004*a.d);this.shader.setUniform3f("color",this.sources[i].model.color.x,this.sources[i].model.color.y,this.sources[i].model.color.z),this.shader.setUniform1i("sampler",0),this.shader.setUniform4fv("view",x.createViewMatrix(a)),this.shader.setUniform4fv("projection",t),this.shader.setUniform4fv("transformation",u),this.sources[i].model.draw(),this.gl.disableVertexAttribArray(0),this.gl.disableVertexAttribArray(1)}if(this.gl.enable(this.gl.DEPTH_TEST),this.gl.disable(this.gl.DEPTH_TEST),this.drawAxes){for(var h=0;h<4;h++){this.gl.enableVertexAttribArray(0),this.gl.enableVertexAttribArray(1),this.gl.bindVertexArray(this.models[h].vao);var d=x.createTransformationMatrix(this.models[h].position.x,this.models[h].position.y,this.models[h].position.z,this.models[h].rotation.x,this.models[h].rotation.y,this.models[h].rotation.z,a.d,a.d,a.d);this.shader.setUniform3f("color",this.models[h].color.x,this.models[h].color.y,this.models[h].color.z),this.shader.setUniform1i("sampler",0),this.shader.setUniform4fv("view",x.createViewMatrix(a)),this.shader.setUniform4fv("projection",t),this.shader.setUniform4fv("transformation",d),this.models[h].draw(),this.gl.disableVertexAttribArray(0),this.gl.disableVertexAttribArray(1)}console.log(this.drawAxes)}if(this.drawTracks){for(var m=3;m<this.models.length;m++){this.gl.enableVertexAttribArray(0),this.gl.enableVertexAttribArray(1),this.gl.bindVertexArray(this.models[m].vao);var p=x.createTransformationMatrix(this.models[m].position.x,this.models[m].position.y,this.models[m].position.z,this.models[m].rotation.x,this.models[m].rotation.y,this.models[m].rotation.z,this.models[m].scale.x,this.models[m].scale.y,this.models[m].scale.z);this.shader.setUniform3f("color",this.models[m].color.x,this.models[m].color.y,this.models[m].color.z),this.shader.setUniform1i("sampler",0),this.shader.setUniform4fv("view",x.createViewMatrix(a)),this.shader.setUniform4fv("projection",t),this.shader.setUniform4fv("transformation",p),this.models[m].draw(),this.gl.disableVertexAttribArray(0),this.gl.disableVertexAttribArray(1)}this.shader.unBind()}else this.shader.unBind()}}]),e}();z.active_id=-1;var R=z,M=(a(198),function(){function e(t){Object(l.a)(this,e),this.model=t,this.material="Pb",this.active=!1,this.deposit=0,this.name="",this.id=0,this.hits=[],this.numberOfHits=[]}return Object(c.a)(e,[{key:"contains",value:function(e){for(var t=0;t<this.hits.length;t++)if(e==this.hits[t])return!0;return!1}},{key:"clearDeposit",value:function(){this.hits=[],this.numberOfHits=[]}},{key:"sort",value:function(){for(var e=[],t=0;t<this.hits.length;t++)e.push({hit:this.hits[t],no:this.numberOfHits[t]});e.sort((function(e,t){return e.hit<t.hit?-1:e.hit==t.hit?0:1}));for(var a=0;a<e.length;a++)this.hits[a]=e[a].hit,this.numberOfHits[a]=e[a].no}},{key:"getIndex",value:function(e){for(var t=0;t<this.hits.length;t++)if(0==Math.abs(e-this.hits[t]))return t;return-1}}]),e}()),T=function e(t,a,r,n){Object(l.a)(this,e),this.position=a,this.direction=r,this.energy=n,this.model=t,this.name="Particle Gun"},P=function e(){Object(l.a)(this,e)};P.vertices=[-1,-1,-1,0,0,1,0,0,1,-1,-1,-1,0,0,1,-1,1,-1,-1,1,-1,0,0,1,0,0,1,-1,1,-1,0,0,1,1,1,-1,1,1,-1,0,0,1,0,0,1,1,1,-1,0,0,1,1,-1,-1,1,-1,-1,0,0,1,0,0,1,1,-1,-1,0,0,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,1,-1,-1,-1,-1,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1],P.normals=[0,0,0,0,0,0,0,0,0,-.8944271802902222,0,.4472135901451111,-.8944271802902222,0,.4472135901451111,-.8944271802902222,0,.4472135901451111,0,0,0,0,0,0,0,0,0,0,.8944271802902222,.4472135901451111,0,.8944271802902222,.4472135901451111,0,.8944271802902222,.4472135901451111,0,0,0,0,0,0,0,0,0,.8944271802902222,0,.4472135901451111,.8944271802902222,0,.4472135901451111,.8944271802902222,0,.4472135901451111,0,0,0,0,0,0,0,0,0,0,-.8944271802902222,.4472135901451111,0,-.8944271802902222,.4472135901451111,0,-.8944271802902222,.4472135901451111,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var L=function e(t,a,r){Object(l.a)(this,e),this.position=a,this.name="Particle Source",this.scale=new y(1,1,1),this.material=r,this.model=t,this.model.color=new y(0,1,0),this.active=!1,this.id=0},F=function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,null,[{key:"parseData",value:function(e){function t(e,t){var a=new Uint8Array([e.charCodeAt(t),e.charCodeAt(t+1),e.charCodeAt(t+2),e.charCodeAt(t+3)]);return new Float32Array(a.buffer)[0]}for(var a=[],r=[],n=function(e,t){var a=new Uint8Array([e.charCodeAt(t),e.charCodeAt(t+1),e.charCodeAt(t+2),e.charCodeAt(t+3)]);return new Int32Array(a.buffer)[0]}(e,80),o=0;o<n;o++)for(var s=0;s<9;s++)a.push(t(e,96+4*s+50*o));for(o=0;o<n;o++){for(s=0;s<3;s++)r.push(t(e,84+4*s+50*o));for(s=0;s<3;s++)r.push(t(e,84+4*s+50*o));for(s=0;s<3;s++)r.push(t(e,84+4*s+50*o))}var i=new N;return i.vertices=a,i.normals=r,i}}]),e}(),N=function e(){Object(l.a)(this,e),this.vertices=[],this.normals=[]},V=F,B=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={hint:" "},n.canvas=Object(r.createRef)(),n.camera=new E(10,10,100,new y(0,0,0),new y(0,0,0)),n.oldX=0,n.oldY=0,n.move=!1,n.x=0,n.y=0,n.keyDown=" ".concat(0),n.down=!1,n.renderer=null,n.instanceRenderer=null,n.particles=[],n.drawTracks=!1,n.drawParticles=!0,n.drawGrid=!1,n.gl=null,n.updateHint=n.updateHint.bind(Object(u.a)(n)),n}return Object(c.a)(a,[{key:"updateHint",value:function(e){this.setState({hint:e})}},{key:"setShowTracks",value:function(e){this.renderer.drawTracks=e}},{key:"setShowAxes",value:function(e){this.renderer.drawAxes=e}},{key:"getMouseXd",value:function(){return this.oldX-this.x}},{key:"getMouseYd",value:function(){return this.oldY-this.y}},{key:"clearRun",value:function(){this.particles=[],this.renderer.clearTracks()}},{key:"componentDidMount",value:function(){var e=this;this.gl=this.canvas.current.getContext("webgl2");var t=new O(this.gl);this.renderer=new R(this.gl),this.instanceRenderer=new S(D.vertices,this.gl);requestAnimationFrame((function a(){.001,e.gl.clearColor(.2,.2,.2,1),e.gl.clear(e.gl.COLOR_BUFFER_BIT);var r,n=x.createProjectionMatrix(70,.1*e.camera.d,1e3*e.camera.d,e.canvas.current.offsetWidth,e.canvas.current.offsetHeight);e.down&&e.move&&(17===e.keyDown?(e.camera.a.y-=.01*e.getMouseYd()*e.camera.d*((89-Math.abs(e.camera.y))/89)*.01,e.camera.a.x-=Math.cos(e.camera.x/(180/Math.PI))*e.getMouseXd()*.01*e.camera.d*((89-Math.abs(e.camera.y))/89)*.01,e.camera.a.z+=Math.sin(e.camera.x/(180/Math.PI))*e.getMouseXd()*.01*e.camera.d*((89-Math.abs(e.camera.y))/89)*.01,e.camera.a.x-=.01*(Math.cos(e.camera.x/(180/Math.PI))*e.getMouseXd()*.01*e.camera.d+Math.sin(e.camera.x/(180/Math.PI))*e.getMouseYd()*.01*e.camera.d),e.camera.a.z-=.01*(Math.cos(e.camera.x/(180/Math.PI))*e.getMouseYd()*.01*e.camera.d+Math.sin(e.camera.x/(180/Math.PI))*-e.getMouseXd()*.01*e.camera.d)):(e.camera.x+=e.getMouseXd()/2,e.camera.y+=e.getMouseYd()/2)),e.drawGrid&&t.draw(n,e.camera,e.canvas.current.offsetWidth,e.canvas.current.offsetHeight,e.camera.d,e.updateHint),e.renderer.draw(n,e.camera),e.drawParticles&&e.instanceRenderer.render(e.particles,x.createViewMatrix(e.camera),n,e.camera.d,e.gl),(r=e.camera).y>89&&(r.y=89),r.y<-89&&(r.y=-89),r.p.x=r.d*-Math.sin(r.x*Math.PI/180)*Math.cos(r.y*Math.PI/180)+r.a.x,r.p.y=r.d*-Math.sin(r.y*Math.PI/180)+r.a.y,r.p.z=-r.d*Math.cos(r.x*Math.PI/180)*Math.cos(r.y*Math.PI/180)+r.a.z,e.move=!1,requestAnimationFrame(a)}))}},{key:"addSource",value:function(e,t,a,r){var n=new L(new j(D.vertices,D.normals,this.gl),new y(e,t,a),r);return n.model.drawLines=!1,n.model.position=new y(e,t,a),this.renderer.addSource(n),n}},{key:"addParticle",value:function(e){this.particles.push(e)}},{key:"addSTLDetector",value:function(e,t,a,r,n,o,s,i,l,c,u){var h=new M(new j(u.vertices,u.normals,this.gl));return h.model.drawLines=!1,h.model.color=new y(1,1,1),h.model.position.x=e,h.model.position.y=t,h.model.position.z=a,h.model.rotation.x=r,h.model.rotation.y=n,h.model.rotation.z=o,h.model.scale.x=s,h.model.scale.y=i,h.model.scale.z=l,h.material=c,this.renderer.addDetector(h),h}},{key:"addDetector",value:function(){var e=Object(g.a)(p.a.mark((function e(t,a,r,n,o,s,i,l,c,u,h){var d,m,g,v,f,b,E,x=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=null,m=function(){d.model.drawLines=!1,d.model.color=new y(1,1,1),d.model.position.x=t,d.model.position.y=a,d.model.position.z=r,d.model.rotation.x=n,d.model.rotation.y=o,d.model.rotation.z=s,d.model.scale.x=i,d.model.scale.y=l,d.model.scale.z=c,d.material=u,x.renderer.addDetector(d)},e.next=4,fetch("http://localhost/database",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({name:h})});case 4:return g=e.sent,e.next=7,g.json();case 7:for(v=e.sent,new String(v[0].data.data),f="",b=0;b<v[0].data.data.length;b++)f+=String.fromCharCode(v[0].data.data[b]);return E=V.parseData(f),d=new M(new j(E.vertices,E.normals,this.gl)),m(),e.abrupt("return",d);case 15:case"end":return e.stop()}}),e,this)})));return function(t,a,r,n,o,s,i,l,c,u,h){return e.apply(this,arguments)}}()},{key:"addModel",value:function(e,t){var a=new j(e,t,this.gl);return this.renderer.addModel(a),a}},{key:"addGun",value:function(e,t,a,r,n,o,s){var i=new j(P.vertices,P.normals,this.gl);i.drawLines=!1;var l=new T(i,new y(e,t,a),new y(r,n,o),s);return l.model.position=new y(e,t,a),this.renderer.addGun(l),l}},{key:"removeSource",value:function(e){this.renderer.removeSource(e)}},{key:"removeDetector",value:function(e){this.renderer.removeDetector(e)}},{key:"removeGun",value:function(e){this.renderer.removeGun(e)}},{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement("p",{ref:this.hint,style:{position:"fixed",bottom:"10%",left:"20%","z-index":"4",color:"white"}},this.state.hint),n.a.createElement("canvas",{ref:this.canvas,onMouseMove:function(t){e.move=!0,e.oldX=e.x,e.oldY=e.y,e.x=t.pageX,e.y=t.pageY},tabIndex:"0",width:"2000",height:"2000",style:{position:"fixed",right:0,left:0,width:"100%",height:"100%"},onKeyDown:function(t){e.keyDown=t.keyCode},onKeyUp:function(t){e.keyDown=" ".concat(0)},onMouseDown:function(){e.down=!0},onMouseUp:function(){e.down=!1},onWheel:function(t){var a=0;a=t.deltaY>0?1:-1,e.camera.d+=e.camera.d/(100*a)*10}}))}}]),a}(r.Component),U=a(493),I=a(494),G=a(190),H=a(505),q=a(501),Y=a(502),_=(a(27),a(506)),X=a(188),K=(a(128),a(498)),W=a(499),Q=function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,null,[{key:"check",value:function(t){for(var a=0;a<e.materials.length;a++)if(t==e.materials[a])return!0;return!1}}]),e}();Q.materials=["H","He","Li","Be","B","C","N","O","F","Ne","Na","Mg","Al","Si","P","S","Cl","Ar","K","Ca","Sc","Ti","V","Cr","Mn","Fe","Co","Ni","Cu","Zn","Ga","Ge","As","Se","Br","Kr","Rb","Sr","Y","Zr","Nb","Mo","Tc","Ru","Rh","Pd","Ag","Cd","In","Sn","Sb","Te","I","Xe","Cs","Ba","La","Ce","Pr","Nd","Pm","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu","Hf","Ta","W","Re","Os","Ir","Pt","Au","Hg","Tl","Pb","Bi","Po","At","Rn","Fr","Ra","Ac","Th","Pa","U","Np","Pu","Am","Cm","Bk","Cf","Es","Fm","Md","No","Lr","Rf","Db","Sg","Bh","Hs","Mt","Ds","Rg","Cn","Nh","Fl","Mc","Lv","Ts","Og"];var J=Q,Z=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).showDialog=r.showDialog.bind(Object(u.a)(r)),r.hideDialog=r.hideDialog.bind(Object(u.a)(r)),r.state={show:!1},r}return Object(c.a)(a,[{key:"componentDidMount",value:function(){}},{key:"showDialog",value:function(){this.setState({show:!0})}},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e=this;return n.a.createElement(n.a.Fragment,null,n.a.createElement(K.a,{show:this.state.show,onHide:function(){e.hideDialog()}},n.a.createElement(K.a.Header,{closeButton:!0},n.a.createElement(K.a.Title,null,this.props.title)),n.a.createElement(K.a.Body,null,this.props.content),n.a.createElement(K.a.Footer,null,n.a.createElement(X.a,{variant:"secondary",onClick:function(){e.hideDialog()}},"No"),n.a.createElement(X.a,{variant:"primary",onClick:function(){e.props.fun(),e.hideDialog()}},"Yes"))))}}]),a}(r.Component),$=function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,null,[{key:"checkString",value:function(e){return(e=e.trim()).split('"').length%2!=0&&('"'==e[0]&&'"'==e[e.length-1])}},{key:"removeChunk",value:function(t){for(var a=" ",r=0;r<e.chunks.length;r++)if(e.chunks[r].id==t){e.chunks.splice(r,1);break}alert(t);for(var n=0;n<e.chunks.length;n++)alert(e.chunks[n].code),alert(e.chunks[n].id),a+=e.chunks[n].code;return a}},{key:"checkFloat",value:function(e,t,a){return!isNaN(parseFloat(e.split(",")[0]))&&(!isNaN(parseFloat(e.split(",")[1]))&&(!isNaN(parseFloat(e.split(",")[2]))&&(t.x=parseFloat(e.split(",")[0])*a,t.y=parseFloat(e.split(",")[1])*a,t.z=parseFloat(e.split(",")[2])*a,!0)))}},{key:"parse",value:function(e,t,a,r,n,o){this.detectors=[],this.sources=[];var s=t.gl,i=e.split("\\");a();for(var l=0;l<i.length;l++){var c=i[l].split("{");c[0]=c[0].replace(" ","");var u=null,h=null,d=null;"Detector"==c[0]&&(u=new M(new j(D.vertices,D.normals,s))),"Source"==c[0]&&(h=new L(new j(D.vertices,D.normals,s),new y(0,0,0),"U235")),"Gun"==c[0]&&(d=new T(new j(D.vertices,D.normals,s),new y(0,0,0),new y(0,0,0),0));for(var m=0;m<c.length;m++)for(var p=c[m].split(";"),g=0;g<p.length;g++)if(p[g].split("(")[0].trim(),1!=p[g].split(":").length){var v=p[g].split(":")[0].trim(),f=1;switch(v.substring(v.indexOf("[")+1,v.indexOf("]"))){case"eV":f=.001;break;case"keV":f=1;break;case"MeV":f=1e3;break;case"GeV":f=1e6;break;case"mm":f=.1;break;case"deg":f=.0174527777777778;break;case"rad":case"cm":f=1;break;case"dm":f=10;break;case"m":f=100;break;default:f=1}v.includes("[")&&(v=v.substr(0,v.indexOf("[")));var b=p[g].split(":")[1].replace(/\n/g,"");if("Detector"==c[0])switch(v){case"position":this.checkFloat(b,u.model.position,f)||alert("position incorrec format");break;case"rotation":this.checkFloat(b,u.model.rotation,f)||alert("rotation incorrec format");break;case"scale":this.checkFloat(b,u.model.scale,f)||alert("scale incorrec format");break;case"material":this.checkString(b)||alert("meterial incorrect format"),u.material=b.trim().substring(1,b.trim().length-1);break;case"name":this.checkString(b)||alert("name incorrect format"),u.name=b.trim().substring(1,b.trim().length-1);break;default:alert("No such property: "+v)}if("Source"==c[0])switch(v){case"position":this.checkFloat(b,h.model.position,f)||alert("position incorrec format");break;case"material":this.checkString(b)||alert("material incorrect format"),h.material=b.trim().substring(1,b.trim().length-1);break;case"name":this.checkString(b)||alert("name incorrect format"),h.name=b.trim().substring(1,b.trim().length-1);break;default:alert("No such property: "+v)}if("Gun"==c[0])switch(v){case"position":this.checkFloat(b,d.model.position,f)||alert("position incorrec format");break;case"direction":this.checkFloat(b,d.direction,f)||alert("direction incorrec format");break;case"energy":alert(f),d.energy=parseFloat(b)*f;break;case"name":this.checkString(b)||alert("name incorrect format"),d.name=b.trim().substring(1,b.trim().length-1);break;default:alert("No such property: "+v)}}null!=d&&o(d.name,d.model.position.x,d.model.position.y,d.model.position.z,d.direction.x,d.direction.y,d.direction.z,d.energy,!1),null!=h&&n(h.name,h.model.position.x,h.model.position.y,h.model.position.z,h.material,!1),null!=u&&r(u.name,u.model.position.x,u.model.position.y,u.model.position.z,u.model.rotation.x,u.model.rotation.y,u.model.rotation.z,u.model.scale.x,u.model.scale.y,u.model.scale.z,u.material,"cube",D.vertices,new y(.5,.5,.5),!1)}}}]),e}();$.chunks=[];var ee=$,te=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).showDialog=r.showDialog.bind(Object(u.a)(r)),r.hideDialog=r.hideDialog.bind(Object(u.a)(r)),r.confirmDialog=n.a.createRef(),r.state={show:!1,detname:r.props.detector.name,detposx:r.props.detector.model.position.x,detposy:r.props.detector.model.position.y,detposz:r.props.detector.model.position.z,detrotx:r.props.detector.model.rotation.x,detroty:r.props.detector.model.rotation.y,detrotz:r.props.detector.model.rotation.z,detscalex:r.props.detector.model.scale.x,detscaley:r.props.detector.model.scale.y,detscalez:r.props.detector.model.scale.z,detmat:r.props.detector.material,showError:"none",color:r.props.detector.model.color},r.materials=[],r}return Object(c.a)(a,[{key:"hexToRgb",value:function(e){e=e.substr(1);var t=parseInt(e,16);return new y((t>>16&255)/255,(t>>8&255)/255,(255&t)/255)}},{key:"componentDidMount",value:function(){}},{key:"showDialog",value:function(){this.setState({show:!0}),this.setState({showError:"none"})}},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e,t,a,r,o,s,l,c,u,h,d=this;return n.a.createElement(n.a.Fragment,null,n.a.createElement(Z,{ref:this.confirmDialog,title:"Confirm",content:"Are you sure you want to delete this component?",fun:function(){d.hideDialog(),d.props.removebutton(d.props.detector,d.props.button)}}),n.a.createElement(K.a,{show:this.state.show,onHide:function(){d.hideDialog()}},n.a.createElement(K.a.Header,{closeButton:!0},n.a.createElement(K.a.Title,null,"Modify Detector")),n.a.createElement(K.a.Body,null,n.a.createElement(W.a,null,n.a.createElement(U.a,null,n.a.createElement(I.a,null,"Name ",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,{className:"name",required:!0,type:"text",maxLength:"10",value:this.state.detname,onChange:function(e){d.setState({detname:e.target.value})}}))),n.a.createElement("hr",null),n.a.createElement(I.a,null,"Position"),n.a.createElement(I.a,null,"x",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(e={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(e,"value",this.state.detposx),Object(i.a)(e,"onChange",(function(e){d.setState({detposx:e.target.value})})),e))),"y",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(t={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(t,"value",this.state.detposy),Object(i.a)(t,"onChange",(function(e){d.setState({detposy:e.target.value})})),t))),"z",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(a={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(a,"value",this.state.detposz),Object(i.a)(a,"onChange",(function(e){d.setState({detposz:e.target.value})})),a)))),n.a.createElement("br",null),n.a.createElement("hr",null),n.a.createElement(I.a,null,"Rotation"),n.a.createElement(I.a,null,"x",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(r={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(r,"value",this.state.detrotx),Object(i.a)(r,"onChange",(function(e){d.setState({detrotx:e.target.value})})),r))),"y",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(o={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(o,"value",this.state.detroty),Object(i.a)(o,"onChange",(function(e){d.setState({detroty:e.target.value})})),o))),"z",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(s={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(s,"value",this.state.detrotz),Object(i.a)(s,"onChange",(function(e){d.setState({detrotz:e.target.value})})),s)))),n.a.createElement("br",null),n.a.createElement("hr",null),n.a.createElement(I.a,null,"Scale"),n.a.createElement(I.a,null,"x",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(l={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(l,"value",this.state.detscalex),Object(i.a)(l,"onChange",(function(e){d.setState({detscalex:e.target.value})})),l))),"y",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(c={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(c,"value",this.state.detscaley),Object(i.a)(c,"onChange",(function(e){d.setState({detscaley:e.target.value})})),c))),"z",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(u={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(u,"value",this.state.detscalez),Object(i.a)(u,"onChange",(function(e){d.setState({detscalez:e.target.value})})),u)))),n.a.createElement("br",null),n.a.createElement("hr",null),n.a.createElement(I.a,null,n.a.createElement(W.a.Group,{controlId:"exampleForm.SelectCustom"},n.a.createElement(W.a.Label,null,"Material"),n.a.createElement(W.a.Control,(h={className:"material",required:!0,value:"0",type:"text",maxLength:"10"},Object(i.a)(h,"value",this.state.detmat),Object(i.a)(h,"onChange",(function(e){d.setState({detmat:e.target.value})})),h))),n.a.createElement("span",{style:{display:this.state.showError,color:"red","font-weight":"bold"}},"No such material")),n.a.createElement("hr",null),n.a.createElement(I.a,null,"Color: ",n.a.createElement("span",{style:{"padding-left":"20px"}},n.a.createElement("input",{type:"color",onInput:function(e){d.setState({color:d.hexToRgb(e.target.value)})}})))))),n.a.createElement(K.a.Footer,null,n.a.createElement(X.a,{variant:"secondary",onClick:function(){d.confirmDialog.current.showDialog()},style:{backgroundColor:"red",color:"white"}},"Delete"),n.a.createElement(X.a,{variant:"primary",onClick:function(){if(J.check(d.state.detmat)){d.hideDialog(),d.props.detector.model.position.x=d.state.detposx,d.props.detector.model.position.y=d.state.detposy,d.props.detector.model.position.z=d.state.detposz,d.props.detector.model.rotation.x=d.state.detrotx,d.props.detector.model.rotation.y=d.state.detroty,d.props.detector.model.rotation.z=d.state.detrotz,d.props.detector.model.scale.x=d.state.detscalex,d.props.detector.model.scale.y=d.state.detscaley,d.props.detector.model.scale.z=d.state.detscalez,d.props.detector.material=d.state.detmat,d.props.detector.model.color=d.state.color;for(var e="",t=0;t<ee.chunks.length;t++)d.props.buttonid==ee.chunks[t].id&&(ee.chunks[t].code='\\Detector{\n\tname: "'+d.props.name+'";\n\tposition[cm]: '+d.state.detposx+", "+d.state.detposy+", "+d.state.detposz+";\n\trotation[rad]: "+d.state.detrotx+", "+d.state.detroty+", "+d.state.detrotz+";\n\tscale[cm]: "+d.state.detscalex+", "+d.state.detscaley+", "+d.state.detscalez+';\n\tmaterial: "'+d.state.detmat+'";\n}\n'),e+=ee.chunks[t].code;d.props.codeeditor.current.updateText(e),d.props.updatedetails(n.a.createElement(n.a.Fragment,null,n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Position: ")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"x: ",d.state.detposx," cm"),n.a.createElement(G.a,null,"y: ",d.state.detposy," cm"),n.a.createElement(G.a,null,"z: ",d.state.detposz," cm")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Rotation: ")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"x: ",d.state.detrotx," deg"),n.a.createElement(G.a,null,"y: ",d.state.detroty," deg"),n.a.createElement(G.a,null,"z: ",d.state.detrotz," deg")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Scale: ")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"x: ",d.state.detscalex),n.a.createElement(G.a,null,"y: ",d.state.detscaley),n.a.createElement(G.a,null,"z: ",d.state.detscalez)),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Material: ")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,d.state.detmat))))}else d.setState({showError:"block"})}},"Modify"))))}}]),a}(r.Component);te.id=0;var ae=te,re=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).editdialog=n.a.createRef(),r.updateDetails=r.updateDetails.bind(Object(u.a)(r)),r.state={details:r.props.details},r.id=r.props.id,r}return Object(c.a)(a,[{key:"componentDidMount",value:function(){}},{key:"updateDetails",value:function(e){this.setState({details:e})}},{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement(ae,{name:this.props.name,buttonid:this.id,codeeditor:this.props.codeeditor,updatedetails:this.updateDetails,button:this,removebutton:this.props.removebutton,detector:this.props.detector,ref:this.editdialog,buttons:this.props.buttons,details:this.props.details}),n.a.createElement(_.a,{className:"button"},n.a.createElement(_.a.Header,null,n.a.createElement(Y.a.Toggle,{as:X.a,onClick:function(){R.active_id!=e.props.detector.id?R.active_id=e.props.detector.id:R.active_id=-1},variant:"link",eventKey:this.id},this.props.name),n.a.createElement(X.a,{onClick:function(){e.editdialog.current.showDialog()},className:"editButton"},"EDIT")),n.a.createElement(Y.a.Collapse,{eventKey:this.id},n.a.createElement(_.a.Body,null,this.state.details))))}}]),a}(r.Component);re.id=0;var ne=re,oe=a(503),se=a(500),ie=a(504),le=a(497),ce=a(189),ue=a(495),he=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).showDialog=r.showDialog.bind(Object(u.a)(r)),r.hideDialog=r.hideDialog.bind(Object(u.a)(r)),r.state={show:!1},r}return Object(c.a)(a,[{key:"componentDidMount",value:function(){}},{key:"showDialog",value:function(){this.setState({show:!0})}},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"render",value:function(){for(var e=this,t=[],a=0;a<20;a++){for(var r=[],o=Math.floor(a/20*J.materials.length);o<Math.floor((a+1)/20*J.materials.length);o++)r.push(n.a.createElement("th",{style:{border:"gray solid 1px","text-align":"center"}},J.materials[o]));t.push(n.a.createElement("tr",null,r))}return n.a.createElement(n.a.Fragment,null,n.a.createElement(K.a,{show:this.state.show,onHide:function(){e.hideDialog()}},n.a.createElement(K.a.Header,{closeButton:!0},n.a.createElement(K.a.Title,null,"Choose a material")),n.a.createElement(K.a.Body,null,n.a.createElement(ue.a,{style:{margin:"auto"}},n.a.createElement("tbody",null,t))),n.a.createElement(K.a.Footer,null)))}}]),a}(r.Component),de=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).showDialog=r.showDialog.bind(Object(u.a)(r)),r.hideDialog=r.hideDialog.bind(Object(u.a)(r)),r.table=n.a.createRef(),r.state={show:!1,detname:"Detector",detposx:0,detposy:0,detposz:0,detrotx:0,detroty:0,detrotz:0,detscalex:10,detscaley:10,detscalez:10,detmat:"Pb",geomrty:"cube",display:"none",filelabel:"Path to STL",modeldata:null,showError:"none",color:new y(.5,.5,.5),options:[]},r}return Object(c.a)(a,[{key:"componentDidMount",value:function(){}},{key:"hexToRgb",value:function(e){e=e.substr(1);var t=parseInt(e,16);return new y((t>>16&255)/255,(t>>8&255)/255,(255&t)/255)}},{key:"addMaterial",value:function(e,t){this.materials.push(n.a.createElement("option",{value:e},t))}},{key:"showDialog",value:function(){var e=Object(g.a)(p.a.mark((function e(){var t,a,r,o,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({show:!0}),t="Detector"+this.props.buttons.length,this.setState({detname:t}),e.next=5,fetch("http://localhost/database",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({name:""})});case 5:return a=e.sent,e.next=8,a.json();case 8:for(r=e.sent,o=[],s=0;s<r.length;s++)o.push(n.a.createElement("option",{value:r[s].name},r[s].name));this.setState({options:o});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e,t,a,r,o,s,l,c,u,h,d=this;return n.a.createElement(n.a.Fragment,null,n.a.createElement(he,{ref:this.table}),n.a.createElement(K.a,{show:this.state.show,onHide:function(){d.hideDialog()}},n.a.createElement(K.a.Header,{closeButton:!0},n.a.createElement(K.a.Title,null,"Create detector")),n.a.createElement(K.a.Body,null,n.a.createElement(W.a,null,n.a.createElement(U.a,null,n.a.createElement(I.a,null,"Name ",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,{className:"name",required:!0,type:"text",maxLength:"10",value:this.state.detname,onChange:function(e){d.setState({detname:e.target.value})}}))),n.a.createElement("hr",null),n.a.createElement(I.a,null,"Geometry"),n.a.createElement(W.a.Control,{as:"select",value:this.state.geomrty,onChange:function(e){d.setState({geomrty:e.target.value}),"stl"==e.target.value?d.setState({display:"block"}):d.setState({display:"none"})}},this.state.options,n.a.createElement("option",{value:"stl"},"Custom (.STL)")),n.a.createElement(W.a.File,{style:{display:this.state.display},id:"stl-file",label:this.state.filelabel,"data-browse":"Open",custom:!0,onChange:function(e){var t=new FileReader;t.onload=function(){var e=t.result;d.setState({modeldata:e})},t.readAsBinaryString(e.target.files[0]);var a=e.target.value;a=a.split("\\")[a.split("\\").length-1],d.setState({filelabel:a})}}),n.a.createElement("hr",null),n.a.createElement(I.a,null,"Position"),n.a.createElement(I.a,null,"x",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(e={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(e,"value",this.state.detposx),Object(i.a)(e,"onChange",(function(e){d.setState({detposx:e.target.value})})),e))),"y",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(t={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(t,"value",this.state.detposy),Object(i.a)(t,"onChange",(function(e){d.setState({detposy:e.target.value})})),t))),"z",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(a={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(a,"value",this.state.detposz),Object(i.a)(a,"onChange",(function(e){d.setState({detposz:e.target.value})})),a)))),n.a.createElement("br",null),n.a.createElement("hr",null),n.a.createElement(I.a,null,"Rotation"),n.a.createElement(I.a,null,"x",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(r={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(r,"value",this.state.detrotx),Object(i.a)(r,"onChange",(function(e){d.setState({detrotx:e.target.value})})),r))),"y",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(o={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(o,"value",this.state.detroty),Object(i.a)(o,"onChange",(function(e){d.setState({detroty:e.target.value})})),o))),"z",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(s={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(s,"value",this.state.detrotz),Object(i.a)(s,"onChange",(function(e){d.setState({detrotz:e.target.value})})),s)))),n.a.createElement("br",null),n.a.createElement("hr",null),n.a.createElement(I.a,null,"Scale"),n.a.createElement(I.a,null,"x",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(l={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(l,"value",this.state.detscalex),Object(i.a)(l,"onChange",(function(e){d.setState({detscalex:e.target.value})})),l))),"y",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(c={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(c,"value",this.state.detscaley),Object(i.a)(c,"onChange",(function(e){d.setState({detscaley:e.target.value})})),c))),"z",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(u={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(u,"value",this.state.detscalez),Object(i.a)(u,"onChange",(function(e){d.setState({detscalez:e.target.value})})),u)))),n.a.createElement("br",null),n.a.createElement("hr",null),n.a.createElement(I.a,null,n.a.createElement(W.a.Group,{controlId:"exampleForm.SelectCustom"},n.a.createElement(X.a,{onClick:function(){d.table.current.showDialog()}}),n.a.createElement(W.a.Label,null,"Material"),n.a.createElement(W.a.Control,(h={className:"material",required:!0,value:"0",type:"text",maxLength:"10"},Object(i.a)(h,"value",this.state.detmat),Object(i.a)(h,"onChange",(function(e){d.setState({detmat:e.target.value})})),h))),n.a.createElement("span",{style:{display:this.state.showError,color:"red","font-weight":"bold"}},"No such material")),n.a.createElement("hr",null),n.a.createElement(I.a,null,"Color: ",n.a.createElement("span",{style:{"padding-left":"20px"}},n.a.createElement("input",{type:"color",onInput:function(e){d.setState({color:d.hexToRgb(e.target.value)})}})))))),n.a.createElement(K.a.Footer,null,n.a.createElement(X.a,{variant:"secondary",onClick:function(){d.hideDialog()}},"Cancel"),n.a.createElement(X.a,{variant:"primary",onClick:function(){J.check(d.state.detmat)?(d.hideDialog(),d.props.createbutton(d.state.detname,d.state.detposx,d.state.detposy,d.state.detposz,d.state.detrotx,d.state.detroty,d.state.detrotz,d.state.detscalex,d.state.detscaley,d.state.detscalez,d.state.detmat,d.state.geomrty,d.state.modeldata,d.state.color)):d.setState({showError:"block"})}},"Create"))))}}]),a}(r.Component);de.id=0;var me=de,pe=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).showDialog=r.showDialog.bind(Object(u.a)(r)),r.hideDialog=r.hideDialog.bind(Object(u.a)(r)),r.confirmDialog=n.a.createRef(),r.state={show:!1,detname:r.props.detector.name,detposx:r.props.detector.model.position.x,detposy:r.props.detector.model.position.y,detposz:r.props.detector.model.position.z,detdirx:r.props.detector.direction.x,detdiry:r.props.detector.direction.y,detdirz:r.props.detector.direction.z,energy:r.props.detector.energy},r}return Object(c.a)(a,[{key:"componentDidMount",value:function(){}},{key:"showDialog",value:function(){this.setState({show:!0})}},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e,t,a,r,o,s,l,c=this;return n.a.createElement(n.a.Fragment,null,n.a.createElement(Z,{ref:this.confirmDialog,title:"Confirm",content:"Are you sure you want to delete this component?",fun:function(){c.hideDialog(),c.props.removebutton(c.props.detector,c.props.button)}}),n.a.createElement(K.a,{show:this.state.show,onHide:function(){c.hideDialog()}},n.a.createElement(K.a.Header,{closeButton:!0},n.a.createElement(K.a.Title,null,"Modify Detector")),n.a.createElement(K.a.Body,null,n.a.createElement(W.a,null,n.a.createElement(U.a,null,n.a.createElement(I.a,null,"Name ",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,{className:"name",required:!0,type:"text",maxLength:"10",value:this.state.detname,onChange:function(e){c.setState({detname:e.target.value})}}))),n.a.createElement(I.a,null,"Position"),n.a.createElement(I.a,null,"x",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(e={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(e,"value",this.state.detposx),Object(i.a)(e,"onChange",(function(e){c.setState({detposx:e.target.value})})),e))),"y",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(t={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(t,"value",this.state.detposy),Object(i.a)(t,"onChange",(function(e){c.setState({detposy:e.target.value})})),t))),"z",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(a={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(a,"value",this.state.detposz),Object(i.a)(a,"onChange",(function(e){c.setState({detposz:e.target.value})})),a)))),n.a.createElement("br",null),n.a.createElement(I.a,null,"Direction"),n.a.createElement(I.a,null,"x",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(r={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(r,"value",this.state.detdirx),Object(i.a)(r,"onChange",(function(e){c.setState({detdirx:e.target.value})})),r))),"y",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(o={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(o,"value",this.state.detdiry),Object(i.a)(o,"onChange",(function(e){c.setState({detdiry:e.target.value})})),o))),"z",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(s={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(s,"value",this.state.detdirz),Object(i.a)(s,"onChange",(function(e){c.setState({detdirz:e.target.value})})),s)))),n.a.createElement("br",null),n.a.createElement(I.a,null,"Energy ",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(l={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(l,"value",this.state.energy),Object(i.a)(l,"onChange",(function(e){c.setState({energy:e.target.value})})),l)))," keV")))),n.a.createElement(K.a.Footer,null,n.a.createElement(X.a,{variant:"secondary",onClick:function(){c.confirmDialog.current.showDialog()},style:{backgroundColor:"red",color:"white"}},"Delete"),n.a.createElement(X.a,{variant:"primary",onClick:function(){c.hideDialog(),c.props.detector.name=c.state.name,c.props.detector.model.position.x=c.state.detposx,c.props.detector.model.position.y=c.state.detposy,c.props.detector.model.position.z=c.state.detposz,c.props.detector.direction.x=c.state.detdirx,c.props.detector.direction.y=c.state.detdiry,c.props.detector.direction.z=c.state.detdirz,c.props.detector.energy=c.state.energy;for(var e="",t=0;t<ee.chunks.length;t++)c.props.buttonid==ee.chunks[t].id&&(ee.chunks[t].code='\\Gun{\n\tname: "'+c.props.name+'";\n\tposition[cm]: '+c.state.detposx+", "+c.state.detposy+", "+c.state.detposz+";\n\tdirection: "+c.state.detdirx+", "+c.state.detdiry+", "+c.state.detdirz+";\n\tenergy[keV]: "+c.state.energy+";\n}\n"),e+=ee.chunks[t].code;c.props.codeeditor.current.updateText(e),c.props.updatedetails(n.a.createElement(U.a,null,n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Position: ")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"x: ",c.state.detposx," cm"),n.a.createElement(G.a,null,"y: ",c.state.detposy," cm"),n.a.createElement(G.a,null,"z: ",c.state.detposz," cm")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Direction: ")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"x: ",c.state.detdirx," "),n.a.createElement(G.a,null,"y: ",c.state.detdiry," "),n.a.createElement(G.a,null,"z: ",c.state.detdirz," ")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Energy: ",c.state.energy," keV"))))}},"Modify"))))}}]),a}(r.Component);pe.id=0;var ge=pe,ve=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).editdialog=n.a.createRef(),r.updateDetails=r.updateDetails.bind(Object(u.a)(r)),r.state={details:r.props.details},r.id=r.props.id,r}return Object(c.a)(a,[{key:"updateDetails",value:function(e){this.setState({details:e})}},{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement(ge,{buttonid:this.id,codeeditor:this.props.codeeditor,name:this.props.name,updatedetails:this.updateDetails,button:this,removebutton:this.props.removebutton,detector:this.props.detector,ref:this.editdialog,buttons:this.props.buttons,details:this.props.details}),n.a.createElement(_.a,{className:"button"},n.a.createElement(_.a.Header,null,n.a.createElement(Y.a.Toggle,{as:X.a,onClick:function(){R.acitve_id!=e.id?R.acitve_id=e.id:R.acitve_id=-1},variant:"link",eventKey:this.id},this.props.name),n.a.createElement(X.a,{onClick:function(){e.editdialog.current.showDialog()},className:"editButton"},"EDIT")),n.a.createElement(Y.a.Collapse,{eventKey:this.id},n.a.createElement(_.a.Body,null,n.a.createElement(U.a,null,n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Position: ")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"x: ",this.props.detector.model.position.x," cm"),n.a.createElement(G.a,null,"y: ",this.props.detector.model.position.y," cm"),n.a.createElement(G.a,null,"z: ",this.props.detector.model.position.z," cm")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Direction: ")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"x: ",this.props.detector.direction.x," "),n.a.createElement(G.a,null,"y: ",this.props.detector.direction.y," "),n.a.createElement(G.a,null,"z: ",this.props.detector.direction.z," ")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Energy: ",this.props.detector.energy," keV")))))))}}]),a}(r.Component);ve.id=0;var fe=ve,be=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).showDialog=r.showDialog.bind(Object(u.a)(r)),r.hideDialog=r.hideDialog.bind(Object(u.a)(r)),r.state={show:!1,detname:"Detector",detposx:0,detposy:0,detposz:0,detdirx:0,detdiry:0,detdirz:0,energy:100},r}return Object(c.a)(a,[{key:"componentDidMount",value:function(){}},{key:"showDialog",value:function(){this.setState({show:!0})}},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e,t,a,r,o,s,l,c=this;return n.a.createElement(n.a.Fragment,null,n.a.createElement(K.a,{show:this.state.show,onHide:function(){c.hideDialog()}},n.a.createElement(K.a.Header,{closeButton:!0},n.a.createElement(K.a.Title,null,"Create Particle Gun")),n.a.createElement(K.a.Body,null,n.a.createElement(W.a,null,n.a.createElement(U.a,null,n.a.createElement(I.a,null,"Name ",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,{className:"name",required:!0,type:"text",maxLength:"10",value:this.state.detname,onChange:function(e){c.setState({detname:e.target.value})}}))),n.a.createElement(I.a,null,"Position"),n.a.createElement(I.a,null,"x",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(e={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(e,"value",this.state.detposx),Object(i.a)(e,"onChange",(function(e){c.setState({detposx:e.target.value})})),e))),"y",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(t={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(t,"value",this.state.detposy),Object(i.a)(t,"onChange",(function(e){c.setState({detposy:e.target.value})})),t))),"z",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(a={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(a,"value",this.state.detposz),Object(i.a)(a,"onChange",(function(e){c.setState({detposz:e.target.value})})),a)))),n.a.createElement("br",null),n.a.createElement(I.a,null,"Direction"),n.a.createElement(I.a,null,"x",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(r={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(r,"value",this.state.detdirx),Object(i.a)(r,"onChange",(function(e){c.setState({detdirx:e.target.value})})),r))),"y",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(o={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(o,"value",this.state.detdiry),Object(i.a)(o,"onChange",(function(e){c.setState({detdiry:e.target.value})})),o))),"z",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(s={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(s,"value",this.state.detdirz),Object(i.a)(s,"onChange",(function(e){c.setState({detdirz:e.target.value})})),s)))),n.a.createElement("br",null),n.a.createElement(I.a,null,"Energy ",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(l={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(l,"value",this.state.energy),Object(i.a)(l,"onChange",(function(e){c.setState({energy:e.target.value})})),l)))," keV")))),n.a.createElement(K.a.Footer,null,n.a.createElement(X.a,{variant:"secondary",onClick:function(){c.hideDialog()}},"Cancel"),n.a.createElement(X.a,{variant:"primary",onClick:function(){c.hideDialog(),c.props.createbutton(c.state.detname,c.state.detposx,c.state.detposy,c.state.detposz,c.state.detdirx,c.state.detdiry,c.state.detdirz,c.state.energy)}},"Create"))))}}]),a}(r.Component);be.id=0;var ye=be,Ee=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).showDialog=r.showDialog.bind(Object(u.a)(r)),r.hideDialog=r.hideDialog.bind(Object(u.a)(r)),r.confirmDialog=n.a.createRef(),r.state={show:!1,detname:r.props.detector.name,detposx:r.props.detector.model.position.x,detposy:r.props.detector.model.position.y,detposz:r.props.detector.model.position.z,material:r.props.detector.material},r}return Object(c.a)(a,[{key:"componentDidMount",value:function(){}},{key:"showDialog",value:function(){this.setState({show:!0})}},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e,t,a,r,o=this;return n.a.createElement(n.a.Fragment,null,n.a.createElement(Z,{ref:this.confirmDialog,title:"Confirm",content:"Are you sure you want to delete this component?",fun:function(){o.hideDialog(),o.props.removebutton(o.props.detector,o.props.button)}}),n.a.createElement(K.a,{show:this.state.show,onHide:function(){o.hideDialog()}},n.a.createElement(K.a.Header,{closeButton:!0},n.a.createElement(K.a.Title,null,"Modify Detector")),n.a.createElement(K.a.Body,null,n.a.createElement(W.a,null,n.a.createElement(U.a,null,n.a.createElement(I.a,null,"Name ",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,{className:"name",required:!0,type:"text",maxLength:"10",value:this.state.detname,onChange:function(e){o.setState({detname:e.target.value})}}))),n.a.createElement(I.a,null,"Position"),n.a.createElement(I.a,null,"x",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(e={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(e,"value",this.state.detposx),Object(i.a)(e,"onChange",(function(e){o.setState({detposx:e.target.value})})),e))),"y",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(t={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(t,"value",this.state.detposy),Object(i.a)(t,"onChange",(function(e){o.setState({detposy:e.target.value})})),t))),"z",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(a={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(a,"value",this.state.detposz),Object(i.a)(a,"onChange",(function(e){o.setState({detposz:e.target.value})})),a)))),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement(I.a,null,"Material ",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(r={className:"numspinner",required:!0,value:"0",type:"text",maxLength:"10"},Object(i.a)(r,"value",this.state.material),Object(i.a)(r,"onChange",(function(e){o.setState({material:e.target.value})})),r))))))),n.a.createElement(K.a.Footer,null,n.a.createElement(X.a,{variant:"secondary",onClick:function(){o.confirmDialog.current.showDialog()},style:{backgroundColor:"red",color:"white"}},"Delete"),n.a.createElement(X.a,{variant:"primary",onClick:function(){o.hideDialog(),o.props.detector.name=o.state.name,o.props.detector.model.position.x=o.state.detposx,o.props.detector.model.position.y=o.state.detposy,o.props.detector.model.position.z=o.state.detposz,o.props.detector.material=o.state.material;for(var e="",t=0;t<ee.chunks.length;t++)o.props.buttonid==ee.chunks[t].id&&(ee.chunks[t].code='\\Source{\n\tname: "'+o.props.name+'";\n\tposition[cm]: '+o.state.detposx+", "+o.state.detposy+", "+o.state.detposz+';\n\tmaterial: "'+o.state.material+'";\n}\n'),e+=ee.chunks[t].code;o.props.codeeditor.current.updateText(e),o.props.updatedetails(n.a.createElement(U.a,null,n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Position: ")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"x: ",o.state.detposx," cm"),n.a.createElement(G.a,null,"y: ",o.state.detposy," cm"),n.a.createElement(G.a,null,"z: ",o.state.detposz," cm")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Material: ",o.state.material))))}},"Modify"))))}}]),a}(r.Component);Ee.id=0;var xe=Ee,we=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).editdialog=n.a.createRef(),r.updateDetails=r.updateDetails.bind(Object(u.a)(r)),r.state={details:r.props.details},r.id=r.props.id,r}return Object(c.a)(a,[{key:"componentDidMount",value:function(){}},{key:"updateDetails",value:function(e){this.setState({details:e})}},{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement(xe,{codeeditor:this.props.codeeditor,name:this.props.name,buttonid:this.id,updatedetails:this.updateDetails,button:this,removebutton:this.props.removebutton,detector:this.props.detector,ref:this.editdialog,buttons:this.props.buttons,details:this.props.details}),n.a.createElement(_.a,{className:"button"},n.a.createElement(_.a.Header,null,n.a.createElement(Y.a.Toggle,{as:X.a,onClick:function(){R.acitve_id!=e.id?R.acitve_id=e.id:R.acitve_id=-1},variant:"link",eventKey:this.id},this.props.name),n.a.createElement(X.a,{onClick:function(){e.editdialog.current.showDialog()},className:"editButton"},"EDIT")),n.a.createElement(Y.a.Collapse,{eventKey:this.id},n.a.createElement(_.a.Body,null,n.a.createElement(U.a,null,n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Position: ")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"x: ",this.props.detector.model.position.x," cm"),n.a.createElement(G.a,null,"y: ",this.props.detector.model.position.y," cm"),n.a.createElement(G.a,null,"z: ",this.props.detector.model.position.z," cm")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Material: ",this.props.detector.material)))))))}}]),a}(r.Component);we.id=0;var ke=we,Se=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).showDialog=r.showDialog.bind(Object(u.a)(r)),r.hideDialog=r.hideDialog.bind(Object(u.a)(r)),r.state={show:!1,detname:"Detector",detposx:0,detposy:0,detposz:0,material:"Co60"},r}return Object(c.a)(a,[{key:"componentDidMount",value:function(){}},{key:"showDialog",value:function(){this.setState({show:!0});var e="Source"+this.props.buttons.length;this.setState({detname:e})}},{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e,t,a,r,o=this;return n.a.createElement(n.a.Fragment,null,n.a.createElement(K.a,{show:this.state.show,onHide:function(){o.hideDialog()}},n.a.createElement(K.a.Header,{closeButton:!0},n.a.createElement(K.a.Title,null,"Create Particle Source")),n.a.createElement(K.a.Body,null,n.a.createElement(W.a,null,n.a.createElement(U.a,null,n.a.createElement(I.a,null,"Name ",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,{className:"name",required:!0,type:"text",maxLength:"10",value:this.state.detname,onChange:function(e){o.setState({detname:e.target.value})}}))),n.a.createElement(I.a,null,"Position"),n.a.createElement(I.a,null,"x",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(e={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(e,"value",this.state.detposx),Object(i.a)(e,"onChange",(function(e){o.setState({detposx:e.target.value})})),e))),"y",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(t={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(t,"value",this.state.detposy),Object(i.a)(t,"onChange",(function(e){o.setState({detposy:e.target.value})})),t))),"z",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(a={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(a,"value",this.state.detposz),Object(i.a)(a,"onChange",(function(e){o.setState({detposz:e.target.value})})),a)))),n.a.createElement("br",null),n.a.createElement(I.a,null,"Material ",n.a.createElement(G.a,null,n.a.createElement(W.a.Control,(r={className:"numspinner",required:!0,value:"0",type:"text",maxLength:"10"},Object(i.a)(r,"value",this.state.material),Object(i.a)(r,"onChange",(function(e){o.setState({material:e.target.value})})),r))))))),n.a.createElement(K.a.Footer,null,n.a.createElement(X.a,{variant:"secondary",onClick:function(){o.hideDialog()}},"Cancel"),n.a.createElement(X.a,{variant:"primary",onClick:function(){o.hideDialog(),o.props.createbutton(o.state.detname,o.state.detposx,o.state.detposy,o.state.detposz,o.state.material)}},"Create"))))}}]),a}(r.Component);Se.id=0;var Ae=Se,Oe=a(496),Ce=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).state={numberOfParticles:100,show:!1,loading:!1},r.hideDialog=r.hideDialog.bind(Object(u.a)(r)),r.showDialog=r.showDialog.bind(Object(u.a)(r)),r.setLoading=r.setLoading.bind(Object(u.a)(r)),r}return Object(c.a)(a,[{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"showDialog",value:function(){this.setState({show:!0,loading:!1})}},{key:"setLoading",value:function(e){this.setState({loading:e})}},{key:"render",value:function(){var e=this;return this.state.loading?n.a.createElement(n.a.Fragment,null,n.a.createElement(K.a,{show:this.state.show,onHide:function(){e.hideDialog()}},n.a.createElement(K.a.Header,{closeButton:!0},n.a.createElement(K.a.Title,null,"Run simulation")),n.a.createElement(K.a.Body,null,n.a.createElement(I.a,{style:{margin:"5px"}},"Runnig simulation"),n.a.createElement(Oe.a,{animation:"border",role:"status"})),n.a.createElement(K.a.Footer,null,n.a.createElement(X.a,{variant:"secondary",onClick:function(){e.hideDialog()}},"Cancel"),n.a.createElement(X.a,{variant:"primary",onClick:function(){e.props.runsim(e.state.numberOfParticles)}},"Run")))):n.a.createElement(n.a.Fragment,null,n.a.createElement(K.a,{show:this.state.show,onHide:function(){e.hideDialog()}},n.a.createElement(K.a.Header,{closeButton:!0},n.a.createElement(K.a.Title,null,"Run simulation")),n.a.createElement(K.a.Body,null,n.a.createElement(I.a,{style:{margin:"5px"}},"Number of particles:"),n.a.createElement(W.a,null,n.a.createElement(W.a.Control,{required:!0,type:"number",value:this.state.numberOfParticles,onChange:function(t){e.setState({numberOfParticles:t.target.value})}}))),n.a.createElement(K.a.Footer,null,n.a.createElement(X.a,{variant:"secondary",onClick:function(){e.hideDialog()}},"Cancel"),n.a.createElement(X.a,{variant:"primary",onClick:function(){e.setLoading(!0),e.props.runsim(e.state.numberOfParticles,e.hideDialog)}},"Run"))))}}]),a}(r.Component),je=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).state={numberofparticles:1e3,detector:0,show:!1,loading:!1,now:60,binsize:1},r.hideDialog=r.hideDialog.bind(Object(u.a)(r)),r.showDialog=r.showDialog.bind(Object(u.a)(r)),r.setLoading=r.setLoading.bind(Object(u.a)(r)),r}return Object(c.a)(a,[{key:"hideDialog",value:function(){this.setState({show:!1})}},{key:"setLoading",value:function(e){this.setState({loading:e})}},{key:"showDialog",value:function(){this.setState({show:!0,loading:!1})}},{key:"render",value:function(){var e,t,a=this;if(this.state.loading)return n.a.createElement(K.a,{show:this.state.show},n.a.createElement(K.a.Header,{closeButton:!0},n.a.createElement(K.a.Title,null,"Configure Spectroscopy")),n.a.createElement(K.a.Body,null,n.a.createElement(I.a,{style:{margin:"5px"}},"Runnig simulation"),n.a.createElement(Oe.a,{animation:"border",role:"status"})),n.a.createElement(K.a.Footer,null,n.a.createElement(X.a,{variant:"secondary",onClick:function(){a.hideDialog()}},"Cancel")));for(var r=[],o=0;o<this.props.detectors.length;o++)r.push(n.a.createElement("option",{value:this.props.detectors[o].id},this.props.detectors[o].name));return n.a.createElement(n.a.Fragment,null,n.a.createElement(K.a,{show:this.state.show,onHide:function(){a.hideDialog()}},n.a.createElement(K.a.Header,{closeButton:!0},n.a.createElement(K.a.Title,null,"Configure Spectroscopy")),n.a.createElement(K.a.Body,null,n.a.createElement(I.a,{style:{margin:"5px"}},"Select detector"),n.a.createElement(W.a,null,n.a.createElement(W.a.Control,{as:"select",value:this.state.detector,onChange:function(e){a.setState({detector:e.target.value})}},r),n.a.createElement("hr",null),n.a.createElement(I.a,{style:{margin:"5px"}},"Number of particles"),n.a.createElement(W.a.Control,(e={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(e,"value",this.state.numberofparticles),Object(i.a)(e,"onChange",(function(e){a.setState({numberofparticles:e.target.value})})),e)),n.a.createElement("hr",null),n.a.createElement(I.a,{style:{margin:"5px"}},"Bin size"),n.a.createElement(I.a,null,n.a.createElement(W.a.Control,(t={className:"numspinner",required:!0,value:"0",type:"number",maxLength:"10"},Object(i.a)(t,"value",this.state.binsize),Object(i.a)(t,"style",{width:"20%",margin:"15px"}),Object(i.a)(t,"onChange",(function(e){a.setState({binsize:e.target.value})})),t)),n.a.createElement("span",{style:{padding:"20px"}},"keV")))),n.a.createElement(K.a.Footer,null,n.a.createElement(X.a,{variant:"secondary",onClick:function(){a.hideDialog()}},"Cancel"),n.a.createElement(X.a,{variant:"primary",onClick:function(){a.setLoading(!0),a.props.runsim(a.state.numberofparticles,a.state.detector,a.hideDialog,a.state.binsize)}},"Run"))))}}]),a}(r.Component),De=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).dialog=n.a.createRef(),r.gundialog=n.a.createRef(),r.sourcedialog=n.a.createRef(),r.rundialog=n.a.createRef(),r.spectrumdialog=n.a.createRef(),r.confirmDialog=n.a.createRef(),r.showRun=r.showRun.bind(Object(u.a)(r)),r.state={showTracks:!0,showParticles:!0,showAxes:!0,showGrid:!1,showrun:"none",showclearsetup:"none",showclearparticles:"none"},r}return Object(c.a)(a,[{key:"showRun",value:function(e){e?this.setState({showrun:"block"}):this.setState({showrun:"none"})}},{key:"showClearParticles",value:function(e){e?this.setState({showclearparticles:"block"}):this.setState({showclearparticles:"none"})}},{key:"showClearSetup",value:function(e){e?this.setState({showclearsetup:"block"}):this.setState({showclearsetup:"none"})}},{key:"render",value:function(){var e=this;return n.a.createElement(n.a.Fragment,null,n.a.createElement(Z,{ref:this.confirmDialog,title:"Confirm",content:"Are you sure you want to delete all components?",fun:function(){e.props.clearSetup(),e.showClearSetup(!1)}}),n.a.createElement(me,{ref:this.dialog,createbutton:this.props.createbutton,buttons:this.props.buttons}),n.a.createElement(ye,{ref:this.gundialog,createbutton:this.props.creategunbutton,buttons:this.props.buttons}),n.a.createElement(Ae,{ref:this.sourcedialog,createbutton:this.props.createsourcebutton,buttons:this.props.buttons}),n.a.createElement(Ce,{ref:this.rundialog,runsim:this.props.run}),n.a.createElement(je,{ref:this.spectrumdialog,runsim:this.props.runspectroscopy,detectors:this.props.detectors}),n.a.createElement(oe.a,{bg:"light",variant:"light",style:{position:"fixed","z-index":"4"}},n.a.createElement(oe.a.Brand,null,"Geant4"),n.a.createElement(X.a,{style:{display:this.state.showrun},variant:"primary",onClick:function(){e.rundialog.current.showDialog()}},"Run"),n.a.createElement(X.a,{variant:"primary",style:{backgroundColor:"green",display:this.state.showrun},onClick:function(){e.spectrumdialog.current.showDialog()}},"Spectroscopy"),n.a.createElement(X.a,{variant:"primary",style:{display:this.state.showclearparticles,backgroundColor:"red"},onClick:function(){e.props.clearrun(),e.showClearParticles(!1)}},"Clear particles"),n.a.createElement(X.a,{variant:"primary",style:{display:this.state.showclearsetup,backgroundColor:"red"},onClick:function(){e.confirmDialog.current.showDialog()}},"Clear setup"),n.a.createElement(q.a,{className:"mr-auto"},n.a.createElement(se.a,null,n.a.createElement(se.a.Toggle,{variant:"success",id:"dropdown-basic",style:{backgroundColor:"white",border:"none",color:"black"}},"Add"),n.a.createElement(se.a.Menu,null,n.a.createElement(ie.a,{overlay:n.a.createElement(le.a,{id:"tooltip-disabled"},"Detector Geometry")},n.a.createElement("span",{className:"d-inline-block"},n.a.createElement(se.a.Item,{className:"detectoroption",onClick:function(){e.dialog.current.showDialog()}},"Detector"))),n.a.createElement("br",null),n.a.createElement(ie.a,{overlay:n.a.createElement(le.a,{id:"tooltip-disabled"},"General Particle Source")},n.a.createElement("span",{className:"d-inline-block"},n.a.createElement(se.a.Item,{className:"detectoroption",onClick:function(){e.sourcedialog.current.showDialog()}},"GPS"))),n.a.createElement("br",null),n.a.createElement(ie.a,{overlay:n.a.createElement(le.a,{id:"tooltip-disabled"},"Directed Particle Gun")},n.a.createElement("span",{className:"d-inline-block"},n.a.createElement(se.a.Item,{className:"detectoroption",onClick:function(){e.gundialog.current.showDialog()}},"Gun"))))),n.a.createElement(se.a,null,n.a.createElement(se.a.Toggle,{variant:"success",id:"dropdown-basic",style:{backgroundColor:"white",border:"none",color:"black"}},"View"),n.a.createElement(se.a.Menu,null,n.a.createElement(W.a.Check,{type:"checkbox",label:"Show Tracks",checked:this.state.showTracks,onChange:function(t){e.setState({showTracks:t.target.checked}),e.props.setshowtracks(e.state.showTracks)},style:{margin:"12px"}}),n.a.createElement(W.a.Check,{type:"checkbox",label:"Show Particles",checked:this.state.showParticles,onChange:function(t){e.setState({showParticles:t.target.checked}),e.props.setshowparticles(e.state.showParticles)},style:{margin:"12px"}}),n.a.createElement(W.a.Check,{type:"checkbox",label:"Show Axes",checked:this.state.showAxes,onChange:function(t){e.setState({showAxes:t.target.checked}),e.props.setshowaxes(e.state.showAxes)},style:{margin:"12px"}}),n.a.createElement(W.a.Check,{type:"checkbox",label:"Show Grid",checked:this.state.showGrid,onChange:function(t){e.setState({showGrid:t.target.checked}),e.state.showGrid&&e.props.canvas.current.updateHint(" "),e.props.setshowgrid(e.state.showGrid)},style:{margin:"12px"}})))),n.a.createElement(W.a,{inline:!0},n.a.createElement(ce.a,{type:"text",placeholder:"Search",className:"mr-sm-2"}),n.a.createElement(X.a,{variant:"outline-primary"},"Search"))))}}]),a}(r.Component);De.id=0;var ze=De,Re=function e(){Object(l.a)(this,e),this.track_id=0,this.parent_id=0,this.position=new y(0,0,0),this.color=new y(1,1,1),this.totalEnergy=0,this.energyDeposit=0,this.definition="",this.id=""},Me=a(103),Te=a.n(Me),Pe=(a(477),function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).energies=[],r.numberofenergies=[],r.canvas=n.a.createRef(),r}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.chart=new Te.a(this.canvas.current.getContext("2d"),{type:"bar",data:{labels:[],datasets:[{label:"counts",backgroundColor:"rgb(0, 99, 132)",borderColor:"rgb(0, 99, 132)",data:[]}]},options:{responsive:!0,plugins:{zoom:{pan:{enabled:!0,mode:"xy"},zoom:{enabled:!0,mode:"xy"}}}}})}},{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement("canvas",{ref:this.canvas}))}},{key:"add",value:function(e){isNaN(e)||(this.contains(e)?this.numberofenergies[this.getIndex(e)]++:(this.energies.push(e),this.numberofenergies.push(1)))}},{key:"contains",value:function(e){for(var t=0;t<this.energies.length;t++)if(this.energies[t]==e)return!0;return!1}},{key:"getIndex",value:function(e){for(var t=0;t<this.energies.length;t++)if(0==Math.abs(this.energies[t]-e))return t;return-1}},{key:"sort",value:function(e){for(var t=[],a=this.energies[this.energies.length-1],r=0;r<a;r+=e)this.add(r);for(var n=0;n<this.energies.length;n++)t.push({hit:this.energies[n],no:this.numberofenergies[n]});t.sort((function(e,t){return e.hit<t.hit?-1:e.hit==t.hit?0:1}));for(var o=0;o<t.length;o++)this.energies[o]=t[o].hit,this.numberofenergies[o]=t[o].no;for(var s=0;s<this.energies.length;s++)this.addData("["+this.energies[s]+"-"+(this.energies[s]+ +e).toString()+"]",this.numberofenergies[s]-1)}},{key:"clear",value:function(){this.chart.destroy();var e=this.canvas.current.getContext("2d");this.chart=new Te.a(e,{type:"bar",data:{labels:[],datasets:[{label:"counts",backgroundColor:"rgb(0, 99, 132)",borderColor:"rgb(0, 99, 132)",data:[]}]},options:{responsive:!0,scales:{yAxes:[{scaleLabel:{display:!0,labelString:"counts"}}],xAxes:[{scaleLabel:{display:!0,labelString:"bins"}}]},plugins:{zoom:{pan:{enabled:!0,mode:"xy"},zoom:{enabled:!0,mode:"xy"}}}}}),this.energies=[],this.numberofenergies=[]}},{key:"addData",value:function(e,t){this.chart.data.labels.push(e),this.chart.data.datasets.forEach((function(e){e.data.push(t)})),this.chart.update()}}],[{key:"save",value:function(){}}]),a}(r.Component)),Le=a(191),Fe=a.n(Le),Ne=(a(486),a(487),function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).state={text:"",width:"20%"},r.editor=n.a.createRef(),r}return Object(c.a)(a,[{key:"updateText",value:function(e){this.setState({text:e})}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{style:{width:this.state.width,height:"100%",top:"50px",position:"fixed",right:"0","z-index":"3",border:"0",borderRadius:"0",padding:"0",margin:"0","background-color":"white"}},n.a.createElement(X.a,{style:Object(i.a)({border:"0",position:"relative","background-color":"gray","z-index":"3",bottom:"0","border-radius":"0"},"border","solid 1px white"),onClick:function(){e.setState({text:"Write your code here"})}},"New"),n.a.createElement(X.a,{style:Object(i.a)({border:"0",position:"relative","background-color":"gray","z-index":"3",bottom:"0","border-radius":"0"},"border","solid 1px white")},"Open"),n.a.createElement(X.a,{onClick:function(){var t=e.state.text;ee.parse(e.state.text,e.props.canvas.current,e.props.clearSetup,e.props.createDetector,e.props.createSource,e.props.createGun),e.setState({text:t})},style:Object(i.a)({border:"0",position:"relative","background-color":"gray","z-index":"3",bottom:"0","border-radius":"0"},"border","solid 1px white")},"Run script"),n.a.createElement(X.a,{style:Object(i.a)({border:"0",position:"relative","background-color":"gray","z-index":"3",bottom:"0","border-radius":"0"},"border","solid 1px white"),onClick:function(){window.location="Help"}},"Help"),n.a.createElement(Fe.a,{style:{"z-index":"2",width:"100%"},ref:this.editor,value:this.state.text,mode:"elixir",theme:"monokai",fontSize:16,onChange:function(t){e.setState({text:t})}}),n.a.createElement(X.a,{onClick:function(){"30%"==e.state.width?e.setState({width:"0"}):e.setState({width:"30%"})},style:{right:this.state.width,position:"fixed",top:"50%","z-index":"3",height:"50px","background-color":"gray",border:"0"}}),n.a.createElement("div",{style:{position:"fixed","z-index":"1","background-color":"black",height:"100%",top:"0",width:this.state.width}}))}}]),a}(r.Component)),Ve=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).spectrum=n.a.createRef(),r.navbar=n.a.createRef(),r.codeeditor=n.a.createRef(),r.state={buttons:[],gunbuttons:[],sourcebuttons:[],spectrum:!0,page:"first"},r.createDetector=r.createDetector.bind(Object(u.a)(r)),r.createSource=r.createSource.bind(Object(u.a)(r)),r.createGun=r.createGun.bind(Object(u.a)(r)),r.removeDetector=r.removeDetector.bind(Object(u.a)(r)),r.removeGun=r.removeGun.bind(Object(u.a)(r)),r.removeSource=r.removeSource.bind(Object(u.a)(r)),r.runSim=r.runSim.bind(Object(u.a)(r)),r.runSpectroscopy=r.runSpectroscopy.bind(Object(u.a)(r)),r.setShowParticles=r.setShowParticles.bind(Object(u.a)(r)),r.setShowTracks=r.setShowTracks.bind(Object(u.a)(r)),r.setShowAxes=r.setShowAxes.bind(Object(u.a)(r)),r.setShowGrid=r.setShowGrid.bind(Object(u.a)(r)),r.clearRun=r.clearRun.bind(Object(u.a)(r)),r.clearSetup=r.clearSetup.bind(Object(u.a)(r)),r.accordion=n.a.createRef(),r.canvas=n.a.createRef(),r.detectors=[],r.guns=[],r.sources=[],r.particles=[],r.tracks=[],r}return Object(c.a)(a,[{key:"clearRun",value:function(){this.canvas.current.clearRun()}},{key:"runSpectroscopy",value:function(e,t,a,r){var n=[];n.push(0),n.push(1),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0);var o=this.detectors.length;n.push(o);for(var s=0;s<o;s++){n.push("G4_"+this.detectors[s].material),n.push(this.detectors[s].id),n.push(this.detectors[s].model.position.x),n.push(this.detectors[s].model.position.y),n.push(this.detectors[s].model.position.z),n.push(this.detectors[s].model.rotation.x),n.push(this.detectors[s].model.rotation.y),n.push(this.detectors[s].model.rotation.z),n.push(this.detectors[s].model.scale.x),n.push(this.detectors[s].model.scale.y),n.push(this.detectors[s].model.scale.z),n.push(this.detectors[s].model.vertices.length);for(var i=0;i<this.detectors[s].model.vertices.length;i++)n.push(this.detectors[s].model.vertices[i])}var l=this.sources.length;n.push(l);for(s=0;s<l;s++)n.push(this.sources[s].material),n.push(this.sources[s].model.position.x),n.push(this.sources[s].model.position.y),n.push(this.sources[s].model.position.z);var c=this.guns.length;n.push(c);for(s=0;s<c;s++)n.push(this.guns[s].model.position.x),n.push(this.guns[s].model.position.y),n.push(this.guns[s].model.position.z),n.push(this.guns[s].direction.x),n.push(this.guns[s].direction.y),n.push(this.guns[s].direction.z),n.push(this.guns[s].energy);n.push(t),n.push(e),n.push("end"),this.sendGamma(n,a,r)}},{key:"runSim",value:function(e,t){var a=[];a.push(1),a.push(1),a.push(0),a.push(0),a.push(0),a.push(0),a.push(0),a.push(0),a.push(0);var r=this.detectors.length;a.push(r);for(var n=0;n<r;n++){a.push("G4_"+this.detectors[n].material),a.push(this.detectors[n].id),a.push(this.detectors[n].model.position.x),a.push(this.detectors[n].model.position.y),a.push(this.detectors[n].model.position.z),a.push(this.detectors[n].model.rotation.x),a.push(this.detectors[n].model.rotation.y),a.push(this.detectors[n].model.rotation.z),a.push(this.detectors[n].model.scale.x),a.push(this.detectors[n].model.scale.y),a.push(this.detectors[n].model.scale.z),a.push(this.detectors[n].model.vertices.length);for(var o=0;o<this.detectors[n].model.vertices.length;o++)a.push(this.detectors[n].model.vertices[o])}var s=this.sources.length;a.push(s);for(n=0;n<s;n++)a.push(this.sources[n].material),a.push(this.sources[n].model.position.x),a.push(this.sources[n].model.position.y),a.push(this.sources[n].model.position.z);var i=this.guns.length;a.push(i);for(n=0;n<i;n++)a.push(this.guns[n].model.position.x),a.push(this.guns[n].model.position.y),a.push(this.guns[n].model.position.z),a.push(this.guns[n].direction.x),a.push(this.guns[n].direction.y),a.push(this.guns[n].direction.z),a.push(this.guns[n].energy);a.push(e),a.push("end"),this.send(a,t)}},{key:"sendGamma",value:function(e,t,a){var r=this;alert(e);for(var n="",o=0;o<e.length;o++)n+=e[o],n+=",";fetch("http://localhost:80/gammaAPI",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({data:n})}).then((function(e){return e.text()})).then((function(e){r.processGammaSpectrum(e,a),t(),r.setState({spectrum:!1,page:"second"})}))}},{key:"send",value:function(e,t){for(var a=this,r="",n=0;n<e.length;n++)r+=e[n],r+=",";fetch("http://localhost:80/gammaAPI",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({data:r})}).then((function(e){return e.text()})).then((function(e){a.processResponse(e),t()}))}},{key:"processGammaSpectrum",value:function(e,t){var a=e;a=a.split(" "),this.spectrum.current.clear();for(var r=0;r<a.length;r++)this.spectrum.current.add(Math.floor(parseFloat(a[r])/t)*t);this.spectrum.current.sort(t)}},{key:"processResponse",value:function(e){var t=e.split(" "),a=0,r=0;for(this.particles=[];a<t.length-1-this.detectors.length-1;){var n=[],o=parseInt(t[a]);if(0==o)break;for(var s=t[a+1],i=0;i<o;i++){var l=new Re;l.position.x=.1*parseFloat(t[a+7*i+2]),l.position.y=.1*parseFloat(t[a+7*i+3]),l.position.z=.1*parseFloat(t[a+7*i+4]),n.push(.1*parseFloat(t[a+7*i+2])),n.push(.1*parseFloat(t[a+7*i+3])),n.push(.1*parseFloat(t[a+7*i+4])),l.definition=s,l.track_id=parseInt(t[a+7*i+5]),l.parent_id=parseInt(t[a+7*i+6]),l.totalEnergy=parseFloat(t[a+7*i+7]),l.energyDeposit=parseFloat(t[a+7*i+8]),l.color=new y(1,0,0),l.id=r,r++,this.particles.push(l)}a+=7*o+2;for(var c=[],u=0;u<n.length;u++)c.push(1);var h=this.canvas.current.addModel(n,c);"e-"==s&&(h.color=new y(1,0,1)),"gamma"==s&&(h.color=new y(1,1,1)),"e+"==s&&(h.color=new y(1,1,0)),h.drawLines=!0,this.tracks.push(h)}var d=[];for(i=0;i<this.particles.length;i+=Math.ceil(this.particles.length/1e4))d.push(this.particles[i]);this.particles=d.slice();for(var m=2*function(e){for(var t=0,a=0;a<e.length;a++)t+=+e[a].totalEnergy;return t/=e.length}(this.particles),p=0;p<this.particles.length;p++){this.particles[p].totalEnergy>m&&(this.particles[p].totalEnergy=m),this.particles[p].color.x=this.particles[p].totalEnergy/m*2,this.particles[p].color.y=1-this.particles[p].color.x;var g=this.particles[p].color.x/100;this.particles[p].scale=new y(g,g,g),this.canvas.current.addParticle(this.particles[p])}this.particles.length>0&&this.navbar.current.showClearParticles(!0)}},{key:"modifyDetector",value:function(e){}},{key:"createSource",value:function(e,t,a,r,o,s){this.detectors.length>0&&this.navbar.current.showRun(!0),this.navbar.current.showClearSetup(!0),s||this.codeeditor.current.updateText(this.codeeditor.current.state.text+'\\Source{\n\tname: "'+e+'";\n\tposition[cm]: '+t+", "+a+", "+r+';\n\tmaterial: "'+o+'";\n}\n');var i=this.state.sourcebuttons,l=n.a.createElement(U.a,null,n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Position: ")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"x: ",t," cm"),n.a.createElement(G.a,null,"y: ",a," cm"),n.a.createElement(G.a,null,"z: ",r," cm")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Material: ",o))),c=this.canvas.current.addSource(t,a,r,o);c.id=+ne.id,ee.chunks.push({id:c.id,code:'\\Source{\n\tname: "'+e+'";\n\tposition[cm]: '+t+", "+a+", "+r+';\n\tmaterial: "'+o+'";\n}\n'}),c.name=e,this.sources.push(c),i.push(n.a.createElement(ke,{codeeditor:this.codeeditor,name:e,removebutton:this.removeSource,id:ne.id,detector:c,details:l,key:++ne.id,buttons:this.state.sourcebuttons})),this.setState({sourcebuttons:i})}},{key:"createGun",value:function(e,t,a,r,o,s,i,l,c){this.detectors.length>0&&this.navbar.current.showRun(!0),this.navbar.current.showClearSetup(!0),c||this.codeeditor.current.updateText(this.codeeditor.current.state.text+'\\Gun{\n\tname: "'+e+'";\n\tposition[cm]: '+t+", "+a+", "+r+";\n\tdirection: "+o+", "+s+", "+i+";\n\tenergy[keV]: "+l+";\n}\n");var u=this.state.gunbuttons,h=n.a.createElement(U.a,null,n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Position: ")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"x: ",t," cm"),n.a.createElement(G.a,null,"y: ",a," cm"),n.a.createElement(G.a,null,"z: ",r," cm")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Direction: ")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"x: ",o," "),n.a.createElement(G.a,null,"y: ",s," "),n.a.createElement(G.a,null,"z: ",i," ")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Energy: ",l," keV"))),d=this.canvas.current.addGun(t,a,r,o,s,i,l);d.id=+ne.id,ee.chunks.push({id:d.id,code:'\\Gun{\n\tname: "'+e+'";\n\tposition[cm]: '+t+", "+a+", "+r+";\n\tdirection: "+o+", "+s+", "+i+";\n\tenergy[keV]: "+l+";\n}\n"}),d.name=e,this.guns.push(d),u.push(n.a.createElement(fe,{codeeditor:this.codeeditor,name:e,removebutton:this.removeGun,id:ne.id,detector:d,details:h,key:++ne.id,buttons:this.state.buttons})),this.setState({gunbuttons:u})}},{key:"createDetector",value:function(e,t,a,r,o,s,i,l,c,u,h,d,m,p,g){var v=this;(this.sources.length>0||this.guns.length>0)&&this.navbar.current.showRun(!0),this.navbar.current.showClearSetup(!0),g||this.codeeditor.current.updateText(this.codeeditor.current.state.text+'\\Detector{\n\tname: "'+e+'";\n\tposition[cm]: '+t+", "+a+", "+r+";\n\trotation[rad]: "+o+", "+s+", "+i+";\n\tscale[cm]: "+l+", "+c+", "+u+';\n\tmaterial: "'+h+'";\n}\n');var f=this.state.buttons,b=n.a.createElement(U.a,null,n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Position: ")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"x: ",t," cm"),n.a.createElement(G.a,null,"y: ",a," cm"),n.a.createElement(G.a,null,"z: ",r," cm")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Rotation: ")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"x: ",o," deg"),n.a.createElement(G.a,null,"y: ",s," deg"),n.a.createElement(G.a,null,"z: ",i," deg")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Scale: ")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"x: ",l),n.a.createElement(G.a,null,"y: ",c),n.a.createElement(G.a,null,"z: ",u)),n.a.createElement(I.a,null,n.a.createElement(G.a,null,"Material: ")),n.a.createElement(I.a,null,n.a.createElement(G.a,null,h))),y=function(d){d.id=+ne.id,ee.chunks.push({id:d.id,code:'\\Detector{\n\tname: "'+e+'";\n\tposition[cm]: '+t+", "+a+", "+r+";\n\trotation[rad]: "+o+", "+s+", "+i+";\n\tscale[cm]: "+l+", "+c+", "+u+';\n\tmaterial: "'+h+'";\n}\n'}),d.name=e,d.model.color=p,v.detectors.push(d),f.push(n.a.createElement(ne,{codeeditor:v.codeeditor,name:e,removebutton:v.removeDetector,id:ne.id,detector:d,details:b,key:++ne.id,buttons:v.state.buttons})),v.setState({buttons:f})},E=null;if("stl"==d){var x=V.parseData(m);E=this.canvas.current.addSTLDetector(t,a,r,o,s,i,l,c,u,h,x),y(E)}else this.canvas.current.addDetector(t,a,r,o,s,i,l,c,u,h,d).then((function(e){y(e)}))}},{key:"clearSetup",value:function(){ee.chunks=[],this.codeeditor.current.updateText(" "),ne.id=0,this.setState({buttons:[],gunbuttons:[],sourcebuttons:[]});for(var e=0;e<this.detectors.length;e++)this.canvas.current.removeDetector(this.detectors[e]);for(var t=0;t<this.sources.length;t++)this.canvas.current.removeSource(this.sources[t]);for(var a=0;a<this.guns.length;a++)this.canvas.current.removeGun(this.guns[a]);this.detectors=[],this.sources=[],this.guns=[],this.state.buttons=[],this.state.gunbuttons=[],this.state.sourcebuttons=[],this.clearRun()}},{key:"removeSource",value:function(e,t){(this.detectors.length<1||this.sources.length<1&&this.guns.length<1)&&this.navbar.current.showRun(!1),0!=this.sourceslength&&0!=this.guns.length&&0!=this.guns.length||this.navbar.current.showClearSetup(!1),this.canvas.current.removeSource(e),this.codeeditor.current.updateText(ee.removeChunk(e.id));for(var a=0;a<this.state.sourcebuttons.length;a++)if(this.state.sourcebuttons[a].key-1==t.id){var r=this.state.sourcebuttons;return r.splice(a,1),this.sources.splice(a,1),void this.setState({sourcebuttons:r})}}},{key:"removeGun",value:function(e,t){(this.detectors.length<1||this.sources.length<1&&this.guns.length<1)&&this.navbar.current.showRun(!1),0!=this.sourceslength&&0!=this.guns.length&&0!=this.guns.length||this.navbar.current.showClearSetup(!1),this.canvas.current.removeGun(e),this.codeeditor.current.updateText(ee.removeChunk(e.id));for(var a=0;a<this.state.gunbuttons.length;a++)if(this.state.gunbuttons[a].key-1==t.id){var r=this.state.gunbuttons;return r.splice(a,1),this.guns.splice(a,1),void this.setState({gunbuttons:r})}}},{key:"removeDetector",value:function(e,t){(this.detectors.length<1||this.sources.length<1&&this.guns.length<1)&&this.navbar.current.showRun(!1),0!=this.sourceslength&&0!=this.guns.length&&0!=this.guns.length||this.navbar.current.showClearSetup(!1),this.canvas.current.removeDetector(e),this.codeeditor.current.updateText(ee.removeChunk(e.id));for(var a=0;a<this.state.buttons.length;a++)if(this.state.buttons[a].key-1==t.id){var r=this.state.buttons;return r.splice(a,1),this.detectors.splice(a,1),void this.setState({buttons:r})}}},{key:"setShowTracks",value:function(e){this.canvas.current.setShowTracks(!e)}},{key:"setShowParticles",value:function(e){this.canvas.current.drawParticles=!e}},{key:"setShowAxes",value:function(e){this.canvas.current.setShowAxes(!e)}},{key:"setShowGrid",value:function(e){this.canvas.current.drawGrid=!e}},{key:"componentDidMount",value:function(){this.createDetector("Cube",0,0,0,0,0,0,1,1,1,"Pb","cube",null,new y(1,1,1))}},{key:"render",value:function(){var e=this,t=this.state.buttons.map((function(e){return n.a.createElement("div",null," ",e," ")})),a=this.state.gunbuttons.map((function(e){return n.a.createElement("div",null," ",e," ")})),r=this.state.sourcebuttons.map((function(e){return n.a.createElement("div",null," ",e," ")}));return n.a.createElement("div",null,n.a.createElement(H.a.Container,{id:"left-tabs-example",defaultActiveKey:"first",activeKey:this.state.page},n.a.createElement(G.a,{sm:3},n.a.createElement(q.a,Object(i.a)({variant:"pills",className:"flex-column"},"className","page"),n.a.createElement(q.a.Item,null,n.a.createElement(q.a.Link,{eventKey:"first",onClick:function(){e.setState({page:"first"})}},"simulation")),n.a.createElement(q.a.Item,null,n.a.createElement(q.a.Link,{eventKey:"second",disabled:this.state.spectrum,onClick:function(){e.setState({page:"second"})}},"spectrum")))),n.a.createElement(H.a.Content,null,n.a.createElement(H.a.Pane,{eventKey:"first"},n.a.createElement(B,{ref:this.canvas,style:{overflow:"hidden"}}),n.a.createElement(Ne,{ref:this.codeeditor,createGun:this.createGun,clearSetup:this.clearSetup,createSource:this.createSource,createDetector:this.createDetector,canvas:this.canvas}),n.a.createElement(ze,{run:this.runSim,ref:this.navbar,canvas:this.canvas,className:"navbar",runspectroscopy:this.runSpectroscopy,createbutton:this.createDetector,creategunbutton:this.createGun,createsourcebutton:this.createSource,setshowtracks:this.setShowTracks,setshowparticles:this.setShowParticles,setshowaxes:this.setShowAxes,setshowgrid:this.setShowGrid,clearrun:this.clearRun,clearSetup:this.clearSetup,detectors:this.detectors,buttons:this.state.buttons}),n.a.createElement("div",{className:"buttonbackground"}),n.a.createElement("div",{className:"accordion"},n.a.createElement(Y.a,{ref:this.accordion,defaultActiveKey:"0",className:"accordion"},n.a.createElement("div",{style:{color:"white","text-align":"center","background-color":"gray",border:"1px solid white"}},"Detectors"),t,n.a.createElement("div",{style:{color:"white","text-align":"center","background-color":"gray",border:"1px solid white"}},"Sources"),r,n.a.createElement("div",{style:{color:"white","text-align":"center","background-color":"gray",border:"1px solid white"}},"Guns"),a))),n.a.createElement(H.a.Pane,{eventKey:"second"},n.a.createElement(Pe,{ref:this.spectrum})))))}}]),a}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(Ve,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[193,1,2]]]);
//# sourceMappingURL=main.6d906091.chunk.js.map